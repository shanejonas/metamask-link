{"version":3,"sources":["webpack:///./node_modules/canvg/lib/index.es.js"],"names":["compressSpaces","str","replace","toNumbers","matches","match","call","allUppercase","normalizeAttributeName","name","test","toLowerCase","parseExternalUrl","url","urlMatch","attributeRegex","idRegex","classRegex","pseudoElementRegex","pseudoClassWithBracketsRegex","pseudoClassRegex","elementRegex","findSelectorMatch","selector","regex","length","vectorMagnitude","v","Math","sqrt","pow","vectorsRatio","u","vectorsAngle","acos","CB1","t","CB2","CB3","CB4","QB1","QB2","QB3","Property","document","value","this","isNormalizedColor","key","_context","_context2","separator","arguments","undefined","getString","split","zeroIsValue","regexp","result","isString","hasValue","asString","def","n","String","color","rgbParts","num","isFloat","round","normalizeColor","rootEmSize","emSize","axisOrIsFontSize","processPercent","_ref","_ref2","axis","isFontSize","viewPort","screen","getNumber","min","computeSize","max","getRem","getEm","getDpi","PI","definitions","element","opacity","getDefinition","createGradient","ctx","createPattern","getHrefAttribute","patternTransform","getAttribute","setValue","textBaselineMapping","getColor","len","commas","i","ok","alpha","toRGBA","ViewPort","viewPorts","width","height","push","pop","d","get","getCurrent","Point","x","y","point","atan2","transform","xp","yp","defaultValue","_toNumbers","_toNumbers2","_toNumbers2$","_toNumbers2$2","scale","_toNumbers3","_toNumbers4","_toNumbers4$","_toNumbers4$2","path","points","pathPoints","Mouse","working","events","eventElements","onClick","onMouseMove","canvas","onclick","onmousemove","style","cursor","run","parent","isPointInPath","boundingBox","_ref3","isPointInBox","_this$screen","window","offsetLeft","offsetTop","offsetParent","scrollX","scrollY","evt","_this$mapXY","mapXY","event","clientX","clientY","type","_this$mapXY2","defaultWindow","defaultFetch","fetch","Screen","_ref$fetch","_ref$window","FRAMERATE","MAX_VIRTUAL_PIXELS","CLIENT_WIDTH","CLIENT_HEIGHT","mouse","animations","waits","frameDuration","isReadyLock","isFirstRender","intervalId","checker","readyPromise","resolve","_","resolveReady","strokeStyle","lineCap","lineJoin","miterLimit","aspectRatio","desiredWidth","desiredHeight","_ref2$minX","minX","_ref2$minY","minY","refX","refY","_ref2$clip","clip","_ref2$clipX","clipX","_ref2$clipY","clipY","_cleanAspectRatio$spl","_cleanAspectRatio$spl2","align","meetOrSlice","scaleX","scaleY","scaleMin","scaleMax","finalDesiredWidth","finalDesiredHeight","refXProp","refYProp","hasRefs","translate","getPixels","scaledClipX","scaledClipY","beginPath","moveTo","lineTo","closePath","isMeetMinY","isSliceMaxY","isMeetMinX","isSliceMaxX","_this","_ref3$enableRedraw","enableRedraw","_ref3$ignoreMouse","ignoreMouse","_ref3$ignoreAnimation","ignoreAnimation","_ref3$ignoreDimension","ignoreDimensions","_ref3$ignoreClear","ignoreClear","forceRedraw","scaleWidth","scaleHeight","offsetX","offsetY","isReady","render","now","then","delta","tick","shouldUpdate","runEvents","start","cancel","stop","animation","update","hasEvents","clear","setCurrent","widthStyle","getStyle","heightStyle","concat","cWidth","clientWidth","cHeight","clientHeight","_context3","_context4","viewBox","xRatio","yRatio","_widthStyle","isNaN","_heightStyle","transformStyle","clearRect","defaultFetch$1","DefaultDOMParser","DOMParser","Parser","_ref$DOMParser","_load","_parse","mark","_callee","resource","wrap","prev","next","abrupt","parseFromString","load","_x","apply","xml","parser","checkDocument","err","parserError","getElementsByTagName","Error","textContent","_callee2","response","sent","text","_x2","Translate","parse","_this$point","_this$point2","_this$point3","applyTransform","Rotate","rotate","transformOrigin","angle","originX","originY","cx","cy","numbers","getRadians","rad","cos","sin","Scale","scaleSize","parseScale","_this$scale","_this$scale2","_this$scale3","Matrix","matrix","a","b","c","e","f","det","_createSuper","Derived","hasNativeReflectConstruct","Reflect","sham","Proxy","Date","prototype","toString","_isNativeReflectConstruct","Super","NewTarget","constructor","Skew","_Matrix","_super","skew","_createSuper$1","_isNativeReflectConstruct$1","SkewX","_Skew","tan","_createSuper$2","_isNativeReflectConstruct$2","SkewY","Transform","transforms","data","parseTransforms","_parseTransform","_transform$split","_transform$split2","parseTransform","_parseTransform2","TransformType","transformTypes","unapply","applyToPoint","_element$getStyle$spl","_element$getStyle$spl2","transformOriginXProperty","_element$getStyle$spl3","skewX","skewY","Element","node","captureTextNodes","attributes","styles","stylesSpecificity","animationFrozen","animationFrozenValue","children","nodeType","attribute","nodeName","addStylesFromStyleDefinition","_style$split$map","_style$split$map2","id","getValue","childNodes","childNode","addChild","textNode","createTextNode","getText","createIfNotExists","attr","_attr","empty","skipAncestors","parentStyle","_style","save","mask","applyEffects","filter","setContext","renderChildren","clearContext","restore","fromElement","clipPathStyleProp","_context5","child","_context6","createElement","ignoreChildTypes","_context7","styleClasses","styleClass","_this$document","matchesSelector","specificity","existingSpecificity","ignoreStyles","toRestore","_context8","styleProp","_createSuper$3","_isNativeReflectConstruct$3","UnknownElement","_Element","wrapFontFamily","fontFamily","trimmed","prepareFontStyle","fontStyle","targetFontStyle","prepareFontWeight","fontWeight","targetFontWeight","Font","fontVariant","fontSize","inherit","inheritFont","process","join","font","parts","set","part","variants","weights","_part$split","_part$split2","BoundingBox","x1","Number","NaN","y1","x2","y2","addPoint","p0","p1","p2","p3","forX","b2ac","t1","addX","sumCubic","addY","t2","p0x","p0y","p1x","p1y","p2x","p2y","p3x","p3y","bezierCurveAdd","cp1x","cp1y","cp2x","cp2y","addBezierCurve","_createSuper$4","_isNativeReflectConstruct$4","RenderedElement","modifiedEmSizeStack","opacityStyle","fromMeasure","fillStyleProp","fillOpacityStyleProp","strokeStyleProp","strokeOpacityProp","isUrlDefinition","fillStyle","getFillStyleDefinition","_fillStyle","_fillStyle2","addOpacity","_strokeStyle","_strokeStyle2","strokeWidthStyleProp","newLineWidth","lineWidth","strokeLinecapStyleProp","strokeLinejoinStyleProp","strokeMiterlimitProp","pointOrderStyleProp","strokeDasharrayStyleProp","strokeDashoffsetProp","paintOrder","gaps","setLineDash","webkitLineDash","mozDash","offset","lineDashOffset","webkitLineDashOffset","mozDashOffset","fontStyleProp","fontStyleStyleProp","fontVariantStyleProp","fontWeightStyleProp","fontSizeStyleProp","fontFamilyStyleProp","isPixels","globalAlpha","calculateOpacity","popEmSize","_createSuper$5","_isNativeReflectConstruct$5","TextElement","_RenderedElement","measureCache","textBaseline","getTextBaseline","dxAttr","dyAttr","getAnchorDelta","_this2","getTElementBoundingBox","initializeCoordinates","childBoundingBox","getChildBoundingBox","addBoundingBox","inheritFontSize","getFontSize","measureText","char","glyph","isArabic","prevChar","nextChar","arabicForm","glyphs","missingGlyph","parentNode","index","lastIndex","trimRight","_this3","renderChild","isWorking","checkBoundingBox","getBoundingBox","renderTElementChildren","renderText","customFont","unitsPerEm","fontFace","ctxFont","isRTL","dx","getGlyph","lw","horizAdvX","strokeText","fillText","startI","textAnchor","measureTextRecursive","textParent","xAttr","yAttr","_width","adjustChildCoordinates","measure","measureTargetText","targetText","_measure","_createSuper$6","_isNativeReflectConstruct$6","TSpanElement","_TextElement","getTextFromNode","_createSuper$7","_isNativeReflectConstruct$7","TextNode","_TSpanElement","_createSuper$8","_isNativeReflectConstruct$8","PathParser","_SVGPathData","control","current","command","commands","previousCommand","angles","xProp","yProp","makeAbsolute","getPoint","CURVE_TO","SMOOTH_CURVE_TO","QUAD_TO","SMOOTH_QUAD_TO","_this$current","_this$control","ox","oy","relative","_this$current2","from","priorTo","angleTo","addMarkerAngle","j","_createSuper$9","_isNativeReflectConstruct$9","PathElement","pathParser","reset","isEnd","MOVE_TO","pathM","LINE_TO","pathL","HORIZ_LINE_TO","pathH","VERT_LINE_TO","pathV","pathC","pathS","pathQ","pathT","ARC","pathA","CLOSE_PATH","pathZ","getMarkerPoints","getMarkerAngles","checkPath","fillRuleStyleProp","stroke","markers","getMarkers","markersLastIndex","markerStartStyleProp","markerMidStyleProp","markerEndStyleProp","marker","_markers$","_marker","_markers$i","_point","_angle","_marker2","_markers$markersLastI","_point2","_angle2","addMarker","_PathElement$pathL","_PathElement$pathH","_PathElement$pathV","_PathElement$pathC","controlPoint","currentPoint","bezierCurveTo","_PathElement$pathS","_PathElement$pathQ","addQuadraticCurve","quadraticCurveTo","_PathElement$pathT","_PathElement$pathA","rX","rY","sweepFlag","xAxisRotation","centp","a1","ad","dir","ah","halfWay","r","sx","sy","arc","Boolean","getAsCurrentPoint","getAsControlPoint","getReflectedControlPoint","xRot","lArcFlag","currp","l","s","cpp","_createSuper$a","_isNativeReflectConstruct$a","SVGElement","root","setDefaults","getComputedStyle","getPropertyValue","fontSizeProp","_screen$viewPort","refXAttr","refYAttr","viewBoxAttr","setViewBox","removeCurrent","preserveAspectRatio","widthAttr","heightAttr","styleAttr","originWidth","originHeight","preserveAspectRatioAttr","_createSuper$b","_isNativeReflectConstruct$b","RectElement","_PathElement","rxAttr","ryAttr","rx","ry","KAPPA","_createSuper$c","_isNativeReflectConstruct$c","CircleElement","_createSuper$d","_isNativeReflectConstruct$d","EllipseElement","_createSuper$e","_isNativeReflectConstruct$e","LineElement","_this$getPoints","getPoints","_this$getPoints2","_this$getPoints2$","x0","y0","_this$getPoints2$2","_this$getPoints3","_this$getPoints4","_createSuper$f","_isNativeReflectConstruct$f","PolylineElement","parsePath","_points$","_createSuper$g","_isNativeReflectConstruct$g","PolygonElement","_PolylineElement","_this$points$","_createSuper$h","_isNativeReflectConstruct$h","PatternElement","parentOpacityProp","patternSvg","patternCanvas","createCanvas","patternCtx","getContext","_createSuper$i","_isNativeReflectConstruct$i","MarkerElement","orient","markerUnits","markerSvg","overflow","fill","_createSuper$j","_isNativeReflectConstruct$j","DefsElement","_createSuper$k","_isNativeReflectConstruct$k","GElement","_createSuper$l","_isNativeReflectConstruct$l","GradientElement","attributesToInherit","stops","_assertThisInitialize","stopsContainer","inheritStopContainer","gradient","getGradient","addParentOpacity","addColorStop","_document$screen","rootView","rect","group","attributeToInherit","_createSuper$m","_isNativeReflectConstruct$m","LinearGradientElement","_GradientElement","isBoundingBoxUnits","getGradientUnits","createLinearGradient","_createSuper$n","_isNativeReflectConstruct$n","RadialGradientElement","fx","fy","fr","createRadialGradient","_createSuper$o","_isNativeReflectConstruct$o","StopElement","stopOpacity","stopColor","_createSuper$p","_isNativeReflectConstruct$p","AnimateElement","duration","initialValue","initialUnits","removed","frozen","begin","getMilliseconds","maxDuration","to","values","attributeType","attributeName","_this$getProgress","getProgress","progress","newValue","prop","getProperty","getUnits","updated","calcValue","typeAttr","p","lb","floor","ub","ceil","_createSuper$q","_isNativeReflectConstruct$q","AnimateColorElement","_AnimateElement","colorFrom","colorTo","g","_createSuper$r","_isNativeReflectConstruct$r","AnimateTransformElement","transformFrom","transformTo","_createForOfIteratorHelper","o","allowArrayLike","it","minLen","_arrayLikeToArray","Object","_unsupportedIterableToArray","F","done","_e","TypeError","normalCompletion","didErr","step","_e2","return","arr","arr2","Array","_createSuper$s","_isNativeReflectConstruct$s","FontElement","_step","_iterator","fontFamilyStyle","unicode","_createSuper$t","_isNativeReflectConstruct$t","FontFaceElement","ascent","descent","_createSuper$u","_isNativeReflectConstruct$u","MissingGlyphElement","_createSuper$v","_isNativeReflectConstruct$v","GlyphElement","_createSuper$w","_isNativeReflectConstruct$w","TRefElement","firstChild","_createSuper$x","_isNativeReflectConstruct$x","AElement","hasText","open","_createForOfIteratorHelper$1","_arrayLikeToArray$1","_unsupportedIterableToArray$1","ownKeys","object","enumerableOnly","keys","symbols","sym","enumerable","_objectSpread","target","source","_createSuper$y","_isNativeReflectConstruct$y","TextPathElement","textWidth","textHeight","pathLength","glyphInfo","letterSpacingCache","measuresCache","pathElement","dataArray","parsePathData","_points","theta","dTheta","psi","fs","setTextData","textDecoration","rotation","partialText","idx","anchor","textFullWidth","fullPathWidth","spacesNumber","inputOffset","dy","charI","glyphWidth","getLetterSpacingAt","splineStep","getEquidistantPointOnPath","segment","dyX","dyY","has","chars","thisSpacing","parentSpacing","letterSpacing","textLen","dxSum","acc","cur","getPathLength","startOffset","_this2$findSegmentToF","findSegmentToFitChar","nextOffset","pathCommands","startX","startY","nextCommandType","calcLength","_PathElement$pathM$po","_PathElement$pathL$po","_PathElement$pathH$po","_PathElement$pathV$po","commandType","getLineLength","getPointOnCubicBezier","getPointOnQuadraticBezier","end","inc","abs","getPointOnEllipticalArc","dist","P1x","P1y","P2x","P2y","fromX","fromY","m","rise","pt","ix","iy","pRise","pRun","distance","fullLen","cumulativePathLength","currentT","getPointOnLine","pct","P3x","P3y","P4x","P4y","cosPsi","sinPsi","inputStep","inputPrecision","precision","equidistantCache","getPointOnPath","targetDistance","buildEquidistantCache","_createSuper$z","_isNativeReflectConstruct$z","ImageElement","_loadSvg","_loadImage","loaded","href","isSvg","images","loadSvg","loadImage","image","createImage","t0","console","error","svg","canvg","forkString","_image","complete","drawImage","_createSuper$A","_isNativeReflectConstruct$A","SymbolElement","SVGFontLoader","fonts","svgDocument","fontNode","_createSuper$B","_isNativeReflectConstruct$B","StyleElement","cssDefs","cssParts","cssClasses","cssProps","cssClass","props","cssProp","substr","currentSelector","_findSelectorMatch","_findSelectorMatch2","_findSelectorMatch3","_findSelectorMatch4","_findSelectorMatch5","_findSelectorMatch6","_findSelectorMatch7","_findSelectorMatch8","_findSelectorMatch9","_findSelectorMatch10","_findSelectorMatch11","_findSelectorMatch12","_findSelectorMatch13","_findSelectorMatch14","getSelectorSpecificity","srcs","src","_createSuper$C","_isNativeReflectConstruct$C","UseElement","tempSvg","oldParent","_element","_createSuper$D","_isNativeReflectConstruct$D","imGet","img","rgba","imSet","val","m1","m2","m3","FeColorMatrixElement","includeOpacity","__","srcData","getImageData","nr","ng","nb","na","putImageData","_createSuper$E","_isNativeReflectConstruct$E","MaskElement","ignoredStyles","removeStyles","maskCanvas","maskCtx","tmpCanvas","tmpCtx","globalCompositeOperation","fillRect","restoreStyles","_createSuper$F","_isNativeReflectConstruct$F","noop","ClipPathElement","contextProto","elementTransform","_createSuper$G","_isNativeReflectConstruct$G","FilterElement","px","py","efd","extraFilterDistance","tmpCanvasWidth","tmpCanvasHeight","_createSuper$H","_isNativeReflectConstruct$H","_createSuper$I","_isNativeReflectConstruct$I","_createSuper$J","_isNativeReflectConstruct$J","_createSuper$K","_isNativeReflectConstruct$K","_createSuper$L","_isNativeReflectConstruct$L","_createSuper$M","_isNativeReflectConstruct$M","elementTypes","FeDropShadowElement","___","____","_____","FeMorphologyElement","FeCompositeElement","FeGaussianBlurElement","blurRadius","body","getUniqueId","display","appendChild","removeChild","TitleElement","DescElement","ownKeys$1","_createImage","anonymousCrossOrigin","_args","crossOrigin","reject","onload","onerror","Document","_ref$rootEmSize","_ref$emSize","_ref$createCanvas","_ref$createImage","emSizeStack","uniqueId","bindCreateImage","wait","isImagesLoaded","isFontsLoaded","forceAnonymousCrossOrigin","documentElement","elementType","ElementType","config","_objectSpread$1","ownKeys$2","_objectSpread$2","Canvg","options","createDocumentElement","_from","_render","fromString","ready","baseOptions","resize","_args2"],"mappings":"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","file":"72a30a16-d2a35ee5f6dd24dfde4c.js","sourcesContent":["import _startsWithInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/starts-with';\nimport _parseFloat from '@babel/runtime-corejs3/core-js-stable/parse-float';\nimport _mapInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/map';\nimport _slicedToArray from '@babel/runtime-corejs3/helpers/slicedToArray';\nimport _Object$defineProperty from '@babel/runtime-corejs3/core-js-stable/object/define-property';\nimport _Object$defineProperties from '@babel/runtime-corejs3/core-js-stable/object/define-properties';\nimport _Object$getOwnPropertyDescriptors from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors';\nimport _forEachInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/for-each';\nimport _Object$getOwnPropertyDescriptor from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor';\nimport _filterInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/filter';\nimport _Object$getOwnPropertySymbols from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols';\nimport _Object$keys from '@babel/runtime-corejs3/core-js-stable/object/keys';\nimport _regeneratorRuntime from '@babel/runtime-corejs3/regenerator';\nimport _asyncToGenerator from '@babel/runtime-corejs3/helpers/asyncToGenerator';\nimport _defineProperty from '@babel/runtime-corejs3/helpers/defineProperty';\nimport _classCallCheck from '@babel/runtime-corejs3/helpers/classCallCheck';\nimport _createClass from '@babel/runtime-corejs3/helpers/createClass';\nimport _concatInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/concat';\nimport _reduceInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/reduce';\nimport _Date$now from '@babel/runtime-corejs3/core-js-stable/date/now';\nimport _everyInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/every';\nimport _Promise from '@babel/runtime-corejs3/core-js-stable/promise';\nimport _bindInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/bind';\nimport requestAnimationFrame from 'raf';\nimport _trimInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/trim';\nimport RGBColor from 'rgbcolor';\nimport _Reflect$construct from '@babel/runtime-corejs3/core-js-stable/reflect/construct';\nimport _inherits from '@babel/runtime-corejs3/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime-corejs3/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime-corejs3/helpers/getPrototypeOf';\nimport _toConsumableArray from '@babel/runtime-corejs3/helpers/toConsumableArray';\nimport _someInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/some';\nimport _includesInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/includes';\nimport _Array$from from '@babel/runtime-corejs3/core-js-stable/array/from';\nimport _reverseInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/reverse';\nimport _indexOfInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/index-of';\nimport _get from '@babel/runtime-corejs3/helpers/get';\nimport _fillInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/fill';\nimport { SVGPathData } from 'svg-pathdata';\nimport _Reflect$deleteProperty from '@babel/runtime-corejs3/core-js-stable/reflect/delete-property';\nimport _assertThisInitialized from '@babel/runtime-corejs3/helpers/assertThisInitialized';\nimport _valuesInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/values';\nimport _parseInt from '@babel/runtime-corejs3/core-js-stable/parse-int';\nimport _getIterator from '@babel/runtime-corejs3/core-js/get-iterator';\nimport _Array$isArray from '@babel/runtime-corejs3/core-js-stable/array/is-array';\nimport _getIteratorMethod from '@babel/runtime-corejs3/core-js/get-iterator-method';\nimport _Symbol from '@babel/runtime-corejs3/core-js-stable/symbol';\nimport _sliceInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/slice';\nimport _Map from '@babel/runtime-corejs3/core-js-stable/map';\nimport _Reflect$apply from '@babel/runtime-corejs3/core-js-stable/reflect/apply';\nimport _Reflect$getPrototypeOf from '@babel/runtime-corejs3/core-js-stable/reflect/get-prototype-of';\nimport { canvasRGBA } from 'stackblur-canvas';\n/**\r\n * HTML-safe compress white-spaces.\r\n * @param str - String to compress.\r\n */\n\nfunction compressSpaces(str) {\n  return str.replace(/(?!\\u3000)\\s+/gm, ' ');\n}\n/**\r\n * HTML-safe left trim.\r\n * @param str - String to trim.\r\n */\n\n\nfunction trimLeft(str) {\n  return str.replace(/^[\\n \\t]+/, '');\n}\n/**\r\n * HTML-safe right trim.\r\n * @param str - String to trim.\r\n */\n\n\nfunction trimRight(str) {\n  return str.replace(/[\\n \\t]+$/, '');\n}\n/**\r\n * String to numbers array.\r\n * @param str - Numbers string.\r\n */\n\n\nfunction toNumbers(str) {\n  var matches = (str || '').match(/-?(\\d+(?:\\.\\d*(?:[eE][+-]?\\d+)?)?|\\.\\d+)(?=\\D|$)/gm) || [];\n  return _mapInstanceProperty(matches).call(matches, _parseFloat);\n} // Microsoft Edge fix\n\n\nvar allUppercase = /^[A-Z-]+$/;\n/**\r\n * Normalize attribute name.\r\n * @param name - Attribute name.\r\n */\n\nfunction normalizeAttributeName(name) {\n  if (allUppercase.test(name)) {\n    return name.toLowerCase();\n  }\n\n  return name;\n}\n/**\r\n * Parse external URL.\r\n * @param url - CSS url string.\r\n */\n\n\nfunction parseExternalUrl(url) {\n  //                                   single quotes [2]\n  //                                   v           double quotes [3]\n  //                                   v           v        no quotes [4]\n  //                                   v           v        v\n  var urlMatch = url.match(/url\\(('([^']+)'|\"([^\"]+)\"|([^'\"\\)]+))\\)/) || [];\n  return urlMatch[2] || urlMatch[3] || urlMatch[4];\n}\n/**\r\n * Transform floats to integers in rgb colors.\r\n * @param color - Color to normalize.\r\n */\n\n\nfunction normalizeColor(color) {\n  if (!_startsWithInstanceProperty(color).call(color, 'rgb')) {\n    return color;\n  }\n\n  var rgbParts = 3;\n  var normalizedColor = color.replace(/\\d+(\\.\\d+)?/g, function (num, isFloat) {\n    return rgbParts-- && isFloat ? String(Math.round(_parseFloat(num))) : num;\n  });\n  return normalizedColor;\n} // slightly modified version of https://github.com/keeganstreet/specificity/blob/master/specificity.js\n\n\nvar attributeRegex = /(\\[[^\\]]+\\])/g;\nvar idRegex = /(#[^\\s\\+>~\\.\\[:]+)/g;\nvar classRegex = /(\\.[^\\s\\+>~\\.\\[:]+)/g;\nvar pseudoElementRegex = /(::[^\\s\\+>~\\.\\[:]+|:first-line|:first-letter|:before|:after)/gi;\nvar pseudoClassWithBracketsRegex = /(:[\\w-]+\\([^\\)]*\\))/gi;\nvar pseudoClassRegex = /(:[^\\s\\+>~\\.\\[:]+)/g;\nvar elementRegex = /([^\\s\\+>~\\.\\[:]+)/g;\n\nfunction findSelectorMatch(selector, regex) {\n  var matches = selector.match(regex);\n\n  if (!matches) {\n    return [selector, 0];\n  }\n\n  return [selector.replace(regex, ' '), matches.length];\n}\n/**\r\n * Measure selector specificity.\r\n * @param selector - Selector to measure.\r\n */\n\n\nfunction getSelectorSpecificity(selector) {\n  var specificity = [0, 0, 0];\n  var currentSelector = selector.replace(/:not\\(([^\\)]*)\\)/g, '     $1 ').replace(/{[\\s\\S]*/gm, ' ');\n  var delta = 0;\n\n  var _findSelectorMatch = findSelectorMatch(currentSelector, attributeRegex);\n\n  var _findSelectorMatch2 = _slicedToArray(_findSelectorMatch, 2);\n\n  currentSelector = _findSelectorMatch2[0];\n  delta = _findSelectorMatch2[1];\n  specificity[1] += delta;\n\n  var _findSelectorMatch3 = findSelectorMatch(currentSelector, idRegex);\n\n  var _findSelectorMatch4 = _slicedToArray(_findSelectorMatch3, 2);\n\n  currentSelector = _findSelectorMatch4[0];\n  delta = _findSelectorMatch4[1];\n  specificity[0] += delta;\n\n  var _findSelectorMatch5 = findSelectorMatch(currentSelector, classRegex);\n\n  var _findSelectorMatch6 = _slicedToArray(_findSelectorMatch5, 2);\n\n  currentSelector = _findSelectorMatch6[0];\n  delta = _findSelectorMatch6[1];\n  specificity[1] += delta;\n\n  var _findSelectorMatch7 = findSelectorMatch(currentSelector, pseudoElementRegex);\n\n  var _findSelectorMatch8 = _slicedToArray(_findSelectorMatch7, 2);\n\n  currentSelector = _findSelectorMatch8[0];\n  delta = _findSelectorMatch8[1];\n  specificity[2] += delta;\n\n  var _findSelectorMatch9 = findSelectorMatch(currentSelector, pseudoClassWithBracketsRegex);\n\n  var _findSelectorMatch10 = _slicedToArray(_findSelectorMatch9, 2);\n\n  currentSelector = _findSelectorMatch10[0];\n  delta = _findSelectorMatch10[1];\n  specificity[1] += delta;\n\n  var _findSelectorMatch11 = findSelectorMatch(currentSelector, pseudoClassRegex);\n\n  var _findSelectorMatch12 = _slicedToArray(_findSelectorMatch11, 2);\n\n  currentSelector = _findSelectorMatch12[0];\n  delta = _findSelectorMatch12[1];\n  specificity[1] += delta;\n  currentSelector = currentSelector.replace(/[\\*\\s\\+>~]/g, ' ').replace(/[#\\.]/g, ' ');\n\n  var _findSelectorMatch13 = findSelectorMatch(currentSelector, elementRegex);\n\n  var _findSelectorMatch14 = _slicedToArray(_findSelectorMatch13, 2);\n\n  currentSelector = _findSelectorMatch14[0];\n  delta = _findSelectorMatch14[1]; // lgtm [js/useless-assignment-to-local]\n\n  specificity[2] += delta;\n  return specificity.join('');\n}\n\nvar PSEUDO_ZERO = .00000001;\n/**\r\n * Vector magnitude.\r\n */\n\nfunction vectorMagnitude(v) {\n  return Math.sqrt(Math.pow(v[0], 2) + Math.pow(v[1], 2));\n}\n/**\r\n * Ratio between two vectors.\r\n */\n\n\nfunction vectorsRatio(u, v) {\n  return (u[0] * v[0] + u[1] * v[1]) / (vectorMagnitude(u) * vectorMagnitude(v));\n}\n/**\r\n * Angle between two vectors.\r\n */\n\n\nfunction vectorsAngle(u, v) {\n  return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vectorsRatio(u, v));\n}\n\nfunction CB1(t) {\n  return t * t * t;\n}\n\nfunction CB2(t) {\n  return 3 * t * t * (1 - t);\n}\n\nfunction CB3(t) {\n  return 3 * t * (1 - t) * (1 - t);\n}\n\nfunction CB4(t) {\n  return (1 - t) * (1 - t) * (1 - t);\n}\n\nfunction QB1(t) {\n  return t * t;\n}\n\nfunction QB2(t) {\n  return 2 * t * (1 - t);\n}\n\nfunction QB3(t) {\n  return (1 - t) * (1 - t);\n}\n\nvar Property = /*#__PURE__*/function () {\n  function Property(document, name, value) {\n    _classCallCheck(this, Property);\n\n    this.document = document;\n    this.name = name;\n    this.value = value;\n    this.isNormalizedColor = false;\n  }\n\n  _createClass(Property, [{\n    key: \"split\",\n    value: function split() {\n      var _context, _context2;\n\n      var separator = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ' ';\n      var document = this.document,\n          name = this.name;\n      return _mapInstanceProperty(_context = _trimInstanceProperty(_context2 = compressSpaces(this.getString())).call(_context2).split(separator)).call(_context, function (value) {\n        return new Property(document, name, value);\n      });\n    }\n  }, {\n    key: \"hasValue\",\n    value: function hasValue(zeroIsValue) {\n      var value = this.value;\n      return value !== null && value !== '' && (zeroIsValue || value !== 0) && typeof value !== 'undefined';\n    }\n  }, {\n    key: \"isString\",\n    value: function isString(regexp) {\n      var value = this.value;\n      var result = typeof value === 'string';\n\n      if (!result || !regexp) {\n        return result;\n      }\n\n      return regexp.test(value);\n    }\n  }, {\n    key: \"isUrlDefinition\",\n    value: function isUrlDefinition() {\n      return this.isString(/^url\\(/);\n    }\n  }, {\n    key: \"isPixels\",\n    value: function isPixels() {\n      if (!this.hasValue()) {\n        return false;\n      }\n\n      var asString = this.getString();\n\n      switch (true) {\n        case /px$/.test(asString):\n        case /^[0-9]+$/.test(asString):\n          return true;\n\n        default:\n          return false;\n      }\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      this.value = value;\n      return this;\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(def) {\n      if (typeof def === 'undefined' || this.hasValue()) {\n        return this.value;\n      }\n\n      return def;\n    }\n  }, {\n    key: \"getNumber\",\n    value: function getNumber(def) {\n      if (!this.hasValue()) {\n        if (typeof def === 'undefined') {\n          return 0;\n        }\n\n        return _parseFloat(def);\n      }\n\n      var value = this.value;\n\n      var n = _parseFloat(value);\n\n      if (this.isString(/%$/)) {\n        n = n / 100.0;\n      }\n\n      return n;\n    }\n  }, {\n    key: \"getString\",\n    value: function getString(def) {\n      if (typeof def === 'undefined' || this.hasValue()) {\n        return typeof this.value === 'undefined' ? '' : String(this.value);\n      }\n\n      return String(def);\n    }\n  }, {\n    key: \"getColor\",\n    value: function getColor(def) {\n      var color = this.getString(def);\n\n      if (this.isNormalizedColor) {\n        return color;\n      }\n\n      this.isNormalizedColor = true;\n      color = normalizeColor(color);\n      this.value = color;\n      return color;\n    }\n  }, {\n    key: \"getDpi\",\n    value: function getDpi() {\n      return 96.0; // TODO: compute?\n    }\n  }, {\n    key: \"getRem\",\n    value: function getRem() {\n      return this.document.rootEmSize;\n    }\n  }, {\n    key: \"getEm\",\n    value: function getEm() {\n      return this.document.emSize;\n    }\n  }, {\n    key: \"getUnits\",\n    value: function getUnits() {\n      return this.getString().replace(/[0-9\\.\\-]/g, '');\n    }\n  }, {\n    key: \"getPixels\",\n    value: function getPixels(axisOrIsFontSize) {\n      var processPercent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!this.hasValue()) {\n        return 0;\n      }\n\n      var _ref = typeof axisOrIsFontSize === 'boolean' ? [undefined, axisOrIsFontSize] : [axisOrIsFontSize],\n          _ref2 = _slicedToArray(_ref, 2),\n          axis = _ref2[0],\n          isFontSize = _ref2[1];\n\n      var viewPort = this.document.screen.viewPort;\n\n      switch (true) {\n        case this.isString(/vmin$/):\n          return this.getNumber() / 100.0 * Math.min(viewPort.computeSize('x'), viewPort.computeSize('y'));\n\n        case this.isString(/vmax$/):\n          return this.getNumber() / 100.0 * Math.max(viewPort.computeSize('x'), viewPort.computeSize('y'));\n\n        case this.isString(/vw$/):\n          return this.getNumber() / 100.0 * viewPort.computeSize('x');\n\n        case this.isString(/vh$/):\n          return this.getNumber() / 100.0 * viewPort.computeSize('y');\n\n        case this.isString(/rem$/):\n          return this.getNumber() * this.getRem();\n\n        case this.isString(/em$/):\n          return this.getNumber() * this.getEm();\n\n        case this.isString(/ex$/):\n          return this.getNumber() * this.getEm() / 2.0;\n\n        case this.isString(/px$/):\n          return this.getNumber();\n\n        case this.isString(/pt$/):\n          return this.getNumber() * this.getDpi() * (1.0 / 72.0);\n\n        case this.isString(/pc$/):\n          return this.getNumber() * 15;\n\n        case this.isString(/cm$/):\n          return this.getNumber() * this.getDpi() / 2.54;\n\n        case this.isString(/mm$/):\n          return this.getNumber() * this.getDpi() / 25.4;\n\n        case this.isString(/in$/):\n          return this.getNumber() * this.getDpi();\n\n        case this.isString(/%$/) && isFontSize:\n          return this.getNumber() * this.getEm();\n\n        case this.isString(/%$/):\n          return this.getNumber() * viewPort.computeSize(axis);\n\n        default:\n          {\n            var n = this.getNumber();\n\n            if (processPercent && n < 1.0) {\n              return n * viewPort.computeSize(axis);\n            }\n\n            return n;\n          }\n      }\n    }\n  }, {\n    key: \"getMilliseconds\",\n    value: function getMilliseconds() {\n      if (!this.hasValue()) {\n        return 0;\n      }\n\n      if (this.isString(/ms$/)) {\n        return this.getNumber();\n      }\n\n      return this.getNumber() * 1000;\n    }\n  }, {\n    key: \"getRadians\",\n    value: function getRadians() {\n      if (!this.hasValue()) {\n        return 0;\n      }\n\n      switch (true) {\n        case this.isString(/deg$/):\n          return this.getNumber() * (Math.PI / 180.0);\n\n        case this.isString(/grad$/):\n          return this.getNumber() * (Math.PI / 200.0);\n\n        case this.isString(/rad$/):\n          return this.getNumber();\n\n        default:\n          return this.getNumber() * (Math.PI / 180.0);\n      }\n    }\n  }, {\n    key: \"getDefinition\",\n    value: function getDefinition() {\n      var asString = this.getString();\n      var name = asString.match(/#([^\\)'\"]+)/);\n\n      if (name) {\n        name = name[1];\n      }\n\n      if (!name) {\n        name = asString;\n      }\n\n      return this.document.definitions[name];\n    }\n  }, {\n    key: \"getFillStyleDefinition\",\n    value: function getFillStyleDefinition(element, opacity) {\n      var def = this.getDefinition();\n\n      if (!def) {\n        return null;\n      } // gradient\n\n\n      if (typeof def.createGradient === 'function') {\n        return def.createGradient(this.document.ctx, element, opacity);\n      } // pattern\n\n\n      if (typeof def.createPattern === 'function') {\n        if (def.getHrefAttribute().hasValue()) {\n          var patternTransform = def.getAttribute('patternTransform');\n          def = def.getHrefAttribute().getDefinition();\n\n          if (patternTransform.hasValue()) {\n            def.getAttribute('patternTransform', true).setValue(patternTransform.value);\n          }\n        }\n\n        return def.createPattern(this.document.ctx, element, opacity);\n      }\n\n      return null;\n    }\n  }, {\n    key: \"getTextBaseline\",\n    value: function getTextBaseline() {\n      if (!this.hasValue()) {\n        return null;\n      }\n\n      return Property.textBaselineMapping[this.getString()];\n    }\n  }, {\n    key: \"addOpacity\",\n    value: function addOpacity(opacity) {\n      var value = this.getColor();\n      var len = value.length;\n      var commas = 0; // Simulate old RGBColor version, which can't parse rgba.\n\n      for (var i = 0; i < len; i++) {\n        if (value[i] === ',') {\n          commas++;\n        }\n\n        if (commas === 3) {\n          break;\n        }\n      }\n\n      if (opacity.hasValue() && this.isString() && commas !== 3) {\n        var color = new RGBColor(value);\n\n        if (color.ok) {\n          color.alpha = opacity.getNumber();\n          value = color.toRGBA();\n        }\n      }\n\n      return new Property(this.document, this.name, value);\n    }\n  }], [{\n    key: \"empty\",\n    value: function empty(document) {\n      return new Property(document, 'EMPTY', '');\n    }\n  }]);\n\n  return Property;\n}();\n\nProperty.textBaselineMapping = {\n  'baseline': 'alphabetic',\n  'before-edge': 'top',\n  'text-before-edge': 'top',\n  'middle': 'middle',\n  'central': 'middle',\n  'after-edge': 'bottom',\n  'text-after-edge': 'bottom',\n  'ideographic': 'ideographic',\n  'alphabetic': 'alphabetic',\n  'hanging': 'hanging',\n  'mathematical': 'alphabetic'\n};\n\nvar ViewPort = /*#__PURE__*/function () {\n  function ViewPort() {\n    _classCallCheck(this, ViewPort);\n\n    this.viewPorts = [];\n  }\n\n  _createClass(ViewPort, [{\n    key: \"clear\",\n    value: function clear() {\n      this.viewPorts = [];\n    }\n  }, {\n    key: \"setCurrent\",\n    value: function setCurrent(width, height) {\n      this.viewPorts.push({\n        width: width,\n        height: height\n      });\n    }\n  }, {\n    key: \"removeCurrent\",\n    value: function removeCurrent() {\n      this.viewPorts.pop();\n    }\n  }, {\n    key: \"getCurrent\",\n    value: function getCurrent() {\n      var viewPorts = this.viewPorts;\n      return viewPorts[viewPorts.length - 1];\n    }\n  }, {\n    key: \"computeSize\",\n    value: function computeSize(d) {\n      if (typeof d === 'number') {\n        return d;\n      }\n\n      if (d === 'x') {\n        return this.width;\n      }\n\n      if (d === 'y') {\n        return this.height;\n      }\n\n      return Math.sqrt(Math.pow(this.width, 2) + Math.pow(this.height, 2)) / Math.sqrt(2);\n    }\n  }, {\n    key: \"width\",\n    get: function get() {\n      return this.getCurrent().width;\n    }\n  }, {\n    key: \"height\",\n    get: function get() {\n      return this.getCurrent().height;\n    }\n  }]);\n\n  return ViewPort;\n}();\n\nvar Point = /*#__PURE__*/function () {\n  function Point(x, y) {\n    _classCallCheck(this, Point);\n\n    this.x = x;\n    this.y = y;\n  }\n\n  _createClass(Point, [{\n    key: \"angleTo\",\n    value: function angleTo(point) {\n      return Math.atan2(point.y - this.y, point.x - this.x);\n    }\n  }, {\n    key: \"applyTransform\",\n    value: function applyTransform(transform) {\n      var x = this.x,\n          y = this.y;\n      var xp = x * transform[0] + y * transform[2] + transform[4];\n      var yp = x * transform[1] + y * transform[3] + transform[5];\n      this.x = xp;\n      this.y = yp;\n    }\n  }], [{\n    key: \"parse\",\n    value: function parse(point) {\n      var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n      var _toNumbers = toNumbers(point),\n          _toNumbers2 = _slicedToArray(_toNumbers, 2),\n          _toNumbers2$ = _toNumbers2[0],\n          x = _toNumbers2$ === void 0 ? defaultValue : _toNumbers2$,\n          _toNumbers2$2 = _toNumbers2[1],\n          y = _toNumbers2$2 === void 0 ? defaultValue : _toNumbers2$2;\n\n      return new Point(x, y);\n    }\n  }, {\n    key: \"parseScale\",\n    value: function parseScale(scale) {\n      var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n      var _toNumbers3 = toNumbers(scale),\n          _toNumbers4 = _slicedToArray(_toNumbers3, 2),\n          _toNumbers4$ = _toNumbers4[0],\n          x = _toNumbers4$ === void 0 ? defaultValue : _toNumbers4$,\n          _toNumbers4$2 = _toNumbers4[1],\n          y = _toNumbers4$2 === void 0 ? x : _toNumbers4$2;\n\n      return new Point(x, y);\n    }\n  }, {\n    key: \"parsePath\",\n    value: function parsePath(path) {\n      var points = toNumbers(path);\n      var len = points.length;\n      var pathPoints = [];\n\n      for (var i = 0; i < len; i += 2) {\n        pathPoints.push(new Point(points[i], points[i + 1]));\n      }\n\n      return pathPoints;\n    }\n  }]);\n\n  return Point;\n}();\n\nvar Mouse = /*#__PURE__*/function () {\n  function Mouse(screen) {\n    var _context, _context2;\n\n    _classCallCheck(this, Mouse);\n\n    this.screen = screen;\n    this.working = false;\n    this.events = [];\n    this.eventElements = [];\n    this.onClick = _bindInstanceProperty(_context = this.onClick).call(_context, this);\n    this.onMouseMove = _bindInstanceProperty(_context2 = this.onMouseMove).call(_context2, this);\n  }\n\n  _createClass(Mouse, [{\n    key: \"isWorking\",\n    value: function isWorking() {\n      return this.working;\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      if (this.working) {\n        return;\n      }\n\n      var screen = this.screen,\n          onClick = this.onClick,\n          onMouseMove = this.onMouseMove;\n      var canvas = screen.ctx.canvas;\n      canvas.onclick = onClick;\n      canvas.onmousemove = onMouseMove;\n      this.working = true;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (!this.working) {\n        return;\n      }\n\n      var canvas = this.screen.ctx.canvas;\n      this.working = false;\n      canvas.onclick = null;\n      canvas.onmousemove = null;\n    }\n  }, {\n    key: \"hasEvents\",\n    value: function hasEvents() {\n      return this.working && this.events.length > 0;\n    }\n  }, {\n    key: \"runEvents\",\n    value: function runEvents() {\n      if (!this.working) {\n        return;\n      }\n\n      var document = this.screen,\n          events = this.events,\n          eventElements = this.eventElements;\n      var style = document.ctx.canvas.style;\n\n      if (style) {\n        style.cursor = '';\n      }\n\n      _forEachInstanceProperty(events).call(events, function (_ref, i) {\n        var run = _ref.run;\n        var element = eventElements[i];\n\n        while (element) {\n          run(element);\n          element = element.parent;\n        }\n      }); // done running, clear\n\n\n      this.events = [];\n      this.eventElements = [];\n    }\n  }, {\n    key: \"checkPath\",\n    value: function checkPath(element, ctx) {\n      if (!this.working || !ctx) {\n        return;\n      }\n\n      var events = this.events,\n          eventElements = this.eventElements;\n\n      _forEachInstanceProperty(events).call(events, function (_ref2, i) {\n        var x = _ref2.x,\n            y = _ref2.y;\n\n        if (!eventElements[i] && ctx.isPointInPath && ctx.isPointInPath(x, y)) {\n          eventElements[i] = element;\n        }\n      });\n    }\n  }, {\n    key: \"checkBoundingBox\",\n    value: function checkBoundingBox(element, boundingBox) {\n      if (!this.working || !boundingBox) {\n        return;\n      }\n\n      var events = this.events,\n          eventElements = this.eventElements;\n\n      _forEachInstanceProperty(events).call(events, function (_ref3, i) {\n        var x = _ref3.x,\n            y = _ref3.y;\n\n        if (!eventElements[i] && boundingBox.isPointInBox(x, y)) {\n          eventElements[i] = element;\n        }\n      });\n    }\n  }, {\n    key: \"mapXY\",\n    value: function mapXY(x, y) {\n      var _this$screen = this.screen,\n          window = _this$screen.window,\n          ctx = _this$screen.ctx;\n      var point = new Point(x, y);\n      var element = ctx.canvas;\n\n      while (element) {\n        point.x -= element.offsetLeft;\n        point.y -= element.offsetTop;\n        element = element.offsetParent;\n      }\n\n      if (window.scrollX) {\n        point.x += window.scrollX;\n      }\n\n      if (window.scrollY) {\n        point.y += window.scrollY;\n      }\n\n      return point;\n    }\n  }, {\n    key: \"onClick\",\n    value: function onClick(evt) {\n      var _this$mapXY = this.mapXY((evt || event).clientX, (evt || event).clientY),\n          x = _this$mapXY.x,\n          y = _this$mapXY.y;\n\n      this.events.push({\n        type: 'onclick',\n        x: x,\n        y: y,\n        run: function run(event) {\n          if (event.onClick) {\n            event.onClick();\n          }\n        }\n      });\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(evt) {\n      var _this$mapXY2 = this.mapXY((evt || event).clientX, (evt || event).clientY),\n          x = _this$mapXY2.x,\n          y = _this$mapXY2.y;\n\n      this.events.push({\n        type: 'onmousemove',\n        x: x,\n        y: y,\n        run: function run(event) {\n          if (event.onMouseMove) {\n            event.onMouseMove();\n          }\n        }\n      });\n    }\n  }]);\n\n  return Mouse;\n}();\n\nvar defaultWindow = typeof window !== 'undefined' ? window : null;\nvar defaultFetch = typeof fetch !== 'undefined' ? _bindInstanceProperty(fetch).call(fetch, void 0) // `fetch` depends on context: `someObject.fetch(...)` will throw error.\n: null;\n\nvar Screen = /*#__PURE__*/function () {\n  function Screen(ctx) {\n    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        _ref$fetch = _ref.fetch,\n        fetch = _ref$fetch === void 0 ? defaultFetch : _ref$fetch,\n        _ref$window = _ref.window,\n        window = _ref$window === void 0 ? defaultWindow : _ref$window;\n\n    _classCallCheck(this, Screen);\n\n    this.ctx = ctx;\n    this.FRAMERATE = 30;\n    this.MAX_VIRTUAL_PIXELS = 30000;\n    this.CLIENT_WIDTH = 800;\n    this.CLIENT_HEIGHT = 600;\n    this.viewPort = new ViewPort();\n    this.mouse = new Mouse(this);\n    this.animations = [];\n    this.waits = [];\n    this.frameDuration = 0;\n    this.isReadyLock = false;\n    this.isFirstRender = true;\n    this.intervalId = null;\n    this.window = window;\n    this.fetch = fetch;\n  }\n\n  _createClass(Screen, [{\n    key: \"wait\",\n    value: function wait(checker) {\n      this.waits.push(checker);\n    }\n  }, {\n    key: \"ready\",\n    value: function ready() {\n      if (!this.readyPromise) {\n        return _Promise.resolve();\n      }\n\n      return this.readyPromise;\n    }\n  }, {\n    key: \"isReady\",\n    value: function isReady() {\n      var _context;\n\n      if (this.isReadyLock) {\n        return true;\n      }\n\n      var isReadyLock = _everyInstanceProperty(_context = this.waits).call(_context, function (_) {\n        return _();\n      });\n\n      if (isReadyLock) {\n        this.waits = [];\n\n        if (this.resolveReady) {\n          this.resolveReady();\n        }\n      }\n\n      this.isReadyLock = isReadyLock;\n      return isReadyLock;\n    }\n  }, {\n    key: \"setDefaults\",\n    value: function setDefaults(ctx) {\n      // initial values and defaults\n      ctx.strokeStyle = 'rgba(0,0,0,0)';\n      ctx.lineCap = 'butt';\n      ctx.lineJoin = 'miter';\n      ctx.miterLimit = 4;\n    }\n  }, {\n    key: \"setViewBox\",\n    value: function setViewBox(_ref2) {\n      var document = _ref2.document,\n          ctx = _ref2.ctx,\n          aspectRatio = _ref2.aspectRatio,\n          width = _ref2.width,\n          desiredWidth = _ref2.desiredWidth,\n          height = _ref2.height,\n          desiredHeight = _ref2.desiredHeight,\n          _ref2$minX = _ref2.minX,\n          minX = _ref2$minX === void 0 ? 0 : _ref2$minX,\n          _ref2$minY = _ref2.minY,\n          minY = _ref2$minY === void 0 ? 0 : _ref2$minY,\n          refX = _ref2.refX,\n          refY = _ref2.refY,\n          _ref2$clip = _ref2.clip,\n          clip = _ref2$clip === void 0 ? false : _ref2$clip,\n          _ref2$clipX = _ref2.clipX,\n          clipX = _ref2$clipX === void 0 ? 0 : _ref2$clipX,\n          _ref2$clipY = _ref2.clipY,\n          clipY = _ref2$clipY === void 0 ? 0 : _ref2$clipY; // aspect ratio - http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute\n\n      var cleanAspectRatio = compressSpaces(aspectRatio).replace(/^defer\\s/, ''); // ignore defer\n\n      var _cleanAspectRatio$spl = cleanAspectRatio.split(' '),\n          _cleanAspectRatio$spl2 = _slicedToArray(_cleanAspectRatio$spl, 2),\n          aspectRatioAlign = _cleanAspectRatio$spl2[0],\n          aspectRatioMeetOrSlice = _cleanAspectRatio$spl2[1];\n\n      var align = aspectRatioAlign || 'xMidYMid';\n      var meetOrSlice = aspectRatioMeetOrSlice || 'meet'; // calculate scale\n\n      var scaleX = width / desiredWidth;\n      var scaleY = height / desiredHeight;\n      var scaleMin = Math.min(scaleX, scaleY);\n      var scaleMax = Math.max(scaleX, scaleY);\n      var finalDesiredWidth = desiredWidth;\n      var finalDesiredHeight = desiredHeight;\n\n      if (meetOrSlice === 'meet') {\n        finalDesiredWidth *= scaleMin;\n        finalDesiredHeight *= scaleMin;\n      }\n\n      if (meetOrSlice === 'slice') {\n        finalDesiredWidth *= scaleMax;\n        finalDesiredHeight *= scaleMax;\n      }\n\n      var refXProp = new Property(document, 'refX', refX);\n      var refYProp = new Property(document, 'refY', refY);\n      var hasRefs = refXProp.hasValue() && refYProp.hasValue();\n\n      if (hasRefs) {\n        ctx.translate(-scaleMin * refXProp.getPixels('x'), -scaleMin * refYProp.getPixels('y'));\n      }\n\n      if (clip) {\n        var scaledClipX = scaleMin * clipX;\n        var scaledClipY = scaleMin * clipY;\n        ctx.beginPath();\n        ctx.moveTo(scaledClipX, scaledClipY);\n        ctx.lineTo(width, scaledClipY);\n        ctx.lineTo(width, height);\n        ctx.lineTo(scaledClipX, height);\n        ctx.closePath();\n        ctx.clip();\n      }\n\n      if (!hasRefs) {\n        var isMeetMinY = meetOrSlice === 'meet' && scaleMin === scaleY;\n        var isSliceMaxY = meetOrSlice === 'slice' && scaleMax === scaleY;\n        var isMeetMinX = meetOrSlice === 'meet' && scaleMin === scaleX;\n        var isSliceMaxX = meetOrSlice === 'slice' && scaleMax === scaleX;\n\n        if (/^xMid/.test(align) && (isMeetMinY || isSliceMaxY)) {\n          ctx.translate(width / 2.0 - finalDesiredWidth / 2.0, 0);\n        }\n\n        if (/YMid$/.test(align) && (isMeetMinX || isSliceMaxX)) {\n          ctx.translate(0, height / 2.0 - finalDesiredHeight / 2.0);\n        }\n\n        if (/^xMax/.test(align) && (isMeetMinY || isSliceMaxY)) {\n          ctx.translate(width - finalDesiredWidth, 0);\n        }\n\n        if (/YMax$/.test(align) && (isMeetMinX || isSliceMaxX)) {\n          ctx.translate(0, height - finalDesiredHeight);\n        }\n      } // scale\n\n\n      switch (true) {\n        case align === 'none':\n          ctx.scale(scaleX, scaleY);\n          break;\n\n        case meetOrSlice === 'meet':\n          ctx.scale(scaleMin, scaleMin);\n          break;\n\n        case meetOrSlice === 'slice':\n          ctx.scale(scaleMax, scaleMax);\n          break;\n      } // translate\n\n\n      ctx.translate(-minX, -minY);\n    }\n  }, {\n    key: \"start\",\n    value: function start(element) {\n      var _this = this;\n\n      var _ref3 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          _ref3$enableRedraw = _ref3.enableRedraw,\n          enableRedraw = _ref3$enableRedraw === void 0 ? false : _ref3$enableRedraw,\n          _ref3$ignoreMouse = _ref3.ignoreMouse,\n          ignoreMouse = _ref3$ignoreMouse === void 0 ? false : _ref3$ignoreMouse,\n          _ref3$ignoreAnimation = _ref3.ignoreAnimation,\n          ignoreAnimation = _ref3$ignoreAnimation === void 0 ? false : _ref3$ignoreAnimation,\n          _ref3$ignoreDimension = _ref3.ignoreDimensions,\n          ignoreDimensions = _ref3$ignoreDimension === void 0 ? false : _ref3$ignoreDimension,\n          _ref3$ignoreClear = _ref3.ignoreClear,\n          ignoreClear = _ref3$ignoreClear === void 0 ? false : _ref3$ignoreClear,\n          forceRedraw = _ref3.forceRedraw,\n          scaleWidth = _ref3.scaleWidth,\n          scaleHeight = _ref3.scaleHeight,\n          offsetX = _ref3.offsetX,\n          offsetY = _ref3.offsetY;\n\n      var FRAMERATE = this.FRAMERATE,\n          mouse = this.mouse;\n      var frameDuration = 1000 / FRAMERATE;\n      this.frameDuration = frameDuration;\n      this.readyPromise = new _Promise(function (resolve) {\n        _this.resolveReady = resolve;\n      });\n\n      if (this.isReady()) {\n        this.render(element, ignoreDimensions, ignoreClear, scaleWidth, scaleHeight, offsetX, offsetY);\n      }\n\n      if (!enableRedraw) {\n        return;\n      }\n\n      var now = _Date$now();\n\n      var then = now;\n      var delta = 0;\n\n      var tick = function tick() {\n        now = _Date$now();\n        delta = now - then;\n\n        if (delta >= frameDuration) {\n          then = now - delta % frameDuration;\n\n          if (_this.shouldUpdate(ignoreAnimation, forceRedraw)) {\n            _this.render(element, ignoreDimensions, ignoreClear, scaleWidth, scaleHeight, offsetX, offsetY);\n\n            mouse.runEvents();\n          }\n        }\n\n        _this.intervalId = requestAnimationFrame(tick);\n      };\n\n      if (!ignoreMouse) {\n        mouse.start();\n      }\n\n      this.intervalId = requestAnimationFrame(tick);\n    }\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      if (this.intervalId) {\n        requestAnimationFrame.cancel(this.intervalId);\n        this.intervalId = null;\n      }\n\n      this.mouse.stop();\n    }\n  }, {\n    key: \"shouldUpdate\",\n    value: function shouldUpdate(ignoreAnimation, forceRedraw) {\n      // need update from animations?\n      if (!ignoreAnimation) {\n        var _context2;\n\n        var frameDuration = this.frameDuration;\n\n        var shouldUpdate = _reduceInstanceProperty(_context2 = this.animations).call(_context2, function (shouldUpdate, animation) {\n          return animation.update(frameDuration) || shouldUpdate;\n        }, false);\n\n        if (shouldUpdate) {\n          return true;\n        }\n      } // need update from redraw?\n\n\n      if (typeof forceRedraw === 'function' && forceRedraw()) {\n        return true;\n      }\n\n      if (!this.isReadyLock && this.isReady()) {\n        return true;\n      } // need update from mouse events?\n\n\n      if (this.mouse.hasEvents()) {\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"render\",\n    value: function render(element, ignoreDimensions, ignoreClear, scaleWidth, scaleHeight, offsetX, offsetY) {\n      var CLIENT_WIDTH = this.CLIENT_WIDTH,\n          CLIENT_HEIGHT = this.CLIENT_HEIGHT,\n          viewPort = this.viewPort,\n          ctx = this.ctx,\n          isFirstRender = this.isFirstRender;\n      var canvas = ctx.canvas;\n      viewPort.clear();\n\n      if (canvas.width && canvas.height) {\n        viewPort.setCurrent(canvas.width, canvas.height);\n      } else {\n        viewPort.setCurrent(CLIENT_WIDTH, CLIENT_HEIGHT);\n      }\n\n      var widthStyle = element.getStyle('width');\n      var heightStyle = element.getStyle('height');\n\n      if (!ignoreDimensions && (isFirstRender || typeof scaleWidth !== 'number' && typeof scaleHeight !== 'number')) {\n        // set canvas size\n        if (widthStyle.hasValue()) {\n          canvas.width = widthStyle.getPixels('x');\n\n          if (canvas.style) {\n            canvas.style.width = \"\".concat(canvas.width, \"px\");\n          }\n        }\n\n        if (heightStyle.hasValue()) {\n          canvas.height = heightStyle.getPixels('y');\n\n          if (canvas.style) {\n            canvas.style.height = \"\".concat(canvas.height, \"px\");\n          }\n        }\n      }\n\n      var cWidth = canvas.clientWidth || canvas.width;\n      var cHeight = canvas.clientHeight || canvas.height;\n\n      if (ignoreDimensions && widthStyle.hasValue() && heightStyle.hasValue()) {\n        cWidth = widthStyle.getPixels('x');\n        cHeight = heightStyle.getPixels('y');\n      }\n\n      viewPort.setCurrent(cWidth, cHeight);\n\n      if (typeof offsetX === 'number') {\n        element.getAttribute('x', true).setValue(offsetX);\n      }\n\n      if (typeof offsetY === 'number') {\n        element.getAttribute('y', true).setValue(offsetY);\n      }\n\n      if (typeof scaleWidth === 'number' || typeof scaleHeight === 'number') {\n        var _context3, _context4;\n\n        var viewBox = toNumbers(element.getAttribute('viewBox').getString());\n        var xRatio = 0;\n        var yRatio = 0;\n\n        if (typeof scaleWidth === 'number') {\n          var _widthStyle = element.getStyle('width');\n\n          if (_widthStyle.hasValue()) {\n            xRatio = _widthStyle.getPixels('x') / scaleWidth;\n          } else if (!isNaN(viewBox[2])) {\n            xRatio = viewBox[2] / scaleWidth;\n          }\n        }\n\n        if (typeof scaleHeight === 'number') {\n          var _heightStyle = element.getStyle('height');\n\n          if (_heightStyle.hasValue()) {\n            yRatio = _heightStyle.getPixels('y') / scaleHeight;\n          } else if (!isNaN(viewBox[3])) {\n            yRatio = viewBox[3] / scaleHeight;\n          }\n        }\n\n        if (!xRatio) {\n          xRatio = yRatio;\n        }\n\n        if (!yRatio) {\n          yRatio = xRatio;\n        }\n\n        element.getAttribute('width', true).setValue(scaleWidth);\n        element.getAttribute('height', true).setValue(scaleHeight);\n        var transformStyle = element.getStyle('transform', true, true);\n        transformStyle.setValue(_concatInstanceProperty(_context3 = _concatInstanceProperty(_context4 = \"\".concat(transformStyle.getString(), \" scale(\")).call(_context4, 1.0 / xRatio, \", \")).call(_context3, 1.0 / yRatio, \")\"));\n      } // clear and render\n\n\n      if (!ignoreClear) {\n        ctx.clearRect(0, 0, cWidth, cHeight);\n      }\n\n      element.render(ctx);\n\n      if (isFirstRender) {\n        this.isFirstRender = false;\n      }\n    }\n  }]);\n\n  return Screen;\n}();\n\nScreen.defaultWindow = defaultWindow;\nScreen.defaultFetch = defaultFetch;\nvar defaultFetch$1 = Screen.defaultFetch;\nvar DefaultDOMParser = typeof DOMParser !== 'undefined' ? DOMParser : null;\n\nvar Parser = /*#__PURE__*/function () {\n  function Parser() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$fetch = _ref.fetch,\n        fetch = _ref$fetch === void 0 ? defaultFetch$1 : _ref$fetch,\n        _ref$DOMParser = _ref.DOMParser,\n        DOMParser = _ref$DOMParser === void 0 ? DefaultDOMParser : _ref$DOMParser;\n\n    _classCallCheck(this, Parser);\n\n    this.fetch = fetch;\n    this.DOMParser = DOMParser;\n  }\n\n  _createClass(Parser, [{\n    key: \"parse\",\n    value: function () {\n      var _parse = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(resource) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!/^</.test(resource)) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", this.parseFromString(resource));\n\n              case 2:\n                return _context.abrupt(\"return\", this.load(resource));\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function parse(_x) {\n        return _parse.apply(this, arguments);\n      }\n\n      return parse;\n    }()\n  }, {\n    key: \"parseFromString\",\n    value: function parseFromString(xml) {\n      var parser = new this.DOMParser();\n\n      try {\n        return this.checkDocument(parser.parseFromString(xml, 'image/svg+xml'));\n      } catch (err) {\n        return this.checkDocument(parser.parseFromString(xml, 'text/xml'));\n      }\n    }\n  }, {\n    key: \"checkDocument\",\n    value: function checkDocument(document) {\n      var parserError = document.getElementsByTagName('parsererror')[0];\n\n      if (parserError) {\n        throw new Error(parserError.textContent);\n      }\n\n      return document;\n    }\n  }, {\n    key: \"load\",\n    value: function () {\n      var _load = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(url) {\n        var response, xml;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.fetch(url);\n\n              case 2:\n                response = _context2.sent;\n                _context2.next = 5;\n                return response.text();\n\n              case 5:\n                xml = _context2.sent;\n                return _context2.abrupt(\"return\", this.parseFromString(xml));\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function load(_x2) {\n        return _load.apply(this, arguments);\n      }\n\n      return load;\n    }()\n  }]);\n\n  return Parser;\n}();\n\nvar Translate = /*#__PURE__*/function () {\n  function Translate(_, point) {\n    _classCallCheck(this, Translate);\n\n    this.type = 'translate';\n    this.point = null;\n    this.point = Point.parse(point);\n  }\n\n  _createClass(Translate, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var _this$point = this.point,\n          x = _this$point.x,\n          y = _this$point.y;\n      ctx.translate(x || 0.0, y || 0.0);\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var _this$point2 = this.point,\n          x = _this$point2.x,\n          y = _this$point2.y;\n      ctx.translate(-1.0 * x || 0.0, -1.0 * y || 0.0);\n    }\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      var _this$point3 = this.point,\n          x = _this$point3.x,\n          y = _this$point3.y;\n      point.applyTransform([1, 0, 0, 1, x || 0.0, y || 0.0]);\n    }\n  }]);\n\n  return Translate;\n}();\n\nvar Rotate = /*#__PURE__*/function () {\n  function Rotate(document, rotate, transformOrigin) {\n    _classCallCheck(this, Rotate);\n\n    this.type = 'rotate';\n    this.angle = null;\n    this.originX = null;\n    this.originY = null;\n    this.cx = 0;\n    this.cy = 0;\n    var numbers = toNumbers(rotate);\n    this.angle = new Property(document, 'angle', numbers[0]);\n    this.originX = transformOrigin[0];\n    this.originY = transformOrigin[1];\n    this.cx = numbers[1] || 0;\n    this.cy = numbers[2] || 0;\n  }\n\n  _createClass(Rotate, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var cx = this.cx,\n          cy = this.cy,\n          originX = this.originX,\n          originY = this.originY,\n          angle = this.angle;\n      var x = cx + originX.getPixels('x');\n      var y = cy + originY.getPixels('y');\n      ctx.translate(x, y);\n      ctx.rotate(angle.getRadians());\n      ctx.translate(-x, -y);\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var cx = this.cx,\n          cy = this.cy,\n          angle = this.angle;\n      ctx.translate(cx, cy);\n      ctx.rotate(-1.0 * angle.getRadians());\n      ctx.translate(-cx, -cy);\n    }\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      var cx = this.cx,\n          cy = this.cy,\n          angle = this.angle;\n      var rad = angle.getRadians();\n      point.applyTransform([1, 0, 0, 1, cx || 0.0, cy || 0.0 // this.p.y\n      ]);\n      point.applyTransform([Math.cos(rad), Math.sin(rad), -Math.sin(rad), Math.cos(rad), 0, 0]);\n      point.applyTransform([1, 0, 0, 1, -cx || 0.0, -cy || 0.0 // -this.p.y\n      ]);\n    }\n  }]);\n\n  return Rotate;\n}();\n\nvar Scale = /*#__PURE__*/function () {\n  function Scale(_, scale) {\n    _classCallCheck(this, Scale);\n\n    this.type = 'scale';\n    this.scale = null;\n    var scaleSize = Point.parseScale(scale); // Workaround for node-canvas\n\n    if (scaleSize.x === 0 || scaleSize.y === 0) {\n      scaleSize.x = PSEUDO_ZERO;\n      scaleSize.y = PSEUDO_ZERO;\n    }\n\n    this.scale = scaleSize;\n  }\n\n  _createClass(Scale, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var _this$scale = this.scale,\n          x = _this$scale.x,\n          y = _this$scale.y;\n      ctx.scale(x, y || x);\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var _this$scale2 = this.scale,\n          x = _this$scale2.x,\n          y = _this$scale2.y;\n      ctx.scale(1.0 / x, 1.0 / y || x);\n    }\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      var _this$scale3 = this.scale,\n          x = _this$scale3.x,\n          y = _this$scale3.y;\n      point.applyTransform([x || 0.0, 0, 0, y || 0.0, 0, 0]);\n    }\n  }]);\n\n  return Scale;\n}();\n\nvar Matrix = /*#__PURE__*/function () {\n  function Matrix(_, matrix) {\n    _classCallCheck(this, Matrix);\n\n    this.type = 'matrix';\n    this.matrix = [];\n    this.matrix = toNumbers(matrix);\n  }\n\n  _createClass(Matrix, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var matrix = this.matrix;\n      ctx.transform(matrix[0], matrix[1], matrix[2], matrix[3], matrix[4], matrix[5]);\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var matrix = this.matrix;\n      var a = matrix[0];\n      var b = matrix[2];\n      var c = matrix[4];\n      var d = matrix[1];\n      var e = matrix[3];\n      var f = matrix[5];\n      var g = 0.0;\n      var h = 0.0;\n      var i = 1.0;\n      var det = 1 / (a * (e * i - f * h) - b * (d * i - f * g) + c * (d * h - e * g));\n      ctx.transform(det * (e * i - f * h), det * (f * g - d * i), det * (c * h - b * i), det * (a * i - c * g), det * (b * f - c * e), det * (c * d - a * f));\n    }\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      point.applyTransform(this.matrix);\n    }\n  }]);\n\n  return Matrix;\n}();\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar Skew = /*#__PURE__*/function (_Matrix) {\n  _inherits(Skew, _Matrix);\n\n  var _super = _createSuper(Skew);\n\n  function Skew(document, skew) {\n    var _this;\n\n    _classCallCheck(this, Skew);\n\n    _this = _super.call(this, document, skew);\n    _this.type = 'skew';\n    _this.angle = null;\n    _this.angle = new Property(document, 'angle', skew);\n    return _this;\n  }\n\n  return Skew;\n}(Matrix);\n\nfunction _createSuper$1(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$1();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$1() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar SkewX = /*#__PURE__*/function (_Skew) {\n  _inherits(SkewX, _Skew);\n\n  var _super = _createSuper$1(SkewX);\n\n  function SkewX(document, skew) {\n    var _this;\n\n    _classCallCheck(this, SkewX);\n\n    _this = _super.call(this, document, skew);\n    _this.type = 'skewX';\n    _this.matrix = [1, 0, Math.tan(_this.angle.getRadians()), 1, 0, 0];\n    return _this;\n  }\n\n  return SkewX;\n}(Skew);\n\nfunction _createSuper$2(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$2();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$2() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar SkewY = /*#__PURE__*/function (_Skew) {\n  _inherits(SkewY, _Skew);\n\n  var _super = _createSuper$2(SkewY);\n\n  function SkewY(document, skew) {\n    var _this;\n\n    _classCallCheck(this, SkewY);\n\n    _this = _super.call(this, document, skew);\n    _this.type = 'skewY';\n    _this.matrix = [1, Math.tan(_this.angle.getRadians()), 0, 1, 0, 0];\n    return _this;\n  }\n\n  return SkewY;\n}(Skew);\n\nfunction parseTransforms(transform) {\n  var _context;\n\n  return _trimInstanceProperty(_context = compressSpaces(transform)).call(_context).replace(/\\)([a-zA-Z])/g, ') $1').replace(/\\)(\\s?,\\s?)/g, ') ').split(/\\s(?=[a-z])/);\n}\n\nfunction parseTransform(transform) {\n  var _transform$split = transform.split('('),\n      _transform$split2 = _slicedToArray(_transform$split, 2),\n      type = _transform$split2[0],\n      value = _transform$split2[1];\n\n  return [_trimInstanceProperty(type).call(type), _trimInstanceProperty(value).call(value).replace(')', '')];\n}\n\nvar Transform = /*#__PURE__*/function () {\n  function Transform(document, transform, transformOrigin) {\n    var _this = this;\n\n    _classCallCheck(this, Transform);\n\n    this.document = document;\n    this.transforms = [];\n    var data = parseTransforms(transform);\n\n    _forEachInstanceProperty(data).call(data, function (transform) {\n      if (transform === 'none') {\n        return;\n      }\n\n      var _parseTransform = parseTransform(transform),\n          _parseTransform2 = _slicedToArray(_parseTransform, 2),\n          type = _parseTransform2[0],\n          value = _parseTransform2[1];\n\n      var TransformType = Transform.transformTypes[type];\n\n      if (typeof TransformType !== 'undefined') {\n        _this.transforms.push(new TransformType(_this.document, value, transformOrigin));\n      }\n    });\n  }\n\n  _createClass(Transform, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var transforms = this.transforms;\n      var len = transforms.length;\n\n      for (var i = 0; i < len; i++) {\n        transforms[i].apply(ctx);\n      }\n    }\n  }, {\n    key: \"unapply\",\n    value: function unapply(ctx) {\n      var transforms = this.transforms;\n      var len = transforms.length;\n\n      for (var i = len - 1; i >= 0; i--) {\n        transforms[i].unapply(ctx);\n      }\n    } // TODO: applyToPoint unused ... remove?\n\n  }, {\n    key: \"applyToPoint\",\n    value: function applyToPoint(point) {\n      var transforms = this.transforms;\n      var len = transforms.length;\n\n      for (var i = 0; i < len; i++) {\n        transforms[i].applyToPoint(point);\n      }\n    }\n  }], [{\n    key: \"fromElement\",\n    value: function fromElement(document, element) {\n      var transformStyle = element.getStyle('transform', false, true);\n\n      var _element$getStyle$spl = element.getStyle('transform-origin', false, true).split(),\n          _element$getStyle$spl2 = _slicedToArray(_element$getStyle$spl, 2),\n          transformOriginXProperty = _element$getStyle$spl2[0],\n          _element$getStyle$spl3 = _element$getStyle$spl2[1],\n          transformOriginYProperty = _element$getStyle$spl3 === void 0 ? transformOriginXProperty : _element$getStyle$spl3;\n\n      var transformOrigin = [transformOriginXProperty, transformOriginYProperty];\n\n      if (transformStyle.hasValue()) {\n        return new Transform(document, transformStyle.getString(), transformOrigin);\n      }\n\n      return null;\n    }\n  }]);\n\n  return Transform;\n}();\n\nTransform.transformTypes = {\n  translate: Translate,\n  rotate: Rotate,\n  scale: Scale,\n  matrix: Matrix,\n  skewX: SkewX,\n  skewY: SkewY\n};\n\nvar Element = /*#__PURE__*/function () {\n  function Element(document, node) {\n    var _context,\n        _this = this,\n        _context4;\n\n    var captureTextNodes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n    _classCallCheck(this, Element);\n\n    this.document = document;\n    this.node = node;\n    this.captureTextNodes = captureTextNodes;\n    this.attributes = {};\n    this.styles = {};\n    this.stylesSpecificity = {};\n    this.animationFrozen = false;\n    this.animationFrozenValue = '';\n    this.parent = null;\n    this.children = [];\n\n    if (!node || node.nodeType !== 1) {\n      // ELEMENT_NODE\n      return;\n    } // add attributes\n\n\n    _forEachInstanceProperty(_context = _Array$from(node.attributes)).call(_context, function (attribute) {\n      var nodeName = normalizeAttributeName(attribute.nodeName);\n      _this.attributes[nodeName] = new Property(document, nodeName, attribute.value);\n    });\n\n    this.addStylesFromStyleDefinition(); // add inline styles\n\n    if (this.getAttribute('style').hasValue()) {\n      var _context2;\n\n      var styles = _mapInstanceProperty(_context2 = this.getAttribute('style').getString().split(';')).call(_context2, function (_) {\n        return _trimInstanceProperty(_).call(_);\n      });\n\n      _forEachInstanceProperty(styles).call(styles, function (style) {\n        var _context3;\n\n        if (!style) {\n          return;\n        }\n\n        var _style$split$map = _mapInstanceProperty(_context3 = style.split(':')).call(_context3, function (_) {\n          return _trimInstanceProperty(_).call(_);\n        }),\n            _style$split$map2 = _slicedToArray(_style$split$map, 2),\n            name = _style$split$map2[0],\n            value = _style$split$map2[1];\n\n        _this.styles[name] = new Property(document, name, value);\n      });\n    }\n\n    var definitions = document.definitions;\n    var id = this.getAttribute('id'); // add id\n\n    if (id.hasValue()) {\n      if (!definitions[id.getValue()]) {\n        definitions[id.getValue()] = this;\n      }\n    }\n\n    _forEachInstanceProperty(_context4 = _Array$from(node.childNodes)).call(_context4, function (childNode) {\n      if (childNode.nodeType === 1) {\n        _this.addChild(childNode); // ELEMENT_NODE\n\n      } else if (captureTextNodes && (childNode.nodeType === 3 || childNode.nodeType === 4)) {\n        var textNode = document.createTextNode(childNode);\n\n        if (textNode.getText().length > 0) {\n          _this.addChild(textNode); // TEXT_NODE\n\n        }\n      }\n    });\n  }\n\n  _createClass(Element, [{\n    key: \"getAttribute\",\n    value: function getAttribute(name) {\n      var createIfNotExists = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var attr = this.attributes[name];\n\n      if (!attr && createIfNotExists) {\n        var _attr = new Property(this.document, name, '');\n\n        this.attributes[name] = _attr;\n        return _attr;\n      }\n\n      return attr || Property.empty(this.document);\n    }\n  }, {\n    key: \"getHrefAttribute\",\n    value: function getHrefAttribute() {\n      for (var key in this.attributes) {\n        if (key === 'href' || /:href$/.test(key)) {\n          return this.attributes[key];\n        }\n      }\n\n      return Property.empty(this.document);\n    }\n  }, {\n    key: \"getStyle\",\n    value: function getStyle(name) {\n      var createIfNotExists = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var skipAncestors = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var style = this.styles[name];\n\n      if (style) {\n        return style;\n      }\n\n      var attr = this.getAttribute(name);\n\n      if (attr && attr.hasValue()) {\n        this.styles[name] = attr; // move up to me to cache\n\n        return attr;\n      }\n\n      if (!skipAncestors) {\n        var parent = this.parent;\n\n        if (parent) {\n          var parentStyle = parent.getStyle(name);\n\n          if (parentStyle && parentStyle.hasValue()) {\n            return parentStyle;\n          }\n        }\n      }\n\n      if (createIfNotExists) {\n        var _style = new Property(this.document, name, '');\n\n        this.styles[name] = _style;\n        return _style;\n      }\n\n      return style || Property.empty(this.document);\n    }\n  }, {\n    key: \"render\",\n    value: function render(ctx) {\n      // don't render display=none\n      // don't render visibility=hidden\n      if (this.getStyle('display').getString() === 'none' || this.getStyle('visibility').getString() === 'hidden') {\n        return;\n      }\n\n      ctx.save();\n\n      if (this.getStyle('mask').hasValue()) {\n        // mask\n        var mask = this.getStyle('mask').getDefinition();\n\n        if (mask) {\n          this.applyEffects(ctx);\n          mask.apply(ctx, this);\n        }\n      } else if (this.getStyle('filter').getValue('none') !== 'none') {\n        // filter\n        var filter = this.getStyle('filter').getDefinition();\n\n        if (filter) {\n          this.applyEffects(ctx);\n          filter.apply(ctx, this);\n        }\n      } else {\n        this.setContext(ctx);\n        this.renderChildren(ctx);\n        this.clearContext(ctx);\n      }\n\n      ctx.restore();\n    }\n  }, {\n    key: \"setContext\",\n    value: function setContext(_) {}\n  }, {\n    key: \"applyEffects\",\n    value: function applyEffects(ctx) {\n      // transform\n      var transform = Transform.fromElement(this.document, this);\n\n      if (transform) {\n        transform.apply(ctx);\n      } // clip\n\n\n      var clipPathStyleProp = this.getStyle('clip-path', false, true);\n\n      if (clipPathStyleProp.hasValue()) {\n        var clip = clipPathStyleProp.getDefinition();\n\n        if (clip) {\n          clip.apply(ctx);\n        }\n      }\n    }\n  }, {\n    key: \"clearContext\",\n    value: function clearContext(_) {}\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      var _context5;\n\n      _forEachInstanceProperty(_context5 = this.children).call(_context5, function (child) {\n        child.render(ctx);\n      });\n    }\n  }, {\n    key: \"addChild\",\n    value: function addChild(childNode) {\n      var _context6;\n\n      var child = childNode instanceof Element ? childNode : this.document.createElement(childNode);\n      child.parent = this;\n\n      if (!_includesInstanceProperty(_context6 = Element.ignoreChildTypes).call(_context6, child.type)) {\n        this.children.push(child);\n      }\n    }\n  }, {\n    key: \"matchesSelector\",\n    value: function matchesSelector(selector) {\n      var _context7;\n\n      var node = this.node;\n\n      if (typeof node.matches === 'function') {\n        return node.matches(selector);\n      }\n\n      var styleClasses = node.getAttribute('class');\n\n      if (!styleClasses || styleClasses === '') {\n        return false;\n      }\n\n      return _someInstanceProperty(_context7 = styleClasses.split(' ')).call(_context7, function (styleClass) {\n        if (\".\".concat(styleClass) === selector) {\n          return true;\n        }\n      });\n    }\n  }, {\n    key: \"addStylesFromStyleDefinition\",\n    value: function addStylesFromStyleDefinition() {\n      var _this$document = this.document,\n          styles = _this$document.styles,\n          stylesSpecificity = _this$document.stylesSpecificity;\n\n      for (var selector in styles) {\n        if (selector[0] !== '@' && this.matchesSelector(selector)) {\n          var style = styles[selector];\n          var specificity = stylesSpecificity[selector];\n\n          if (style) {\n            for (var name in style) {\n              var existingSpecificity = this.stylesSpecificity[name];\n\n              if (typeof existingSpecificity === 'undefined') {\n                existingSpecificity = '000';\n              }\n\n              if (specificity >= existingSpecificity) {\n                this.styles[name] = style[name];\n                this.stylesSpecificity[name] = specificity;\n              }\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"removeStyles\",\n    value: function removeStyles(element, ignoreStyles) {\n      var toRestore = _reduceInstanceProperty(ignoreStyles).call(ignoreStyles, function (toRestore, name) {\n        var _context8;\n\n        var styleProp = element.getStyle(name);\n\n        if (!styleProp.hasValue()) {\n          return toRestore;\n        }\n\n        var value = styleProp.getString();\n        styleProp.setValue('');\n        return _concatInstanceProperty(_context8 = []).call(_context8, _toConsumableArray(toRestore), [[name, value]]);\n      }, []);\n\n      return toRestore;\n    }\n  }, {\n    key: \"restoreStyles\",\n    value: function restoreStyles(element, styles) {\n      _forEachInstanceProperty(styles).call(styles, function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 2),\n            name = _ref2[0],\n            value = _ref2[1];\n\n        element.getStyle(name, true).setValue(value);\n      });\n    }\n  }]);\n\n  return Element;\n}();\n\nElement.ignoreChildTypes = ['title'];\n\nfunction _createSuper$3(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$3();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$3() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar UnknownElement = /*#__PURE__*/function (_Element) {\n  _inherits(UnknownElement, _Element);\n\n  var _super = _createSuper$3(UnknownElement);\n\n  function UnknownElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, UnknownElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    return _this;\n  }\n\n  return UnknownElement;\n}(Element);\n\nfunction wrapFontFamily(fontFamily) {\n  var trimmed = _trimInstanceProperty(fontFamily).call(fontFamily);\n\n  return /^('|\")/.test(trimmed) ? trimmed : \"\\\"\".concat(trimmed, \"\\\"\");\n}\n\nfunction prepareFontFamily(fontFamily) {\n  var _context;\n\n  return typeof process === 'undefined' ? fontFamily : _mapInstanceProperty(_context = _trimInstanceProperty(fontFamily).call(fontFamily).split(',')).call(_context, wrapFontFamily).join(',');\n}\n/**\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-style\r\n */\n\n\nfunction prepareFontStyle(fontStyle) {\n  if (!fontStyle) {\n    return '';\n  }\n\n  var targetFontStyle = _trimInstanceProperty(fontStyle).call(fontStyle).toLowerCase();\n\n  switch (targetFontStyle) {\n    case 'normal':\n    case 'italic':\n    case 'oblique':\n    case 'inherit':\n    case 'initial':\n    case 'unset':\n      return targetFontStyle;\n\n    default:\n      if (/^oblique\\s+(-|)\\d+deg$/.test(targetFontStyle)) {\n        return targetFontStyle;\n      }\n\n      return '';\n  }\n}\n/**\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight\r\n */\n\n\nfunction prepareFontWeight(fontWeight) {\n  if (!fontWeight) {\n    return '';\n  }\n\n  var targetFontWeight = _trimInstanceProperty(fontWeight).call(fontWeight).toLowerCase();\n\n  switch (targetFontWeight) {\n    case 'normal':\n    case 'bold':\n    case 'lighter':\n    case 'bolder':\n    case 'inherit':\n    case 'initial':\n    case 'unset':\n      return targetFontWeight;\n\n    default:\n      if (/^[\\d.]+$/.test(targetFontWeight)) {\n        return targetFontWeight;\n      }\n\n      return '';\n  }\n}\n\nvar Font = /*#__PURE__*/function () {\n  function Font(fontStyle, fontVariant, fontWeight, fontSize, fontFamily, inherit) {\n    _classCallCheck(this, Font);\n\n    var inheritFont = inherit ? typeof inherit === 'string' ? Font.parse(inherit) : inherit : {};\n    this.fontFamily = fontFamily || inheritFont.fontFamily;\n    this.fontSize = fontSize || inheritFont.fontSize;\n    this.fontStyle = fontStyle || inheritFont.fontStyle;\n    this.fontWeight = fontWeight || inheritFont.fontWeight;\n    this.fontVariant = fontVariant || inheritFont.fontVariant;\n  }\n\n  _createClass(Font, [{\n    key: \"toString\",\n    value: function toString() {\n      var _context2;\n\n      return _trimInstanceProperty(_context2 = [prepareFontStyle(this.fontStyle), this.fontVariant, prepareFontWeight(this.fontWeight), this.fontSize, // Wrap fontFamily only on nodejs and only for canvas.ctx\n      prepareFontFamily(this.fontFamily)].join(' ')).call(_context2);\n    }\n  }], [{\n    key: \"parse\",\n    value: function parse() {\n      var _context3;\n\n      var font = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      var inherit = arguments.length > 1 ? arguments[1] : undefined;\n      var fontStyle = '';\n      var fontVariant = '';\n      var fontWeight = '';\n      var fontSize = '';\n      var fontFamily = '';\n\n      var parts = _trimInstanceProperty(_context3 = compressSpaces(font)).call(_context3).split(' ');\n\n      var set = {\n        fontSize: false,\n        fontStyle: false,\n        fontWeight: false,\n        fontVariant: false\n      };\n\n      _forEachInstanceProperty(parts).call(parts, function (part) {\n        var _context4, _context5, _context6;\n\n        switch (true) {\n          case !set.fontStyle && _includesInstanceProperty(_context4 = Font.styles).call(_context4, part):\n            if (part !== 'inherit') {\n              fontStyle = part;\n            }\n\n            set.fontStyle = true;\n            break;\n\n          case !set.fontVariant && _includesInstanceProperty(_context5 = Font.variants).call(_context5, part):\n            if (part !== 'inherit') {\n              fontVariant = part;\n            }\n\n            set.fontStyle = true;\n            set.fontVariant = true;\n            break;\n\n          case !set.fontWeight && _includesInstanceProperty(_context6 = Font.weights).call(_context6, part):\n            if (part !== 'inherit') {\n              fontWeight = part;\n            }\n\n            set.fontStyle = true;\n            set.fontVariant = true;\n            set.fontWeight = true;\n            break;\n\n          case !set.fontSize:\n            if (part !== 'inherit') {\n              var _part$split = part.split('/');\n\n              var _part$split2 = _slicedToArray(_part$split, 1);\n\n              fontSize = _part$split2[0];\n            }\n\n            set.fontStyle = true;\n            set.fontVariant = true;\n            set.fontWeight = true;\n            set.fontSize = true;\n            break;\n\n          default:\n            if (part !== 'inherit') {\n              fontFamily += part;\n            }\n\n        }\n      });\n\n      return new Font(fontStyle, fontVariant, fontWeight, fontSize, fontFamily, inherit);\n    }\n  }]);\n\n  return Font;\n}();\n\nFont.styles = 'normal|italic|oblique|inherit';\nFont.variants = 'normal|small-caps|inherit';\nFont.weights = 'normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit';\n\nvar BoundingBox = /*#__PURE__*/function () {\n  function BoundingBox() {\n    var x1 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : Number.NaN;\n    var y1 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : Number.NaN;\n    var x2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : Number.NaN;\n    var y2 = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : Number.NaN;\n\n    _classCallCheck(this, BoundingBox);\n\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n    this.addPoint(x1, y1);\n    this.addPoint(x2, y2);\n  }\n\n  _createClass(BoundingBox, [{\n    key: \"addPoint\",\n    value: function addPoint(x, y) {\n      if (typeof x !== 'undefined') {\n        if (isNaN(this.x1) || isNaN(this.x2)) {\n          this.x1 = x;\n          this.x2 = x;\n        }\n\n        if (x < this.x1) {\n          this.x1 = x;\n        }\n\n        if (x > this.x2) {\n          this.x2 = x;\n        }\n      }\n\n      if (typeof y !== 'undefined') {\n        if (isNaN(this.y1) || isNaN(this.y2)) {\n          this.y1 = y;\n          this.y2 = y;\n        }\n\n        if (y < this.y1) {\n          this.y1 = y;\n        }\n\n        if (y > this.y2) {\n          this.y2 = y;\n        }\n      }\n    }\n  }, {\n    key: \"addX\",\n    value: function addX(x) {\n      this.addPoint(x, null);\n    }\n  }, {\n    key: \"addY\",\n    value: function addY(y) {\n      this.addPoint(null, y);\n    }\n  }, {\n    key: \"addBoundingBox\",\n    value: function addBoundingBox(boundingBox) {\n      if (!boundingBox) {\n        return;\n      }\n\n      var x1 = boundingBox.x1,\n          y1 = boundingBox.y1,\n          x2 = boundingBox.x2,\n          y2 = boundingBox.y2;\n      this.addPoint(x1, y1);\n      this.addPoint(x2, y2);\n    }\n  }, {\n    key: \"sumCubic\",\n    value: function sumCubic(t, p0, p1, p2, p3) {\n      return Math.pow(1 - t, 3) * p0 + 3 * Math.pow(1 - t, 2) * t * p1 + 3 * (1 - t) * Math.pow(t, 2) * p2 + Math.pow(t, 3) * p3;\n    }\n  }, {\n    key: \"bezierCurveAdd\",\n    value: function bezierCurveAdd(forX, p0, p1, p2, p3) {\n      var b = 6 * p0 - 12 * p1 + 6 * p2;\n      var a = -3 * p0 + 9 * p1 - 9 * p2 + 3 * p3;\n      var c = 3 * p1 - 3 * p0;\n\n      if (a === 0) {\n        if (b === 0) {\n          return;\n        }\n\n        var t = -c / b;\n\n        if (0 < t && t < 1) {\n          if (forX) {\n            this.addX(this.sumCubic(t, p0, p1, p2, p3));\n          } else {\n            this.addY(this.sumCubic(t, p0, p1, p2, p3));\n          }\n        }\n\n        return;\n      }\n\n      var b2ac = Math.pow(b, 2) - 4 * c * a;\n\n      if (b2ac < 0) {\n        return;\n      }\n\n      var t1 = (-b + Math.sqrt(b2ac)) / (2 * a);\n\n      if (0 < t1 && t1 < 1) {\n        if (forX) {\n          this.addX(this.sumCubic(t1, p0, p1, p2, p3));\n        } else {\n          this.addY(this.sumCubic(t1, p0, p1, p2, p3));\n        }\n      }\n\n      var t2 = (-b - Math.sqrt(b2ac)) / (2 * a);\n\n      if (0 < t2 && t2 < 1) {\n        if (forX) {\n          this.addX(this.sumCubic(t2, p0, p1, p2, p3));\n        } else {\n          this.addY(this.sumCubic(t2, p0, p1, p2, p3));\n        }\n      }\n    } // from http://blog.hackers-cafe.net/2009/06/how-to-calculate-bezier-curves-bounding.html\n\n  }, {\n    key: \"addBezierCurve\",\n    value: function addBezierCurve(p0x, p0y, p1x, p1y, p2x, p2y, p3x, p3y) {\n      this.addPoint(p0x, p0y);\n      this.addPoint(p3x, p3y);\n      this.bezierCurveAdd(true, p0x, p1x, p2x, p3x);\n      this.bezierCurveAdd(false, p0y, p1y, p2y, p3y);\n    }\n  }, {\n    key: \"addQuadraticCurve\",\n    value: function addQuadraticCurve(p0x, p0y, p1x, p1y, p2x, p2y) {\n      var cp1x = p0x + 2 / 3 * (p1x - p0x); // CP1 = QP0 + 2/3 *(QP1-QP0)\n\n      var cp1y = p0y + 2 / 3 * (p1y - p0y); // CP1 = QP0 + 2/3 *(QP1-QP0)\n\n      var cp2x = cp1x + 1 / 3 * (p2x - p0x); // CP2 = CP1 + 1/3 *(QP2-QP0)\n\n      var cp2y = cp1y + 1 / 3 * (p2y - p0y); // CP2 = CP1 + 1/3 *(QP2-QP0)\n\n      this.addBezierCurve(p0x, p0y, cp1x, cp2x, cp1y, cp2y, p2x, p2y);\n    }\n  }, {\n    key: \"isPointInBox\",\n    value: function isPointInBox(x, y) {\n      var x1 = this.x1,\n          y1 = this.y1,\n          x2 = this.x2,\n          y2 = this.y2;\n      return x1 <= x && x <= x2 && y1 <= y && y <= y2;\n    }\n  }, {\n    key: \"x\",\n    get: function get() {\n      return this.x1;\n    }\n  }, {\n    key: \"y\",\n    get: function get() {\n      return this.y1;\n    }\n  }, {\n    key: \"width\",\n    get: function get() {\n      return this.x2 - this.x1;\n    }\n  }, {\n    key: \"height\",\n    get: function get() {\n      return this.y2 - this.y1;\n    }\n  }]);\n\n  return BoundingBox;\n}();\n\nfunction _createSuper$4(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$4();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$4() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar RenderedElement = /*#__PURE__*/function (_Element) {\n  _inherits(RenderedElement, _Element);\n\n  var _super = _createSuper$4(RenderedElement);\n\n  function RenderedElement() {\n    var _this;\n\n    _classCallCheck(this, RenderedElement);\n\n    _this = _super.apply(this, arguments);\n    _this.modifiedEmSizeStack = false;\n    return _this;\n  }\n\n  _createClass(RenderedElement, [{\n    key: \"calculateOpacity\",\n    value: function calculateOpacity() {\n      var opacity = 1.0; // tslint:disable-next-line: no-this-assignment\n\n      var element = this;\n\n      while (element) {\n        var opacityStyle = element.getStyle('opacity', false, true); // no ancestors on style call\n\n        if (opacityStyle.hasValue(true)) {\n          opacity *= opacityStyle.getNumber();\n        }\n\n        element = element.parent;\n      }\n\n      return opacity;\n    }\n  }, {\n    key: \"setContext\",\n    value: function setContext(ctx) {\n      var fromMeasure = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (!fromMeasure) {\n        // causes stack overflow when measuring text with gradients\n        // fill\n        var fillStyleProp = this.getStyle('fill');\n        var fillOpacityStyleProp = this.getStyle('fill-opacity');\n        var strokeStyleProp = this.getStyle('stroke');\n        var strokeOpacityProp = this.getStyle('stroke-opacity');\n\n        if (fillStyleProp.isUrlDefinition()) {\n          var fillStyle = fillStyleProp.getFillStyleDefinition(this, fillOpacityStyleProp);\n\n          if (fillStyle) {\n            ctx.fillStyle = fillStyle;\n          }\n        } else if (fillStyleProp.hasValue()) {\n          if (fillStyleProp.getString() === 'currentColor') {\n            fillStyleProp.setValue(this.getStyle('color').getColor());\n          }\n\n          var _fillStyle = fillStyleProp.getColor();\n\n          if (_fillStyle !== 'inherit') {\n            ctx.fillStyle = _fillStyle === 'none' ? 'rgba(0,0,0,0)' : _fillStyle;\n          }\n        }\n\n        if (fillOpacityStyleProp.hasValue()) {\n          var _fillStyle2 = new Property(this.document, 'fill', ctx.fillStyle).addOpacity(fillOpacityStyleProp).getColor();\n\n          ctx.fillStyle = _fillStyle2;\n        } // stroke\n\n\n        if (strokeStyleProp.isUrlDefinition()) {\n          var strokeStyle = strokeStyleProp.getFillStyleDefinition(this, strokeOpacityProp);\n\n          if (strokeStyle) {\n            ctx.strokeStyle = strokeStyle;\n          }\n        } else if (strokeStyleProp.hasValue()) {\n          if (strokeStyleProp.getString() === 'currentColor') {\n            strokeStyleProp.setValue(this.getStyle('color').getColor());\n          }\n\n          var _strokeStyle = strokeStyleProp.getString();\n\n          if (_strokeStyle !== 'inherit') {\n            ctx.strokeStyle = _strokeStyle === 'none' ? 'rgba(0,0,0,0)' : _strokeStyle;\n          }\n        }\n\n        if (strokeOpacityProp.hasValue()) {\n          var _strokeStyle2 = new Property(this.document, 'stroke', ctx.strokeStyle).addOpacity(strokeOpacityProp).getString();\n\n          ctx.strokeStyle = _strokeStyle2;\n        }\n\n        var strokeWidthStyleProp = this.getStyle('stroke-width');\n\n        if (strokeWidthStyleProp.hasValue()) {\n          var newLineWidth = strokeWidthStyleProp.getPixels();\n          ctx.lineWidth = !newLineWidth ? PSEUDO_ZERO // browsers don't respect 0 (or node-canvas? :-)\n          : newLineWidth;\n        }\n\n        var strokeLinecapStyleProp = this.getStyle('stroke-linecap');\n        var strokeLinejoinStyleProp = this.getStyle('stroke-linejoin');\n        var strokeMiterlimitProp = this.getStyle('stroke-miterlimit');\n        var pointOrderStyleProp = this.getStyle('paint-order');\n        var strokeDasharrayStyleProp = this.getStyle('stroke-dasharray');\n        var strokeDashoffsetProp = this.getStyle('stroke-dashoffset');\n\n        if (strokeLinecapStyleProp.hasValue()) {\n          ctx.lineCap = strokeLinecapStyleProp.getString();\n        }\n\n        if (strokeLinejoinStyleProp.hasValue()) {\n          ctx.lineJoin = strokeLinejoinStyleProp.getString();\n        }\n\n        if (strokeMiterlimitProp.hasValue()) {\n          ctx.miterLimit = strokeMiterlimitProp.getNumber();\n        }\n\n        if (pointOrderStyleProp.hasValue()) {\n          // ?\n          ctx.paintOrder = pointOrderStyleProp.getValue();\n        }\n\n        if (strokeDasharrayStyleProp.hasValue() && strokeDasharrayStyleProp.getString() !== 'none') {\n          var gaps = toNumbers(strokeDasharrayStyleProp.getString());\n\n          if (typeof ctx.setLineDash !== 'undefined') {\n            ctx.setLineDash(gaps);\n          } else if (typeof ctx.webkitLineDash !== 'undefined') {\n            ctx.webkitLineDash = gaps;\n          } else if (typeof ctx.mozDash !== 'undefined' && !(gaps.length === 1 && gaps[0] === 0)) {\n            ctx.mozDash = gaps;\n          }\n\n          var offset = strokeDashoffsetProp.getPixels();\n\n          if (typeof ctx.lineDashOffset !== 'undefined') {\n            ctx.lineDashOffset = offset;\n          } else if (typeof ctx.webkitLineDashOffset !== 'undefined') {\n            ctx.webkitLineDashOffset = offset;\n          } else if (typeof ctx.mozDashOffset !== 'undefined') {\n            ctx.mozDashOffset = offset;\n          }\n        }\n      } // font\n\n\n      this.modifiedEmSizeStack = false;\n\n      if (typeof ctx.font !== 'undefined') {\n        var fontStyleProp = this.getStyle('font');\n        var fontStyleStyleProp = this.getStyle('font-style');\n        var fontVariantStyleProp = this.getStyle('font-variant');\n        var fontWeightStyleProp = this.getStyle('font-weight');\n        var fontSizeStyleProp = this.getStyle('font-size');\n        var fontFamilyStyleProp = this.getStyle('font-family');\n        var font = new Font(fontStyleStyleProp.getString(), fontVariantStyleProp.getString(), fontWeightStyleProp.getString(), fontSizeStyleProp.hasValue() ? \"\".concat(fontSizeStyleProp.getPixels(true), \"px\") : '', fontFamilyStyleProp.getString(), Font.parse(fontStyleProp.getString(), ctx.font));\n        fontStyleStyleProp.setValue(font.fontStyle);\n        fontVariantStyleProp.setValue(font.fontVariant);\n        fontWeightStyleProp.setValue(font.fontWeight);\n        fontSizeStyleProp.setValue(font.fontSize);\n        fontFamilyStyleProp.setValue(font.fontFamily);\n        ctx.font = font.toString();\n\n        if (fontSizeStyleProp.isPixels()) {\n          this.document.emSize = fontSizeStyleProp.getPixels();\n          this.modifiedEmSizeStack = true;\n        }\n      }\n\n      if (!fromMeasure) {\n        // effects\n        this.applyEffects(ctx); // opacity\n\n        ctx.globalAlpha = this.calculateOpacity();\n      }\n    }\n  }, {\n    key: \"clearContext\",\n    value: function clearContext(ctx) {\n      _get(_getPrototypeOf(RenderedElement.prototype), \"clearContext\", this).call(this, ctx);\n\n      if (this.modifiedEmSizeStack) {\n        this.document.popEmSize();\n      }\n    }\n  }]);\n\n  return RenderedElement;\n}(Element);\n\nfunction _createSuper$5(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$5();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$5() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar TextElement = /*#__PURE__*/function (_RenderedElement) {\n  _inherits(TextElement, _RenderedElement);\n\n  var _super = _createSuper$5(TextElement);\n\n  function TextElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, TextElement);\n\n    _this = _super.call(this, document, node, (this instanceof TextElement ? this.constructor : void 0) === TextElement ? true : captureTextNodes);\n    _this.type = 'text';\n    _this.x = 0;\n    _this.y = 0;\n    _this.measureCache = -1;\n    return _this;\n  }\n\n  _createClass(TextElement, [{\n    key: \"setContext\",\n    value: function setContext(ctx) {\n      var fromMeasure = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      _get(_getPrototypeOf(TextElement.prototype), \"setContext\", this).call(this, ctx, fromMeasure);\n\n      var textBaseline = this.getStyle('dominant-baseline').getTextBaseline() || this.getStyle('alignment-baseline').getTextBaseline();\n\n      if (textBaseline) {\n        ctx.textBaseline = textBaseline;\n      }\n    }\n  }, {\n    key: \"initializeCoordinates\",\n    value: function initializeCoordinates(ctx) {\n      this.x = this.getAttribute('x').getPixels('x');\n      this.y = this.getAttribute('y').getPixels('y');\n      var dxAttr = this.getAttribute('dx');\n      var dyAttr = this.getAttribute('dy');\n\n      if (dxAttr.hasValue()) {\n        this.x += dxAttr.getPixels('x');\n      }\n\n      if (dyAttr.hasValue()) {\n        this.y += dyAttr.getPixels('y');\n      }\n\n      this.x += this.getAnchorDelta(ctx, this, 0);\n    }\n  }, {\n    key: \"getBoundingBox\",\n    value: function getBoundingBox(ctx) {\n      var _context,\n          _this2 = this;\n\n      if (this.type !== 'text') {\n        return this.getTElementBoundingBox(ctx);\n      }\n\n      this.initializeCoordinates(ctx);\n      var boundingBox = null;\n\n      _forEachInstanceProperty(_context = this.children).call(_context, function (_, i) {\n        var childBoundingBox = _this2.getChildBoundingBox(ctx, _this2, _this2, i);\n\n        if (!boundingBox) {\n          boundingBox = childBoundingBox;\n        } else {\n          boundingBox.addBoundingBox(childBoundingBox);\n        }\n      });\n\n      return boundingBox;\n    }\n  }, {\n    key: \"getFontSize\",\n    value: function getFontSize() {\n      var document = this.document,\n          parent = this.parent;\n      var inheritFontSize = Font.parse(document.ctx.font).fontSize;\n      var fontSize = parent.getStyle('font-size').getNumber(inheritFontSize);\n      return fontSize;\n    }\n  }, {\n    key: \"getTElementBoundingBox\",\n    value: function getTElementBoundingBox(ctx) {\n      var fontSize = this.getFontSize();\n      return new BoundingBox(this.x, this.y - fontSize, this.x + this.measureText(ctx), this.y);\n    }\n  }, {\n    key: \"getGlyph\",\n    value: function getGlyph(font, text, i) {\n      var char = text[i];\n      var glyph = null;\n\n      if (font.isArabic) {\n        var len = text.length;\n        var prevChar = text[i - 1];\n        var nextChar = text[i + 1];\n        var arabicForm = 'isolated';\n\n        if ((i === 0 || prevChar === ' ') && i < len - 2 && nextChar !== ' ') {\n          arabicForm = 'terminal';\n        }\n\n        if (i > 0 && prevChar !== ' ' && i < len - 2 && nextChar !== ' ') {\n          arabicForm = 'medial';\n        }\n\n        if (i > 0 && prevChar !== ' ' && (i === len - 1 || nextChar === ' ')) {\n          arabicForm = 'initial';\n        }\n\n        if (typeof font.glyphs[char] !== 'undefined') {\n          glyph = font.glyphs[char][arabicForm];\n\n          if (!glyph && font.glyphs[char].type === 'glyph') {\n            glyph = font.glyphs[char];\n          }\n        }\n      } else {\n        glyph = font.glyphs[char];\n      }\n\n      if (!glyph) {\n        glyph = font.missingGlyph;\n      }\n\n      return glyph;\n    }\n  }, {\n    key: \"getText\",\n    value: function getText() {\n      return '';\n    }\n  }, {\n    key: \"getTextFromNode\",\n    value: function getTextFromNode(node) {\n      var textNode = node || this.node;\n\n      var childNodes = _Array$from(textNode.parentNode.childNodes);\n\n      var index = _indexOfInstanceProperty(childNodes).call(childNodes, textNode);\n\n      var lastIndex = childNodes.length - 1;\n      var text = compressSpaces(textNode.value || textNode.text || textNode.textContent || '');\n\n      if (index === 0) {\n        text = trimLeft(text);\n      }\n\n      if (index === lastIndex) {\n        text = trimRight(text);\n      }\n\n      return text;\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      var _context2,\n          _this3 = this;\n\n      if (this.type !== 'text') {\n        this.renderTElementChildren(ctx);\n        return;\n      }\n\n      this.initializeCoordinates(ctx);\n\n      _forEachInstanceProperty(_context2 = this.children).call(_context2, function (_, i) {\n        _this3.renderChild(ctx, _this3, _this3, i);\n      });\n\n      var mouse = this.document.screen.mouse; // Do not calc bounding box if mouse is not working.\n\n      if (mouse.isWorking()) {\n        mouse.checkBoundingBox(this, this.getBoundingBox(ctx));\n      }\n    }\n  }, {\n    key: \"renderTElementChildren\",\n    value: function renderTElementChildren(ctx) {\n      var document = this.document,\n          parent = this.parent;\n      var renderText = this.getText();\n      var customFont = parent.getStyle('font-family').getDefinition();\n\n      if (customFont) {\n        var _context3;\n\n        var unitsPerEm = customFont.fontFace.unitsPerEm;\n        var ctxFont = Font.parse(document.ctx.font);\n        var fontSize = parent.getStyle('font-size').getNumber(ctxFont.fontSize);\n        var fontStyle = parent.getStyle('font-style').getString(ctxFont.fontStyle);\n        var scale = fontSize / unitsPerEm;\n        var text = customFont.isRTL ? _reverseInstanceProperty(_context3 = renderText.split('')).call(_context3).join('') : renderText;\n        var dx = toNumbers(parent.getAttribute('dx').getString());\n        var len = text.length;\n\n        for (var i = 0; i < len; i++) {\n          var glyph = this.getGlyph(customFont, text, i);\n          ctx.translate(this.x, this.y);\n          ctx.scale(scale, -scale);\n          var lw = ctx.lineWidth;\n          ctx.lineWidth = ctx.lineWidth * unitsPerEm / fontSize;\n\n          if (fontStyle === 'italic') {\n            ctx.transform(1, 0, .4, 1, 0, 0);\n          }\n\n          glyph.render(ctx);\n\n          if (fontStyle === 'italic') {\n            ctx.transform(1, 0, -.4, 1, 0, 0);\n          }\n\n          ctx.lineWidth = lw;\n          ctx.scale(1 / scale, -1 / scale);\n          ctx.translate(-this.x, -this.y);\n          this.x += fontSize * (glyph.horizAdvX || customFont.horizAdvX) / unitsPerEm;\n\n          if (typeof dx[i] !== 'undefined' && !isNaN(dx[i])) {\n            this.x += dx[i];\n          }\n        }\n\n        return;\n      }\n\n      var x = this.x,\n          y = this.y;\n\n      if (ctx.paintOrder === 'stroke') {\n        if (ctx.strokeStyle) {\n          ctx.strokeText(renderText, x, y);\n        }\n\n        if (ctx.fillStyle) {\n          ctx.fillText(renderText, x, y);\n        }\n      } else {\n        if (ctx.fillStyle) {\n          ctx.fillText(renderText, x, y);\n        }\n\n        if (ctx.strokeStyle) {\n          ctx.strokeText(renderText, x, y);\n        }\n      }\n    }\n  }, {\n    key: \"getAnchorDelta\",\n    value: function getAnchorDelta(ctx, parent, startI) {\n      var textAnchor = this.getStyle('text-anchor').getString('start');\n\n      if (textAnchor !== 'start') {\n        var children = parent.children;\n        var len = children.length;\n        var child = null;\n        var width = 0;\n\n        for (var i = startI; i < len; i++) {\n          child = children[i];\n\n          if (i > startI && child.getAttribute('x').hasValue() || child.getAttribute('text-anchor').hasValue()) {\n            break; // new group\n          }\n\n          width += child.measureTextRecursive(ctx);\n        }\n\n        return -1 * (textAnchor === 'end' ? width : width / 2.0);\n      }\n\n      return 0;\n    }\n  }, {\n    key: \"adjustChildCoordinates\",\n    value: function adjustChildCoordinates(ctx, textParent, parent, i) {\n      var child = parent.children[i];\n\n      if (typeof child.measureText !== 'function') {\n        return child;\n      }\n\n      ctx.save();\n      child.setContext(ctx, true);\n      var xAttr = child.getAttribute('x');\n      var yAttr = child.getAttribute('y');\n      var dxAttr = child.getAttribute('dx');\n      var dyAttr = child.getAttribute('dy');\n      var textAnchor = child.getAttribute('text-anchor').getString('start');\n\n      if (i === 0 && child.type !== 'textNode') {\n        if (!xAttr.hasValue()) {\n          xAttr.setValue(textParent.getAttribute('x').getValue('0'));\n        }\n\n        if (!yAttr.hasValue()) {\n          yAttr.setValue(textParent.getAttribute('y').getValue('0'));\n        }\n\n        if (!dxAttr.hasValue()) {\n          dxAttr.setValue(textParent.getAttribute('dx').getValue('0'));\n        }\n\n        if (!dyAttr.hasValue()) {\n          dyAttr.setValue(textParent.getAttribute('dy').getValue('0'));\n        }\n      }\n\n      if (xAttr.hasValue()) {\n        child.x = xAttr.getPixels('x') + textParent.getAnchorDelta(ctx, parent, i);\n\n        if (textAnchor !== 'start') {\n          var width = child.measureTextRecursive(ctx);\n          child.x += -1 * (textAnchor === 'end' ? width : width / 2.0);\n        }\n\n        if (dxAttr.hasValue()) {\n          child.x += dxAttr.getPixels('x');\n        }\n      } else {\n        if (textAnchor !== 'start') {\n          var _width = child.measureTextRecursive(ctx);\n\n          textParent.x += -1 * (textAnchor === 'end' ? _width : _width / 2.0);\n        }\n\n        if (dxAttr.hasValue()) {\n          textParent.x += dxAttr.getPixels('x');\n        }\n\n        child.x = textParent.x;\n      }\n\n      textParent.x = child.x + child.measureText(ctx);\n\n      if (yAttr.hasValue()) {\n        child.y = yAttr.getPixels('y');\n\n        if (dyAttr.hasValue()) {\n          child.y += dyAttr.getPixels('y');\n        }\n      } else {\n        if (dyAttr.hasValue()) {\n          textParent.y += dyAttr.getPixels('y');\n        }\n\n        child.y = textParent.y;\n      }\n\n      textParent.y = child.y;\n      child.clearContext(ctx);\n      ctx.restore();\n      return child;\n    }\n  }, {\n    key: \"getChildBoundingBox\",\n    value: function getChildBoundingBox(ctx, textParent, parent, i) {\n      var _context4;\n\n      var child = this.adjustChildCoordinates(ctx, textParent, parent, i); // not a text node?\n\n      if (typeof child.getBoundingBox !== 'function') {\n        return null;\n      }\n\n      var boundingBox = child.getBoundingBox(ctx);\n\n      if (!boundingBox) {\n        return null;\n      }\n\n      _forEachInstanceProperty(_context4 = child.children).call(_context4, function (_, i) {\n        var childBoundingBox = textParent.getChildBoundingBox(ctx, textParent, child, i);\n        boundingBox.addBoundingBox(childBoundingBox);\n      });\n\n      return boundingBox;\n    }\n  }, {\n    key: \"renderChild\",\n    value: function renderChild(ctx, textParent, parent, i) {\n      var _context5;\n\n      var child = this.adjustChildCoordinates(ctx, textParent, parent, i);\n      child.render(ctx);\n\n      _forEachInstanceProperty(_context5 = child.children).call(_context5, function (_, i) {\n        textParent.renderChild(ctx, textParent, child, i);\n      });\n    }\n  }, {\n    key: \"measureTextRecursive\",\n    value: function measureTextRecursive(ctx) {\n      var _context6;\n\n      var width = _reduceInstanceProperty(_context6 = this.children).call(_context6, function (width, child) {\n        return width + child.measureTextRecursive(ctx);\n      }, this.measureText(ctx));\n\n      return width;\n    }\n  }, {\n    key: \"measureText\",\n    value: function measureText(ctx) {\n      var measureCache = this.measureCache;\n\n      if (~measureCache) {\n        return measureCache;\n      }\n\n      var renderText = this.getText();\n      var measure = this.measureTargetText(ctx, renderText);\n      this.measureCache = measure;\n      return measure;\n    }\n  }, {\n    key: \"measureTargetText\",\n    value: function measureTargetText(ctx, targetText) {\n      if (!targetText.length) {\n        return 0;\n      }\n\n      var parent = this.parent;\n      var customFont = parent.getStyle('font-family').getDefinition();\n\n      if (customFont) {\n        var _context7;\n\n        var fontSize = this.getFontSize();\n        var text = customFont.isRTL ? _reverseInstanceProperty(_context7 = targetText.split('')).call(_context7).join('') : targetText;\n        var dx = toNumbers(parent.getAttribute('dx').getString());\n        var len = text.length;\n        var _measure = 0;\n\n        for (var i = 0; i < len; i++) {\n          var glyph = this.getGlyph(customFont, text, i);\n          _measure += (glyph.horizAdvX || customFont.horizAdvX) * fontSize / customFont.fontFace.unitsPerEm;\n\n          if (typeof dx[i] !== 'undefined' && !isNaN(dx[i])) {\n            _measure += dx[i];\n          }\n        }\n\n        return _measure;\n      }\n\n      if (!ctx.measureText) {\n        return targetText.length * 10;\n      }\n\n      ctx.save();\n      this.setContext(ctx, true);\n\n      var _ctx$measureText = ctx.measureText(targetText),\n          measure = _ctx$measureText.width;\n\n      this.clearContext(ctx);\n      ctx.restore();\n      return measure;\n    }\n  }]);\n\n  return TextElement;\n}(RenderedElement);\n\nfunction _createSuper$6(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$6();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$6() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar TSpanElement = /*#__PURE__*/function (_TextElement) {\n  _inherits(TSpanElement, _TextElement);\n\n  var _super = _createSuper$6(TSpanElement);\n\n  function TSpanElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, TSpanElement);\n\n    _this = _super.call(this, document, node, (this instanceof TSpanElement ? this.constructor : void 0) === TSpanElement ? true : captureTextNodes);\n    _this.type = 'tspan'; // if this node has children, then they own the text\n\n    _this.text = _this.children.length > 0 ? '' : _this.getTextFromNode();\n    return _this;\n  }\n\n  _createClass(TSpanElement, [{\n    key: \"getText\",\n    value: function getText() {\n      return this.text;\n    }\n  }]);\n\n  return TSpanElement;\n}(TextElement);\n\nfunction _createSuper$7(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$7();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$7() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar TextNode = /*#__PURE__*/function (_TSpanElement) {\n  _inherits(TextNode, _TSpanElement);\n\n  var _super = _createSuper$7(TextNode);\n\n  function TextNode() {\n    var _this;\n\n    _classCallCheck(this, TextNode);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'textNode';\n    return _this;\n  }\n\n  return TextNode;\n}(TSpanElement);\n\nfunction _createSuper$8(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$8();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$8() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar PathParser = /*#__PURE__*/function (_SVGPathData) {\n  _inherits(PathParser, _SVGPathData);\n\n  var _super = _createSuper$8(PathParser);\n\n  function PathParser(path) {\n    var _this;\n\n    _classCallCheck(this, PathParser);\n\n    _this = _super.call(this, path // Fix spaces after signs.\n    .replace(/[+-.]\\s+/g, '-') // Remove invalid part.\n    .replace(/[^MmZzLlHhVvCcSsQqTtAae\\d\\s.,+-].*/g, ''));\n    _this.control = null;\n    _this.start = null;\n    _this.current = null;\n    _this.command = null;\n    _this.commands = _this.commands;\n    _this.i = -1;\n    _this.previousCommand = null;\n    _this.points = [];\n    _this.angles = [];\n    return _this;\n  }\n\n  _createClass(PathParser, [{\n    key: \"reset\",\n    value: function reset() {\n      this.i = -1;\n      this.command = null;\n      this.previousCommand = null;\n      this.start = new Point(0, 0);\n      this.control = new Point(0, 0);\n      this.current = new Point(0, 0);\n      this.points = [];\n      this.angles = [];\n    }\n  }, {\n    key: \"isEnd\",\n    value: function isEnd() {\n      var i = this.i,\n          commands = this.commands;\n      return i >= commands.length - 1;\n    }\n  }, {\n    key: \"next\",\n    value: function next() {\n      var command = this.commands[++this.i];\n      this.previousCommand = this.command;\n      this.command = command;\n      return command;\n    }\n  }, {\n    key: \"getPoint\",\n    value: function getPoint() {\n      var xProp = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'x';\n      var yProp = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'y';\n      var point = new Point(this.command[xProp], this.command[yProp]);\n      return this.makeAbsolute(point);\n    }\n  }, {\n    key: \"getAsControlPoint\",\n    value: function getAsControlPoint(xProp, yProp) {\n      var point = this.getPoint(xProp, yProp);\n      this.control = point;\n      return point;\n    }\n  }, {\n    key: \"getAsCurrentPoint\",\n    value: function getAsCurrentPoint(xProp, yProp) {\n      var point = this.getPoint(xProp, yProp);\n      this.current = point;\n      return point;\n    }\n  }, {\n    key: \"getReflectedControlPoint\",\n    value: function getReflectedControlPoint() {\n      var previousCommand = this.previousCommand.type;\n\n      if (previousCommand !== SVGPathData.CURVE_TO && previousCommand !== SVGPathData.SMOOTH_CURVE_TO && previousCommand !== SVGPathData.QUAD_TO && previousCommand !== SVGPathData.SMOOTH_QUAD_TO) {\n        return this.current;\n      } // reflect point\n\n\n      var _this$current = this.current,\n          cx = _this$current.x,\n          cy = _this$current.y,\n          _this$control = this.control,\n          ox = _this$control.x,\n          oy = _this$control.y;\n      var point = new Point(2 * cx - ox, 2 * cy - oy);\n      return point;\n    }\n  }, {\n    key: \"makeAbsolute\",\n    value: function makeAbsolute(point) {\n      if (this.command.relative) {\n        var _this$current2 = this.current,\n            x = _this$current2.x,\n            y = _this$current2.y;\n        point.x += x;\n        point.y += y;\n      }\n\n      return point;\n    }\n  }, {\n    key: \"addMarker\",\n    value: function addMarker(point, from, priorTo) {\n      var points = this.points,\n          angles = this.angles; // if the last angle isn't filled in because we didn't have this point yet ...\n\n      if (priorTo && angles.length > 0 && !angles[angles.length - 1]) {\n        angles[angles.length - 1] = points[points.length - 1].angleTo(priorTo);\n      }\n\n      this.addMarkerAngle(point, from ? from.angleTo(point) : null);\n    }\n  }, {\n    key: \"addMarkerAngle\",\n    value: function addMarkerAngle(point, angle) {\n      this.points.push(point);\n      this.angles.push(angle);\n    }\n  }, {\n    key: \"getMarkerPoints\",\n    value: function getMarkerPoints() {\n      return this.points;\n    }\n  }, {\n    key: \"getMarkerAngles\",\n    value: function getMarkerAngles() {\n      var angles = this.angles;\n      var len = angles.length;\n\n      for (var i = 0; i < len; i++) {\n        if (!angles[i]) {\n          for (var j = i + 1; j < len; j++) {\n            if (angles[j]) {\n              angles[i] = angles[j];\n              break;\n            }\n          }\n        }\n      }\n\n      return angles;\n    }\n  }]);\n\n  return PathParser;\n}(SVGPathData);\n\nfunction _createSuper$9(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$9();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$9() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar PathElement = /*#__PURE__*/function (_RenderedElement) {\n  _inherits(PathElement, _RenderedElement);\n\n  var _super = _createSuper$9(PathElement);\n\n  function PathElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, PathElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'path';\n    _this.pathParser = null;\n    _this.pathParser = new PathParser(_this.getAttribute('d').getString());\n    return _this;\n  }\n\n  _createClass(PathElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var pathParser = this.pathParser;\n      var boundingBox = new BoundingBox();\n      pathParser.reset();\n\n      if (ctx) {\n        ctx.beginPath();\n      }\n\n      while (!pathParser.isEnd()) {\n        switch (pathParser.next().type) {\n          case PathParser.MOVE_TO:\n            this.pathM(ctx, boundingBox);\n            break;\n\n          case PathParser.LINE_TO:\n            this.pathL(ctx, boundingBox);\n            break;\n\n          case PathParser.HORIZ_LINE_TO:\n            this.pathH(ctx, boundingBox);\n            break;\n\n          case PathParser.VERT_LINE_TO:\n            this.pathV(ctx, boundingBox);\n            break;\n\n          case PathParser.CURVE_TO:\n            this.pathC(ctx, boundingBox);\n            break;\n\n          case PathParser.SMOOTH_CURVE_TO:\n            this.pathS(ctx, boundingBox);\n            break;\n\n          case PathParser.QUAD_TO:\n            this.pathQ(ctx, boundingBox);\n            break;\n\n          case PathParser.SMOOTH_QUAD_TO:\n            this.pathT(ctx, boundingBox);\n            break;\n\n          case PathParser.ARC:\n            this.pathA(ctx, boundingBox);\n            break;\n\n          case PathParser.CLOSE_PATH:\n            this.pathZ(ctx, boundingBox);\n            break;\n        }\n      }\n\n      return boundingBox;\n    }\n  }, {\n    key: \"getBoundingBox\",\n    value: function getBoundingBox(_) {\n      return this.path();\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      var pathParser = this.pathParser;\n      var points = pathParser.getMarkerPoints();\n      var angles = pathParser.getMarkerAngles();\n\n      var markers = _mapInstanceProperty(points).call(points, function (point, i) {\n        return [point, angles[i]];\n      });\n\n      return markers;\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      this.path(ctx);\n      this.document.screen.mouse.checkPath(this, ctx);\n      var fillRuleStyleProp = this.getStyle('fill-rule');\n\n      if (ctx.fillStyle !== '') {\n        if (fillRuleStyleProp.getString('inherit') !== 'inherit') {\n          _fillInstanceProperty(ctx).call(ctx, fillRuleStyleProp.getString());\n        } else {\n          _fillInstanceProperty(ctx).call(ctx);\n        }\n      }\n\n      if (ctx.strokeStyle !== '') {\n        ctx.stroke();\n      }\n\n      var markers = this.getMarkers();\n\n      if (markers) {\n        var markersLastIndex = markers.length - 1;\n        var markerStartStyleProp = this.getStyle('marker-start');\n        var markerMidStyleProp = this.getStyle('marker-mid');\n        var markerEndStyleProp = this.getStyle('marker-end');\n\n        if (markerStartStyleProp.isUrlDefinition()) {\n          var marker = markerStartStyleProp.getDefinition();\n\n          var _markers$ = _slicedToArray(markers[0], 2),\n              point = _markers$[0],\n              angle = _markers$[1];\n\n          marker.render(ctx, point, angle);\n        }\n\n        if (markerMidStyleProp.isUrlDefinition()) {\n          var _marker = markerMidStyleProp.getDefinition();\n\n          for (var i = 1; i < markersLastIndex; i++) {\n            var _markers$i = _slicedToArray(markers[i], 2),\n                _point = _markers$i[0],\n                _angle = _markers$i[1];\n\n            _marker.render(ctx, _point, _angle);\n          }\n        }\n\n        if (markerEndStyleProp.isUrlDefinition()) {\n          var _marker2 = markerEndStyleProp.getDefinition();\n\n          var _markers$markersLastI = _slicedToArray(markers[markersLastIndex], 2),\n              _point2 = _markers$markersLastI[0],\n              _angle2 = _markers$markersLastI[1];\n\n          _marker2.render(ctx, _point2, _angle2);\n        }\n      }\n    }\n  }, {\n    key: \"pathM\",\n    value: function pathM(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathM = PathElement.pathM(pathParser),\n          point = _PathElement$pathM.point;\n\n      var x = point.x,\n          y = point.y;\n      pathParser.addMarker(point);\n      boundingBox.addPoint(x, y);\n\n      if (ctx) {\n        ctx.moveTo(x, y);\n      }\n    }\n  }, {\n    key: \"pathL\",\n    value: function pathL(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathL = PathElement.pathL(pathParser),\n          current = _PathElement$pathL.current,\n          point = _PathElement$pathL.point;\n\n      var x = point.x,\n          y = point.y;\n      pathParser.addMarker(point, current);\n      boundingBox.addPoint(x, y);\n\n      if (ctx) {\n        ctx.lineTo(x, y);\n      }\n    }\n  }, {\n    key: \"pathH\",\n    value: function pathH(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathH = PathElement.pathH(pathParser),\n          current = _PathElement$pathH.current,\n          point = _PathElement$pathH.point;\n\n      var x = point.x,\n          y = point.y;\n      pathParser.addMarker(point, current);\n      boundingBox.addPoint(x, y);\n\n      if (ctx) {\n        ctx.lineTo(x, y);\n      }\n    }\n  }, {\n    key: \"pathV\",\n    value: function pathV(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathV = PathElement.pathV(pathParser),\n          current = _PathElement$pathV.current,\n          point = _PathElement$pathV.point;\n\n      var x = point.x,\n          y = point.y;\n      pathParser.addMarker(point, current);\n      boundingBox.addPoint(x, y);\n\n      if (ctx) {\n        ctx.lineTo(x, y);\n      }\n    }\n  }, {\n    key: \"pathC\",\n    value: function pathC(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathC = PathElement.pathC(pathParser),\n          current = _PathElement$pathC.current,\n          point = _PathElement$pathC.point,\n          controlPoint = _PathElement$pathC.controlPoint,\n          currentPoint = _PathElement$pathC.currentPoint;\n\n      pathParser.addMarker(currentPoint, controlPoint, point);\n      boundingBox.addBezierCurve(current.x, current.y, point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n      if (ctx) {\n        ctx.bezierCurveTo(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      }\n    }\n  }, {\n    key: \"pathS\",\n    value: function pathS(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathS = PathElement.pathS(pathParser),\n          current = _PathElement$pathS.current,\n          point = _PathElement$pathS.point,\n          controlPoint = _PathElement$pathS.controlPoint,\n          currentPoint = _PathElement$pathS.currentPoint;\n\n      pathParser.addMarker(currentPoint, controlPoint, point);\n      boundingBox.addBezierCurve(current.x, current.y, point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n      if (ctx) {\n        ctx.bezierCurveTo(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      }\n    }\n  }, {\n    key: \"pathQ\",\n    value: function pathQ(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathQ = PathElement.pathQ(pathParser),\n          current = _PathElement$pathQ.current,\n          controlPoint = _PathElement$pathQ.controlPoint,\n          currentPoint = _PathElement$pathQ.currentPoint;\n\n      pathParser.addMarker(currentPoint, controlPoint, controlPoint);\n      boundingBox.addQuadraticCurve(current.x, current.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n      if (ctx) {\n        ctx.quadraticCurveTo(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      }\n    }\n  }, {\n    key: \"pathT\",\n    value: function pathT(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathT = PathElement.pathT(pathParser),\n          current = _PathElement$pathT.current,\n          controlPoint = _PathElement$pathT.controlPoint,\n          currentPoint = _PathElement$pathT.currentPoint;\n\n      pathParser.addMarker(currentPoint, controlPoint, controlPoint);\n      boundingBox.addQuadraticCurve(current.x, current.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n\n      if (ctx) {\n        ctx.quadraticCurveTo(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      }\n    }\n  }, {\n    key: \"pathA\",\n    value: function pathA(ctx, boundingBox) {\n      var pathParser = this.pathParser;\n\n      var _PathElement$pathA = PathElement.pathA(pathParser),\n          currentPoint = _PathElement$pathA.currentPoint,\n          rX = _PathElement$pathA.rX,\n          rY = _PathElement$pathA.rY,\n          sweepFlag = _PathElement$pathA.sweepFlag,\n          xAxisRotation = _PathElement$pathA.xAxisRotation,\n          centp = _PathElement$pathA.centp,\n          a1 = _PathElement$pathA.a1,\n          ad = _PathElement$pathA.ad; // for markers\n\n\n      var dir = 1 - sweepFlag ? 1.0 : -1.0;\n      var ah = a1 + dir * (ad / 2.0);\n      var halfWay = new Point(centp.x + rX * Math.cos(ah), centp.y + rY * Math.sin(ah));\n      pathParser.addMarkerAngle(halfWay, ah - dir * Math.PI / 2);\n      pathParser.addMarkerAngle(currentPoint, ah - dir * Math.PI);\n      boundingBox.addPoint(currentPoint.x, currentPoint.y); // TODO: this is too naive, make it better\n\n      if (ctx && !isNaN(a1) && !isNaN(ad)) {\n        var r = rX > rY ? rX : rY;\n        var sx = rX > rY ? 1 : rX / rY;\n        var sy = rX > rY ? rY / rX : 1;\n        ctx.translate(centp.x, centp.y);\n        ctx.rotate(xAxisRotation);\n        ctx.scale(sx, sy);\n        ctx.arc(0, 0, r, a1, a1 + ad, Boolean(1 - sweepFlag));\n        ctx.scale(1 / sx, 1 / sy);\n        ctx.rotate(-xAxisRotation);\n        ctx.translate(-centp.x, -centp.y);\n      }\n    }\n  }, {\n    key: \"pathZ\",\n    value: function pathZ(ctx, boundingBox) {\n      PathElement.pathZ(this.pathParser);\n\n      if (ctx) {\n        // only close path if it is not a straight line\n        if (boundingBox.x1 !== boundingBox.x2 && boundingBox.y1 !== boundingBox.y2) {\n          ctx.closePath();\n        }\n      }\n    }\n  }], [{\n    key: \"pathM\",\n    value: function pathM(pathParser) {\n      var point = pathParser.getAsCurrentPoint();\n      pathParser.start = pathParser.current;\n      return {\n        point: point\n      };\n    }\n  }, {\n    key: \"pathL\",\n    value: function pathL(pathParser) {\n      var current = pathParser.current;\n      var point = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        point: point\n      };\n    }\n  }, {\n    key: \"pathH\",\n    value: function pathH(pathParser) {\n      var current = pathParser.current,\n          command = pathParser.command;\n      var point = new Point((command.relative ? current.x : 0) + command.x, current.y);\n      pathParser.current = point;\n      return {\n        current: current,\n        point: point\n      };\n    }\n  }, {\n    key: \"pathV\",\n    value: function pathV(pathParser) {\n      var current = pathParser.current,\n          command = pathParser.command;\n      var point = new Point(current.x, (command.relative ? current.y : 0) + command.y);\n      pathParser.current = point;\n      return {\n        current: current,\n        point: point\n      };\n    }\n  }, {\n    key: \"pathC\",\n    value: function pathC(pathParser) {\n      var current = pathParser.current;\n      var point = pathParser.getPoint('x1', 'y1');\n      var controlPoint = pathParser.getAsControlPoint('x2', 'y2');\n      var currentPoint = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        point: point,\n        controlPoint: controlPoint,\n        currentPoint: currentPoint\n      };\n    }\n  }, {\n    key: \"pathS\",\n    value: function pathS(pathParser) {\n      var current = pathParser.current;\n      var point = pathParser.getReflectedControlPoint();\n      var controlPoint = pathParser.getAsControlPoint('x2', 'y2');\n      var currentPoint = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        point: point,\n        controlPoint: controlPoint,\n        currentPoint: currentPoint\n      };\n    }\n  }, {\n    key: \"pathQ\",\n    value: function pathQ(pathParser) {\n      var current = pathParser.current;\n      var controlPoint = pathParser.getAsControlPoint('x1', 'y1');\n      var currentPoint = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        controlPoint: controlPoint,\n        currentPoint: currentPoint\n      };\n    }\n  }, {\n    key: \"pathT\",\n    value: function pathT(pathParser) {\n      var current = pathParser.current;\n      var controlPoint = pathParser.getReflectedControlPoint();\n      pathParser.control = controlPoint;\n      var currentPoint = pathParser.getAsCurrentPoint();\n      return {\n        current: current,\n        controlPoint: controlPoint,\n        currentPoint: currentPoint\n      };\n    }\n  }, {\n    key: \"pathA\",\n    value: function pathA(pathParser) {\n      var current = pathParser.current,\n          command = pathParser.command;\n      var rX = command.rX,\n          rY = command.rY,\n          xRot = command.xRot,\n          lArcFlag = command.lArcFlag,\n          sweepFlag = command.sweepFlag;\n      var xAxisRotation = xRot * (Math.PI / 180.0);\n      var currentPoint = pathParser.getAsCurrentPoint(); // Conversion from endpoint to center parameterization\n      // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n      // x1', y1'\n\n      var currp = new Point(Math.cos(xAxisRotation) * (current.x - currentPoint.x) / 2.0 + Math.sin(xAxisRotation) * (current.y - currentPoint.y) / 2.0, -Math.sin(xAxisRotation) * (current.x - currentPoint.x) / 2.0 + Math.cos(xAxisRotation) * (current.y - currentPoint.y) / 2.0); // adjust radii\n\n      var l = Math.pow(currp.x, 2) / Math.pow(rX, 2) + Math.pow(currp.y, 2) / Math.pow(rY, 2);\n\n      if (l > 1) {\n        rX *= Math.sqrt(l);\n        rY *= Math.sqrt(l);\n      } // cx', cy'\n\n\n      var s = (lArcFlag === sweepFlag ? -1 : 1) * Math.sqrt((Math.pow(rX, 2) * Math.pow(rY, 2) - Math.pow(rX, 2) * Math.pow(currp.y, 2) - Math.pow(rY, 2) * Math.pow(currp.x, 2)) / (Math.pow(rX, 2) * Math.pow(currp.y, 2) + Math.pow(rY, 2) * Math.pow(currp.x, 2)));\n\n      if (isNaN(s)) {\n        s = 0;\n      }\n\n      var cpp = new Point(s * rX * currp.y / rY, s * -rY * currp.x / rX); // cx, cy\n\n      var centp = new Point((current.x + currentPoint.x) / 2.0 + Math.cos(xAxisRotation) * cpp.x - Math.sin(xAxisRotation) * cpp.y, (current.y + currentPoint.y) / 2.0 + Math.sin(xAxisRotation) * cpp.x + Math.cos(xAxisRotation) * cpp.y); // initial angle\n\n      var a1 = vectorsAngle([1, 0], [(currp.x - cpp.x) / rX, (currp.y - cpp.y) / rY]); // θ1\n      // angle delta\n\n      var u = [(currp.x - cpp.x) / rX, (currp.y - cpp.y) / rY];\n      var v = [(-currp.x - cpp.x) / rX, (-currp.y - cpp.y) / rY];\n      var ad = vectorsAngle(u, v); // Δθ\n\n      if (vectorsRatio(u, v) <= -1) {\n        ad = Math.PI;\n      }\n\n      if (vectorsRatio(u, v) >= 1) {\n        ad = 0;\n      }\n\n      return {\n        currentPoint: currentPoint,\n        rX: rX,\n        rY: rY,\n        sweepFlag: sweepFlag,\n        xAxisRotation: xAxisRotation,\n        centp: centp,\n        a1: a1,\n        ad: ad\n      };\n    }\n  }, {\n    key: \"pathZ\",\n    value: function pathZ(pathParser) {\n      pathParser.current = pathParser.start;\n    }\n  }]);\n\n  return PathElement;\n}(RenderedElement);\n\nfunction _createSuper$a(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$a();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$a() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar SVGElement = /*#__PURE__*/function (_RenderedElement) {\n  _inherits(SVGElement, _RenderedElement);\n\n  var _super = _createSuper$a(SVGElement);\n\n  function SVGElement() {\n    var _this;\n\n    _classCallCheck(this, SVGElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'svg';\n    _this.root = false;\n    return _this;\n  }\n\n  _createClass(SVGElement, [{\n    key: \"setContext\",\n    value: function setContext(ctx) {\n      var document = this.document;\n      var screen = document.screen,\n          window = document.window;\n      var canvas = ctx.canvas;\n      screen.setDefaults(ctx);\n\n      if (canvas.style && typeof ctx.font !== 'undefined' && window && typeof window.getComputedStyle !== 'undefined') {\n        ctx.font = window.getComputedStyle(canvas).getPropertyValue('font');\n        var fontSizeProp = new Property(document, 'fontSize', Font.parse(ctx.font).fontSize);\n\n        if (fontSizeProp.hasValue()) {\n          document.rootEmSize = fontSizeProp.getPixels('y');\n          document.emSize = document.rootEmSize;\n        }\n      } // create new view port\n\n\n      if (!this.getAttribute('x').hasValue()) {\n        this.getAttribute('x', true).setValue(0);\n      }\n\n      if (!this.getAttribute('y').hasValue()) {\n        this.getAttribute('y', true).setValue(0);\n      }\n\n      var _screen$viewPort = screen.viewPort,\n          width = _screen$viewPort.width,\n          height = _screen$viewPort.height;\n\n      if (!this.getStyle('width').hasValue()) {\n        this.getStyle('width', true).setValue('100%');\n      }\n\n      if (!this.getStyle('height').hasValue()) {\n        this.getStyle('height', true).setValue('100%');\n      }\n\n      if (!this.getStyle('color').hasValue()) {\n        this.getStyle('color', true).setValue('black');\n      }\n\n      var refXAttr = this.getAttribute('refX');\n      var refYAttr = this.getAttribute('refY');\n      var viewBoxAttr = this.getAttribute('viewBox');\n      var viewBox = viewBoxAttr.hasValue() ? toNumbers(viewBoxAttr.getString()) : null;\n      var clip = !this.root && this.getStyle('overflow').getValue('hidden') !== 'visible';\n      var minX = 0;\n      var minY = 0;\n      var clipX = 0;\n      var clipY = 0;\n\n      if (viewBox) {\n        minX = viewBox[0];\n        minY = viewBox[1];\n      }\n\n      if (!this.root) {\n        width = this.getStyle('width').getPixels('x');\n        height = this.getStyle('height').getPixels('y');\n\n        if (this.type === 'marker') {\n          clipX = minX;\n          clipY = minY;\n          minX = 0;\n          minY = 0;\n        }\n      }\n\n      screen.viewPort.setCurrent(width, height);\n\n      if (this.node // is not temporary SVGElement\n      && this.getStyle('transform', false, true).hasValue() && !this.getStyle('transform-origin', false, true).hasValue()) {\n        this.getStyle('transform-origin', true, true).setValue('50% 50%');\n      }\n\n      _get(_getPrototypeOf(SVGElement.prototype), \"setContext\", this).call(this, ctx);\n\n      ctx.translate(this.getAttribute('x').getPixels('x'), this.getAttribute('y').getPixels('y'));\n\n      if (viewBox) {\n        width = viewBox[2];\n        height = viewBox[3];\n      }\n\n      document.setViewBox({\n        ctx: ctx,\n        aspectRatio: this.getAttribute('preserveAspectRatio').getString(),\n        width: screen.viewPort.width,\n        desiredWidth: width,\n        height: screen.viewPort.height,\n        desiredHeight: height,\n        minX: minX,\n        minY: minY,\n        refX: refXAttr.getValue(),\n        refY: refYAttr.getValue(),\n        clip: clip,\n        clipX: clipX,\n        clipY: clipY\n      });\n\n      if (viewBox) {\n        screen.viewPort.removeCurrent();\n        screen.viewPort.setCurrent(width, height);\n      }\n    }\n  }, {\n    key: \"clearContext\",\n    value: function clearContext(ctx) {\n      _get(_getPrototypeOf(SVGElement.prototype), \"clearContext\", this).call(this, ctx);\n\n      this.document.screen.viewPort.removeCurrent();\n    }\n    /**\r\n     * Resize SVG to fit in given size.\r\n     * @param width\r\n     * @param height\r\n     * @param preserveAspectRatio\r\n     */\n\n  }, {\n    key: \"resize\",\n    value: function resize(width) {\n      var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : width;\n      var preserveAspectRatio = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var widthAttr = this.getAttribute('width', true);\n      var heightAttr = this.getAttribute('height', true);\n      var viewBoxAttr = this.getAttribute('viewBox');\n      var styleAttr = this.getAttribute('style');\n      var originWidth = widthAttr.getNumber(0);\n      var originHeight = heightAttr.getNumber(0);\n\n      if (preserveAspectRatio) {\n        if (typeof preserveAspectRatio === 'string') {\n          this.getAttribute('preserveAspectRatio', true).setValue(preserveAspectRatio);\n        } else {\n          var preserveAspectRatioAttr = this.getAttribute('preserveAspectRatio');\n\n          if (preserveAspectRatioAttr.hasValue()) {\n            preserveAspectRatioAttr.setValue(preserveAspectRatioAttr.getString().replace(/^\\s*(\\S.*\\S)\\s*$/, '$1'));\n          }\n        }\n      }\n\n      widthAttr.setValue(width);\n      heightAttr.setValue(height);\n\n      if (!viewBoxAttr.hasValue()) {\n        var _context;\n\n        viewBoxAttr.setValue(_concatInstanceProperty(_context = \"0 0 \".concat(originWidth || width, \" \")).call(_context, originHeight || height));\n      }\n\n      if (styleAttr.hasValue()) {\n        var widthStyle = this.getStyle('width');\n        var heightStyle = this.getStyle('height');\n\n        if (widthStyle.hasValue()) {\n          widthStyle.setValue(\"\".concat(width, \"px\"));\n        }\n\n        if (heightStyle.hasValue()) {\n          heightStyle.setValue(\"\".concat(height, \"px\"));\n        }\n      }\n    }\n  }]);\n\n  return SVGElement;\n}(RenderedElement);\n\nfunction _createSuper$b(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$b();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$b() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar RectElement = /*#__PURE__*/function (_PathElement) {\n  _inherits(RectElement, _PathElement);\n\n  var _super = _createSuper$b(RectElement);\n\n  function RectElement() {\n    var _this;\n\n    _classCallCheck(this, RectElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'rect';\n    return _this;\n  }\n\n  _createClass(RectElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var x = this.getAttribute('x').getPixels('x');\n      var y = this.getAttribute('y').getPixels('y');\n      var width = this.getStyle('width', false, true).getPixels('x');\n      var height = this.getStyle('height', false, true).getPixels('y');\n      var rxAttr = this.getAttribute('rx');\n      var ryAttr = this.getAttribute('ry');\n      var rx = rxAttr.getPixels('x');\n      var ry = ryAttr.getPixels('y');\n\n      if (rxAttr.hasValue() && !ryAttr.hasValue()) {\n        ry = rx;\n      }\n\n      if (ryAttr.hasValue() && !rxAttr.hasValue()) {\n        rx = ry;\n      }\n\n      rx = Math.min(rx, width / 2.0);\n      ry = Math.min(ry, height / 2.0);\n\n      if (ctx) {\n        var KAPPA = 4 * ((Math.sqrt(2) - 1) / 3);\n        ctx.beginPath(); // always start the path so we don't fill prior paths\n\n        if (height > 0 && width > 0) {\n          ctx.moveTo(x + rx, y);\n          ctx.lineTo(x + width - rx, y);\n          ctx.bezierCurveTo(x + width - rx + KAPPA * rx, y, x + width, y + ry - KAPPA * ry, x + width, y + ry);\n          ctx.lineTo(x + width, y + height - ry);\n          ctx.bezierCurveTo(x + width, y + height - ry + KAPPA * ry, x + width - rx + KAPPA * rx, y + height, x + width - rx, y + height);\n          ctx.lineTo(x + rx, y + height);\n          ctx.bezierCurveTo(x + rx - KAPPA * rx, y + height, x, y + height - ry + KAPPA * ry, x, y + height - ry);\n          ctx.lineTo(x, y + ry);\n          ctx.bezierCurveTo(x, y + ry - KAPPA * ry, x + rx - KAPPA * rx, y, x + rx, y);\n          ctx.closePath();\n        }\n      }\n\n      return new BoundingBox(x, y, x + width, y + height);\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      return null;\n    }\n  }]);\n\n  return RectElement;\n}(PathElement);\n\nfunction _createSuper$c(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$c();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$c() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar CircleElement = /*#__PURE__*/function (_PathElement) {\n  _inherits(CircleElement, _PathElement);\n\n  var _super = _createSuper$c(CircleElement);\n\n  function CircleElement() {\n    var _this;\n\n    _classCallCheck(this, CircleElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'circle';\n    return _this;\n  }\n\n  _createClass(CircleElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var cx = this.getAttribute('cx').getPixels('x');\n      var cy = this.getAttribute('cy').getPixels('y');\n      var r = this.getAttribute('r').getPixels();\n\n      if (ctx && r > 0) {\n        ctx.beginPath();\n        ctx.arc(cx, cy, r, 0, Math.PI * 2, false);\n        ctx.closePath();\n      }\n\n      return new BoundingBox(cx - r, cy - r, cx + r, cy + r);\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      return null;\n    }\n  }]);\n\n  return CircleElement;\n}(PathElement);\n\nfunction _createSuper$d(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$d();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$d() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar EllipseElement = /*#__PURE__*/function (_PathElement) {\n  _inherits(EllipseElement, _PathElement);\n\n  var _super = _createSuper$d(EllipseElement);\n\n  function EllipseElement() {\n    var _this;\n\n    _classCallCheck(this, EllipseElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'ellipse';\n    return _this;\n  }\n\n  _createClass(EllipseElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var KAPPA = 4 * ((Math.sqrt(2) - 1) / 3);\n      var rx = this.getAttribute('rx').getPixels('x');\n      var ry = this.getAttribute('ry').getPixels('y');\n      var cx = this.getAttribute('cx').getPixels('x');\n      var cy = this.getAttribute('cy').getPixels('y');\n\n      if (ctx && rx > 0 && ry > 0) {\n        ctx.beginPath();\n        ctx.moveTo(cx + rx, cy);\n        ctx.bezierCurveTo(cx + rx, cy + KAPPA * ry, cx + KAPPA * rx, cy + ry, cx, cy + ry);\n        ctx.bezierCurveTo(cx - KAPPA * rx, cy + ry, cx - rx, cy + KAPPA * ry, cx - rx, cy);\n        ctx.bezierCurveTo(cx - rx, cy - KAPPA * ry, cx - KAPPA * rx, cy - ry, cx, cy - ry);\n        ctx.bezierCurveTo(cx + KAPPA * rx, cy - ry, cx + rx, cy - KAPPA * ry, cx + rx, cy);\n        ctx.closePath();\n      }\n\n      return new BoundingBox(cx - rx, cy - ry, cx + rx, cy + ry);\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      return null;\n    }\n  }]);\n\n  return EllipseElement;\n}(PathElement);\n\nfunction _createSuper$e(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$e();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$e() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar LineElement = /*#__PURE__*/function (_PathElement) {\n  _inherits(LineElement, _PathElement);\n\n  var _super = _createSuper$e(LineElement);\n\n  function LineElement() {\n    var _this;\n\n    _classCallCheck(this, LineElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'line';\n    return _this;\n  }\n\n  _createClass(LineElement, [{\n    key: \"getPoints\",\n    value: function getPoints() {\n      return [new Point(this.getAttribute('x1').getPixels('x'), this.getAttribute('y1').getPixels('y')), new Point(this.getAttribute('x2').getPixels('x'), this.getAttribute('y2').getPixels('y'))];\n    }\n  }, {\n    key: \"path\",\n    value: function path(ctx) {\n      var _this$getPoints = this.getPoints(),\n          _this$getPoints2 = _slicedToArray(_this$getPoints, 2),\n          _this$getPoints2$ = _this$getPoints2[0],\n          x0 = _this$getPoints2$.x,\n          y0 = _this$getPoints2$.y,\n          _this$getPoints2$2 = _this$getPoints2[1],\n          x1 = _this$getPoints2$2.x,\n          y1 = _this$getPoints2$2.y;\n\n      if (ctx) {\n        ctx.beginPath();\n        ctx.moveTo(x0, y0);\n        ctx.lineTo(x1, y1);\n      }\n\n      return new BoundingBox(x0, y0, x1, y1);\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      var _this$getPoints3 = this.getPoints(),\n          _this$getPoints4 = _slicedToArray(_this$getPoints3, 2),\n          p0 = _this$getPoints4[0],\n          p1 = _this$getPoints4[1];\n\n      var a = p0.angleTo(p1);\n      return [[p0, a], [p1, a]];\n    }\n  }]);\n\n  return LineElement;\n}(PathElement);\n\nfunction _createSuper$f(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$f();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$f() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar PolylineElement = /*#__PURE__*/function (_PathElement) {\n  _inherits(PolylineElement, _PathElement);\n\n  var _super = _createSuper$f(PolylineElement);\n\n  function PolylineElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, PolylineElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'polyline';\n    _this.points = [];\n    _this.points = Point.parsePath(_this.getAttribute('points').getString());\n    return _this;\n  }\n\n  _createClass(PolylineElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var points = this.points;\n\n      var _points = _slicedToArray(points, 1),\n          _points$ = _points[0],\n          x0 = _points$.x,\n          y0 = _points$.y;\n\n      var boundingBox = new BoundingBox(x0, y0);\n\n      if (ctx) {\n        ctx.beginPath();\n        ctx.moveTo(x0, y0);\n      }\n\n      _forEachInstanceProperty(points).call(points, function (_ref) {\n        var x = _ref.x,\n            y = _ref.y;\n        boundingBox.addPoint(x, y);\n\n        if (ctx) {\n          ctx.lineTo(x, y);\n        }\n      });\n\n      return boundingBox;\n    }\n  }, {\n    key: \"getMarkers\",\n    value: function getMarkers() {\n      var points = this.points;\n      var lastIndex = points.length - 1;\n      var markers = [];\n\n      _forEachInstanceProperty(points).call(points, function (point, i) {\n        if (i === lastIndex) {\n          return;\n        }\n\n        markers.push([point, point.angleTo(points[i + 1])]);\n      });\n\n      if (markers.length > 0) {\n        markers.push([points[points.length - 1], markers[markers.length - 1][1]]);\n      }\n\n      return markers;\n    }\n  }]);\n\n  return PolylineElement;\n}(PathElement);\n\nfunction _createSuper$g(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$g();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$g() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar PolygonElement = /*#__PURE__*/function (_PolylineElement) {\n  _inherits(PolygonElement, _PolylineElement);\n\n  var _super = _createSuper$g(PolygonElement);\n\n  function PolygonElement() {\n    var _this;\n\n    _classCallCheck(this, PolygonElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'polygon';\n    return _this;\n  }\n\n  _createClass(PolygonElement, [{\n    key: \"path\",\n    value: function path(ctx) {\n      var boundingBox = _get(_getPrototypeOf(PolygonElement.prototype), \"path\", this).call(this, ctx);\n\n      var _this$points = _slicedToArray(this.points, 1),\n          _this$points$ = _this$points[0],\n          x = _this$points$.x,\n          y = _this$points$.y;\n\n      if (ctx) {\n        ctx.lineTo(x, y);\n        ctx.closePath();\n      }\n\n      return boundingBox;\n    }\n  }]);\n\n  return PolygonElement;\n}(PolylineElement);\n\nfunction _createSuper$h(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$h();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$h() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar PatternElement = /*#__PURE__*/function (_Element) {\n  _inherits(PatternElement, _Element);\n\n  var _super = _createSuper$h(PatternElement);\n\n  function PatternElement() {\n    var _this;\n\n    _classCallCheck(this, PatternElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'pattern';\n    return _this;\n  }\n\n  _createClass(PatternElement, [{\n    key: \"createPattern\",\n    value: function createPattern(ctx, _, parentOpacityProp) {\n      var width = this.getStyle('width').getPixels('x', true);\n      var height = this.getStyle('height').getPixels('y', true); // render me using a temporary svg element\n\n      var patternSvg = new SVGElement(this.document, null);\n      patternSvg.attributes.viewBox = new Property(this.document, 'viewBox', this.getAttribute('viewBox').getValue());\n      patternSvg.attributes.width = new Property(this.document, 'width', \"\".concat(width, \"px\"));\n      patternSvg.attributes.height = new Property(this.document, 'height', \"\".concat(height, \"px\"));\n      patternSvg.attributes.transform = new Property(this.document, 'transform', this.getAttribute('patternTransform').getValue());\n      patternSvg.children = this.children;\n      var patternCanvas = this.document.createCanvas(width, height);\n      var patternCtx = patternCanvas.getContext('2d');\n      var xAttr = this.getAttribute('x');\n      var yAttr = this.getAttribute('y');\n\n      if (xAttr.hasValue() && yAttr.hasValue()) {\n        patternCtx.translate(xAttr.getPixels('x', true), yAttr.getPixels('y', true));\n      }\n\n      if (parentOpacityProp.hasValue()) {\n        this.styles['fill-opacity'] = parentOpacityProp;\n      } else {\n        _Reflect$deleteProperty(this.styles, 'fill-opacity');\n      } // render 3x3 grid so when we transform there's no white space on edges\n\n\n      for (var x = -1; x <= 1; x++) {\n        for (var y = -1; y <= 1; y++) {\n          patternCtx.save();\n          patternSvg.attributes.x = new Property(this.document, 'x', x * patternCanvas.width);\n          patternSvg.attributes.y = new Property(this.document, 'y', y * patternCanvas.height);\n          patternSvg.render(patternCtx);\n          patternCtx.restore();\n        }\n      }\n\n      var pattern = ctx.createPattern(patternCanvas, 'repeat');\n      return pattern;\n    }\n  }]);\n\n  return PatternElement;\n}(Element);\n\nfunction _createSuper$i(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$i();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$i() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar MarkerElement = /*#__PURE__*/function (_Element) {\n  _inherits(MarkerElement, _Element);\n\n  var _super = _createSuper$i(MarkerElement);\n\n  function MarkerElement() {\n    var _this;\n\n    _classCallCheck(this, MarkerElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'marker';\n    return _this;\n  }\n\n  _createClass(MarkerElement, [{\n    key: \"render\",\n    value: function render(ctx, point, angle) {\n      if (!point) {\n        return;\n      }\n\n      var x = point.x,\n          y = point.y;\n      var orient = this.getAttribute('orient').getValue('auto');\n      var markerUnits = this.getAttribute('markerUnits').getValue('strokeWidth');\n      ctx.translate(x, y);\n\n      if (orient === 'auto') {\n        ctx.rotate(angle);\n      }\n\n      if (markerUnits === 'strokeWidth') {\n        ctx.scale(ctx.lineWidth, ctx.lineWidth);\n      }\n\n      ctx.save(); // render me using a temporary svg element\n\n      var markerSvg = new SVGElement(this.document, null);\n      markerSvg.type = this.type;\n      markerSvg.attributes.viewBox = new Property(this.document, 'viewBox', this.getAttribute('viewBox').getValue());\n      markerSvg.attributes.refX = new Property(this.document, 'refX', this.getAttribute('refX').getValue());\n      markerSvg.attributes.refY = new Property(this.document, 'refY', this.getAttribute('refY').getValue());\n      markerSvg.attributes.width = new Property(this.document, 'width', this.getAttribute('markerWidth').getValue());\n      markerSvg.attributes.height = new Property(this.document, 'height', this.getAttribute('markerHeight').getValue());\n      markerSvg.attributes.overflow = new Property(this.document, 'overflow', this.getAttribute('overflow').getValue());\n      markerSvg.attributes.fill = new Property(this.document, 'fill', this.getAttribute('fill').getColor('black'));\n      markerSvg.attributes.stroke = new Property(this.document, 'stroke', this.getAttribute('stroke').getValue('none'));\n      markerSvg.children = this.children;\n      markerSvg.render(ctx);\n      ctx.restore();\n\n      if (markerUnits === 'strokeWidth') {\n        ctx.scale(1 / ctx.lineWidth, 1 / ctx.lineWidth);\n      }\n\n      if (orient === 'auto') {\n        ctx.rotate(-angle);\n      }\n\n      ctx.translate(-x, -y);\n    }\n  }]);\n\n  return MarkerElement;\n}(Element);\n\nfunction _createSuper$j(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$j();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$j() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar DefsElement = /*#__PURE__*/function (_Element) {\n  _inherits(DefsElement, _Element);\n\n  var _super = _createSuper$j(DefsElement);\n\n  function DefsElement() {\n    var _this;\n\n    _classCallCheck(this, DefsElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'defs';\n    return _this;\n  }\n\n  _createClass(DefsElement, [{\n    key: \"render\",\n    value: function render() {// NOOP\n    }\n  }]);\n\n  return DefsElement;\n}(Element);\n\nfunction _createSuper$k(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$k();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$k() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar GElement = /*#__PURE__*/function (_RenderedElement) {\n  _inherits(GElement, _RenderedElement);\n\n  var _super = _createSuper$k(GElement);\n\n  function GElement() {\n    var _this;\n\n    _classCallCheck(this, GElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'g';\n    return _this;\n  }\n\n  _createClass(GElement, [{\n    key: \"getBoundingBox\",\n    value: function getBoundingBox(ctx) {\n      var _context;\n\n      var boundingBox = new BoundingBox();\n\n      _forEachInstanceProperty(_context = this.children).call(_context, function (child) {\n        boundingBox.addBoundingBox(child.getBoundingBox(ctx));\n      });\n\n      return boundingBox;\n    }\n  }]);\n\n  return GElement;\n}(RenderedElement);\n\nfunction _createSuper$l(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$l();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$l() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar GradientElement = /*#__PURE__*/function (_Element) {\n  _inherits(GradientElement, _Element);\n\n  var _super = _createSuper$l(GradientElement);\n\n  function GradientElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, GradientElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.attributesToInherit = ['gradientUnits'];\n    _this.stops = [];\n\n    var _assertThisInitialize = _assertThisInitialized(_this),\n        stops = _assertThisInitialize.stops,\n        children = _assertThisInitialize.children;\n\n    _forEachInstanceProperty(children).call(children, function (child) {\n      if (child.type === 'stop') {\n        stops.push(child);\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(GradientElement, [{\n    key: \"getGradientUnits\",\n    value: function getGradientUnits() {\n      return this.getAttribute('gradientUnits').getString('objectBoundingBox');\n    }\n  }, {\n    key: \"createGradient\",\n    value: function createGradient(ctx, element, parentOpacityProp) {\n      var _this2 = this; // tslint:disable-next-line: no-this-assignment\n\n\n      var stopsContainer = this;\n\n      if (this.getHrefAttribute().hasValue()) {\n        stopsContainer = this.getHrefAttribute().getDefinition();\n        this.inheritStopContainer(stopsContainer);\n      }\n\n      var _stopsContainer = stopsContainer,\n          stops = _stopsContainer.stops;\n      var gradient = this.getGradient(ctx, element);\n\n      if (!gradient) {\n        return this.addParentOpacity(parentOpacityProp, stops[stops.length - 1].color);\n      }\n\n      _forEachInstanceProperty(stops).call(stops, function (stop) {\n        gradient.addColorStop(stop.offset, _this2.addParentOpacity(parentOpacityProp, stop.color));\n      });\n\n      if (this.getAttribute('gradientTransform').hasValue()) {\n        // render as transformed pattern on temporary canvas\n        var document = this.document;\n        var _document$screen = document.screen,\n            MAX_VIRTUAL_PIXELS = _document$screen.MAX_VIRTUAL_PIXELS,\n            viewPort = _document$screen.viewPort;\n\n        var _viewPort$viewPorts = _slicedToArray(viewPort.viewPorts, 1),\n            rootView = _viewPort$viewPorts[0];\n\n        var rect = new RectElement(document, null);\n        rect.attributes.x = new Property(document, 'x', -MAX_VIRTUAL_PIXELS / 3.0);\n        rect.attributes.y = new Property(document, 'y', -MAX_VIRTUAL_PIXELS / 3.0);\n        rect.attributes.width = new Property(document, 'width', MAX_VIRTUAL_PIXELS);\n        rect.attributes.height = new Property(document, 'height', MAX_VIRTUAL_PIXELS);\n        var group = new GElement(document, null);\n        group.attributes.transform = new Property(document, 'transform', this.getAttribute('gradientTransform').getValue());\n        group.children = [rect];\n        var patternSvg = new SVGElement(document, null);\n        patternSvg.attributes.x = new Property(document, 'x', 0);\n        patternSvg.attributes.y = new Property(document, 'y', 0);\n        patternSvg.attributes.width = new Property(document, 'width', rootView.width);\n        patternSvg.attributes.height = new Property(document, 'height', rootView.height);\n        patternSvg.children = [group];\n        var patternCanvas = document.createCanvas(rootView.width, rootView.height);\n        var patternCtx = patternCanvas.getContext('2d');\n        patternCtx.fillStyle = gradient;\n        patternSvg.render(patternCtx);\n        return patternCtx.createPattern(patternCanvas, 'no-repeat');\n      }\n\n      return gradient;\n    }\n  }, {\n    key: \"inheritStopContainer\",\n    value: function inheritStopContainer(stopsContainer) {\n      var _context,\n          _this3 = this;\n\n      _forEachInstanceProperty(_context = this.attributesToInherit).call(_context, function (attributeToInherit) {\n        if (!_this3.getAttribute(attributeToInherit).hasValue() && stopsContainer.getAttribute(attributeToInherit).hasValue()) {\n          _this3.getAttribute(attributeToInherit, true).setValue(stopsContainer.getAttribute(attributeToInherit).getValue());\n        }\n      });\n    }\n  }, {\n    key: \"addParentOpacity\",\n    value: function addParentOpacity(parentOpacityProp, color) {\n      if (parentOpacityProp.hasValue()) {\n        var colorProp = new Property(this.document, 'color', color);\n        return colorProp.addOpacity(parentOpacityProp).getColor();\n      }\n\n      return color;\n    }\n  }]);\n\n  return GradientElement;\n}(Element);\n\nfunction _createSuper$m(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$m();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$m() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar LinearGradientElement = /*#__PURE__*/function (_GradientElement) {\n  _inherits(LinearGradientElement, _GradientElement);\n\n  var _super = _createSuper$m(LinearGradientElement);\n\n  function LinearGradientElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, LinearGradientElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'linearGradient';\n\n    _this.attributesToInherit.push('x1', 'y1', 'x2', 'y2');\n\n    return _this;\n  }\n\n  _createClass(LinearGradientElement, [{\n    key: \"getGradient\",\n    value: function getGradient(ctx, element) {\n      var isBoundingBoxUnits = this.getGradientUnits() === 'objectBoundingBox';\n      var boundingBox = isBoundingBoxUnits ? element.getBoundingBox(ctx) : null;\n\n      if (isBoundingBoxUnits && !boundingBox) {\n        return null;\n      }\n\n      if (!this.getAttribute('x1').hasValue() && !this.getAttribute('y1').hasValue() && !this.getAttribute('x2').hasValue() && !this.getAttribute('y2').hasValue()) {\n        this.getAttribute('x1', true).setValue(0);\n        this.getAttribute('y1', true).setValue(0);\n        this.getAttribute('x2', true).setValue(1);\n        this.getAttribute('y2', true).setValue(0);\n      }\n\n      var x1 = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('x1').getNumber() : this.getAttribute('x1').getPixels('x');\n      var y1 = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('y1').getNumber() : this.getAttribute('y1').getPixels('y');\n      var x2 = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('x2').getNumber() : this.getAttribute('x2').getPixels('x');\n      var y2 = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('y2').getNumber() : this.getAttribute('y2').getPixels('y');\n\n      if (x1 === x2 && y1 === y2) {\n        return null;\n      }\n\n      return ctx.createLinearGradient(x1, y1, x2, y2);\n    }\n  }]);\n\n  return LinearGradientElement;\n}(GradientElement);\n\nfunction _createSuper$n(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$n();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$n() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar RadialGradientElement = /*#__PURE__*/function (_GradientElement) {\n  _inherits(RadialGradientElement, _GradientElement);\n\n  var _super = _createSuper$n(RadialGradientElement);\n\n  function RadialGradientElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, RadialGradientElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'radialGradient';\n\n    _this.attributesToInherit.push('cx', 'cy', 'r', 'fx', 'fy', 'fr');\n\n    return _this;\n  }\n\n  _createClass(RadialGradientElement, [{\n    key: \"getGradient\",\n    value: function getGradient(ctx, element) {\n      var isBoundingBoxUnits = this.getGradientUnits() === 'objectBoundingBox';\n      var boundingBox = element.getBoundingBox(ctx);\n\n      if (isBoundingBoxUnits && !boundingBox) {\n        return null;\n      }\n\n      if (!this.getAttribute('cx').hasValue()) {\n        this.getAttribute('cx', true).setValue('50%');\n      }\n\n      if (!this.getAttribute('cy').hasValue()) {\n        this.getAttribute('cy', true).setValue('50%');\n      }\n\n      if (!this.getAttribute('r').hasValue()) {\n        this.getAttribute('r', true).setValue('50%');\n      }\n\n      var cx = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('cx').getNumber() : this.getAttribute('cx').getPixels('x');\n      var cy = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('cy').getNumber() : this.getAttribute('cy').getPixels('y');\n      var fx = cx;\n      var fy = cy;\n\n      if (this.getAttribute('fx').hasValue()) {\n        fx = isBoundingBoxUnits ? boundingBox.x + boundingBox.width * this.getAttribute('fx').getNumber() : this.getAttribute('fx').getPixels('x');\n      }\n\n      if (this.getAttribute('fy').hasValue()) {\n        fy = isBoundingBoxUnits ? boundingBox.y + boundingBox.height * this.getAttribute('fy').getNumber() : this.getAttribute('fy').getPixels('y');\n      }\n\n      var r = isBoundingBoxUnits ? (boundingBox.width + boundingBox.height) / 2.0 * this.getAttribute('r').getNumber() : this.getAttribute('r').getPixels();\n      var fr = this.getAttribute('fr').getPixels();\n      return ctx.createRadialGradient(fx, fy, fr, cx, cy, r);\n    }\n  }]);\n\n  return RadialGradientElement;\n}(GradientElement);\n\nfunction _createSuper$o(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$o();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$o() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar StopElement = /*#__PURE__*/function (_Element) {\n  _inherits(StopElement, _Element);\n\n  var _super = _createSuper$o(StopElement);\n\n  function StopElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, StopElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'stop';\n    var offset = Math.max(0, Math.min(1, _this.getAttribute('offset').getNumber()));\n\n    var stopOpacity = _this.getStyle('stop-opacity');\n\n    var stopColor = _this.getStyle('stop-color', true);\n\n    if (stopColor.getString() === '') {\n      stopColor.setValue('#000');\n    }\n\n    if (stopOpacity.hasValue()) {\n      stopColor = stopColor.addOpacity(stopOpacity);\n    }\n\n    _this.offset = offset;\n    _this.color = stopColor.getColor();\n    return _this;\n  }\n\n  return StopElement;\n}(Element);\n\nfunction _createSuper$p(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$p();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$p() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar AnimateElement = /*#__PURE__*/function (_Element) {\n  _inherits(AnimateElement, _Element);\n\n  var _super = _createSuper$p(AnimateElement);\n\n  function AnimateElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, AnimateElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'animate';\n    _this.duration = 0;\n    _this.initialValue = null;\n    _this.initialUnits = '';\n    _this.removed = false;\n    _this.frozen = false;\n    document.screen.animations.push(_assertThisInitialized(_this));\n    _this.begin = _this.getAttribute('begin').getMilliseconds();\n    _this.maxDuration = _this.begin + _this.getAttribute('dur').getMilliseconds();\n    _this.from = _this.getAttribute('from');\n    _this.to = _this.getAttribute('to');\n    _this.values = _this.getAttribute('values');\n\n    if (_valuesInstanceProperty(_this).hasValue()) {\n      _valuesInstanceProperty(_this).setValue(_valuesInstanceProperty(_this).getString().split(';'));\n    }\n\n    return _this;\n  }\n\n  _createClass(AnimateElement, [{\n    key: \"getProperty\",\n    value: function getProperty() {\n      var attributeType = this.getAttribute('attributeType').getString();\n      var attributeName = this.getAttribute('attributeName').getString();\n\n      if (attributeType === 'CSS') {\n        return this.parent.getStyle(attributeName, true);\n      }\n\n      return this.parent.getAttribute(attributeName, true);\n    }\n  }, {\n    key: \"calcValue\",\n    value: function calcValue() {\n      var _context;\n\n      var initialUnits = this.initialUnits;\n\n      var _this$getProgress = this.getProgress(),\n          progress = _this$getProgress.progress,\n          from = _this$getProgress.from,\n          to = _this$getProgress.to; // tween value linearly\n\n\n      var newValue = from.getNumber() + (to.getNumber() - from.getNumber()) * progress;\n\n      if (initialUnits === '%') {\n        newValue *= 100.0; // numValue() returns 0-1 whereas properties are 0-100\n      }\n\n      return _concatInstanceProperty(_context = \"\".concat(newValue)).call(_context, initialUnits);\n    }\n  }, {\n    key: \"update\",\n    value: function update(delta) {\n      var parent = this.parent;\n      var prop = this.getProperty(); // set initial value\n\n      if (!this.initialValue) {\n        this.initialValue = prop.getString();\n        this.initialUnits = prop.getUnits();\n      } // if we're past the end time\n\n\n      if (this.duration > this.maxDuration) {\n        var fill = this.getAttribute('fill').getString('remove'); // loop for indefinitely repeating animations\n\n        if (this.getAttribute('repeatCount').getString() === 'indefinite' || this.getAttribute('repeatDur').getString() === 'indefinite') {\n          this.duration = 0;\n        } else if (fill === 'freeze' && !this.frozen) {\n          this.frozen = true;\n          parent.animationFrozen = true;\n          parent.animationFrozenValue = prop.getString();\n        } else if (fill === 'remove' && !this.removed) {\n          this.removed = true;\n          prop.setValue(parent.animationFrozen ? parent.animationFrozenValue : this.initialValue);\n          return true;\n        }\n\n        return false;\n      }\n\n      this.duration += delta; // if we're past the begin time\n\n      var updated = false;\n\n      if (this.begin < this.duration) {\n        var newValue = this.calcValue(); // tween\n\n        var typeAttr = this.getAttribute('type');\n\n        if (typeAttr.hasValue()) {\n          var _context2; // for transform, etc.\n\n\n          var type = typeAttr.getString();\n          newValue = _concatInstanceProperty(_context2 = \"\".concat(type, \"(\")).call(_context2, newValue, \")\");\n        }\n\n        prop.setValue(newValue);\n        updated = true;\n      }\n\n      return updated;\n    }\n  }, {\n    key: \"getProgress\",\n    value: function getProgress() {\n      var document = this.document,\n          values = _valuesInstanceProperty(this);\n\n      var result = {\n        progress: (this.duration - this.begin) / (this.maxDuration - this.begin)\n      };\n\n      if (values.hasValue()) {\n        var p = result.progress * (values.getValue().length - 1);\n        var lb = Math.floor(p);\n        var ub = Math.ceil(p);\n        result.from = new Property(document, 'from', _parseFloat(values.getValue()[lb]));\n        result.to = new Property(document, 'to', _parseFloat(values.getValue()[ub]));\n        result.progress = (p - lb) / (ub - lb);\n      } else {\n        result.from = this.from;\n        result.to = this.to;\n      }\n\n      return result;\n    }\n  }]);\n\n  return AnimateElement;\n}(Element);\n\nfunction _createSuper$q(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$q();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$q() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar AnimateColorElement = /*#__PURE__*/function (_AnimateElement) {\n  _inherits(AnimateColorElement, _AnimateElement);\n\n  var _super = _createSuper$q(AnimateColorElement);\n\n  function AnimateColorElement() {\n    var _this;\n\n    _classCallCheck(this, AnimateColorElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'animateColor';\n    return _this;\n  }\n\n  _createClass(AnimateColorElement, [{\n    key: \"calcValue\",\n    value: function calcValue() {\n      var _this$getProgress = this.getProgress(),\n          progress = _this$getProgress.progress,\n          from = _this$getProgress.from,\n          to = _this$getProgress.to;\n\n      var colorFrom = new RGBColor(from.getColor());\n      var colorTo = new RGBColor(to.getColor());\n\n      if (colorFrom.ok && colorTo.ok) {\n        var _context, _context2; // tween color linearly\n\n\n        var r = colorFrom.r + (colorTo.r - colorFrom.r) * progress;\n        var g = colorFrom.g + (colorTo.g - colorFrom.g) * progress;\n        var b = colorFrom.b + (colorTo.b - colorFrom.b) * progress; // ? alpha\n\n        return _concatInstanceProperty(_context = _concatInstanceProperty(_context2 = \"rgb(\".concat(_parseInt(r, 10), \", \")).call(_context2, _parseInt(g, 10), \", \")).call(_context, _parseInt(b, 10), \")\");\n      }\n\n      return this.getAttribute('from').getColor();\n    }\n  }]);\n\n  return AnimateColorElement;\n}(AnimateElement);\n\nfunction _createSuper$r(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$r();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$r() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar AnimateTransformElement = /*#__PURE__*/function (_AnimateElement) {\n  _inherits(AnimateTransformElement, _AnimateElement);\n\n  var _super = _createSuper$r(AnimateTransformElement);\n\n  function AnimateTransformElement() {\n    var _this;\n\n    _classCallCheck(this, AnimateTransformElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'animateTransform';\n    return _this;\n  }\n\n  _createClass(AnimateTransformElement, [{\n    key: \"calcValue\",\n    value: function calcValue() {\n      var _this$getProgress = this.getProgress(),\n          progress = _this$getProgress.progress,\n          from = _this$getProgress.from,\n          to = _this$getProgress.to; // tween value linearly\n\n\n      var transformFrom = toNumbers(from.getString());\n      var transformTo = toNumbers(to.getString());\n\n      var newValue = _mapInstanceProperty(transformFrom).call(transformFrom, function (from, i) {\n        var to = transformTo[i];\n        return from + (to - from) * progress;\n      }).join(' ');\n\n      return newValue;\n    }\n  }]);\n\n  return AnimateTransformElement;\n}(AnimateElement);\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof _Symbol === \"undefined\" || _getIteratorMethod(o) == null) {\n    if (_Array$isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = _getIterator(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  var _context;\n\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n\n  var n = _sliceInstanceProperty(_context = Object.prototype.toString.call(o)).call(_context, 8, -1);\n\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return _Array$from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _createSuper$s(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$s();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$s() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar FontElement = /*#__PURE__*/function (_Element) {\n  _inherits(FontElement, _Element);\n\n  var _super = _createSuper$s(FontElement);\n\n  function FontElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, FontElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'font';\n    _this.glyphs = {};\n    _this.horizAdvX = _this.getAttribute('horiz-adv-x').getNumber();\n    var definitions = document.definitions;\n\n    var _assertThisInitialize = _assertThisInitialized(_this),\n        children = _assertThisInitialize.children;\n\n    var _iterator = _createForOfIteratorHelper(children),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var child = _step.value;\n\n        switch (child.type) {\n          case 'font-face':\n            {\n              _this.fontFace = child;\n              var fontFamilyStyle = child.getStyle('font-family');\n\n              if (fontFamilyStyle.hasValue()) {\n                definitions[fontFamilyStyle.getString()] = _assertThisInitialized(_this);\n              }\n\n              break;\n            }\n\n          case 'missing-glyph':\n            _this.missingGlyph = child;\n            break;\n\n          case 'glyph':\n            {\n              var glyph = child;\n\n              if (glyph.arabicForm) {\n                _this.isRTL = true;\n                _this.isArabic = true;\n\n                if (typeof _this.glyphs[glyph.unicode] === 'undefined') {\n                  _this.glyphs[glyph.unicode] = {};\n                }\n\n                _this.glyphs[glyph.unicode][glyph.arabicForm] = glyph;\n              } else {\n                _this.glyphs[glyph.unicode] = glyph;\n              }\n\n              break;\n            }\n\n          default:\n        }\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    return _this;\n  }\n\n  _createClass(FontElement, [{\n    key: \"render\",\n    value: function render() {// NO RENDER\n    }\n  }]);\n\n  return FontElement;\n}(Element);\n\nfunction _createSuper$t(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$t();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$t() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar FontFaceElement = /*#__PURE__*/function (_Element) {\n  _inherits(FontFaceElement, _Element);\n\n  var _super = _createSuper$t(FontFaceElement);\n\n  function FontFaceElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, FontFaceElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'font-face';\n    _this.ascent = _this.getAttribute('ascent').getNumber();\n    _this.descent = _this.getAttribute('descent').getNumber();\n    _this.unitsPerEm = _this.getAttribute('units-per-em').getNumber();\n    return _this;\n  }\n\n  return FontFaceElement;\n}(Element);\n\nfunction _createSuper$u(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$u();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$u() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar MissingGlyphElement = /*#__PURE__*/function (_PathElement) {\n  _inherits(MissingGlyphElement, _PathElement);\n\n  var _super = _createSuper$u(MissingGlyphElement);\n\n  function MissingGlyphElement() {\n    var _this;\n\n    _classCallCheck(this, MissingGlyphElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'missing-glyph';\n    _this.horizAdvX = 0;\n    return _this;\n  }\n\n  return MissingGlyphElement;\n}(PathElement);\n\nfunction _createSuper$v(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$v();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$v() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar GlyphElement = /*#__PURE__*/function (_PathElement) {\n  _inherits(GlyphElement, _PathElement);\n\n  var _super = _createSuper$v(GlyphElement);\n\n  function GlyphElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, GlyphElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'glyph';\n    _this.horizAdvX = _this.getAttribute('horiz-adv-x').getNumber();\n    _this.unicode = _this.getAttribute('unicode').getString();\n    _this.arabicForm = _this.getAttribute('arabic-form').getString();\n    return _this;\n  }\n\n  return GlyphElement;\n}(PathElement);\n\nfunction _createSuper$w(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$w();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$w() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar TRefElement = /*#__PURE__*/function (_TextElement) {\n  _inherits(TRefElement, _TextElement);\n\n  var _super = _createSuper$w(TRefElement);\n\n  function TRefElement() {\n    var _this;\n\n    _classCallCheck(this, TRefElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'tref';\n    return _this;\n  }\n\n  _createClass(TRefElement, [{\n    key: \"getText\",\n    value: function getText() {\n      var element = this.getHrefAttribute().getDefinition();\n\n      if (element) {\n        var firstChild = element.children[0];\n\n        if (firstChild) {\n          return firstChild.getText();\n        }\n      }\n\n      return '';\n    }\n  }]);\n\n  return TRefElement;\n}(TextElement);\n\nfunction _createSuper$x(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$x();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$x() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar AElement = /*#__PURE__*/function (_TextElement) {\n  _inherits(AElement, _TextElement);\n\n  var _super = _createSuper$x(AElement);\n\n  function AElement(document, node, captureTextNodes) {\n    var _context;\n\n    var _this;\n\n    _classCallCheck(this, AElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'a';\n    var childNodes = node.childNodes;\n    var firstChild = childNodes[0];\n\n    var hasText = childNodes.length > 0 && _everyInstanceProperty(_context = _Array$from(childNodes)).call(_context, function (node) {\n      return node.nodeType === 3;\n    });\n\n    _this.hasText = hasText;\n    _this.text = hasText ? _this.getTextFromNode(firstChild) : '';\n    return _this;\n  }\n\n  _createClass(AElement, [{\n    key: \"getText\",\n    value: function getText() {\n      return this.text;\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      if (this.hasText) {\n        // render as text element\n        _get(_getPrototypeOf(AElement.prototype), \"renderChildren\", this).call(this, ctx);\n\n        var document = this.document,\n            x = this.x,\n            y = this.y;\n        var mouse = document.screen.mouse;\n        var fontSize = new Property(document, 'fontSize', Font.parse(document.ctx.font).fontSize); // Do not calc bounding box if mouse is not working.\n\n        if (mouse.isWorking()) {\n          mouse.checkBoundingBox(this, new BoundingBox(x, y - fontSize.getPixels('y'), x + this.measureText(ctx), y));\n        }\n      } else if (this.children.length > 0) {\n        // render as temporary group\n        var g = new GElement(this.document, null);\n        g.children = this.children;\n        g.parent = this;\n        g.render(ctx);\n      }\n    }\n  }, {\n    key: \"onClick\",\n    value: function onClick() {\n      var window = this.document.window;\n\n      if (window) {\n        window.open(this.getHrefAttribute().getString());\n      }\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove() {\n      var ctx = this.document.ctx;\n      ctx.canvas.style.cursor = 'pointer';\n    }\n  }]);\n\n  return AElement;\n}(TextElement);\n\nfunction _createForOfIteratorHelper$1(o, allowArrayLike) {\n  var it;\n\n  if (typeof _Symbol === \"undefined\" || _getIteratorMethod(o) == null) {\n    if (_Array$isArray(o) || (it = _unsupportedIterableToArray$1(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = _getIterator(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction _unsupportedIterableToArray$1(o, minLen) {\n  var _context5;\n\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray$1(o, minLen);\n\n  var n = _sliceInstanceProperty(_context5 = Object.prototype.toString.call(o)).call(_context5, 8, -1);\n\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return _Array$from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray$1(o, minLen);\n}\n\nfunction _arrayLikeToArray$1(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n\n    if (enumerableOnly) symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      var _context3;\n\n      _forEachInstanceProperty(_context3 = ownKeys(Object(source), true)).call(_context3, function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (_Object$getOwnPropertyDescriptors) {\n      _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source));\n    } else {\n      var _context4;\n\n      _forEachInstanceProperty(_context4 = ownKeys(Object(source))).call(_context4, function (key) {\n        _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _createSuper$y(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$y();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$y() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar TextPathElement = /*#__PURE__*/function (_TextElement) {\n  _inherits(TextPathElement, _TextElement);\n\n  var _super = _createSuper$y(TextPathElement);\n\n  function TextPathElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, TextPathElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'textPath';\n    _this.textWidth = 0;\n    _this.textHeight = 0;\n    _this.pathLength = -1;\n    _this.glyphInfo = null;\n    _this.letterSpacingCache = [];\n    _this.measuresCache = new _Map([['', 0]]);\n\n    var pathElement = _this.getHrefAttribute().getDefinition();\n\n    _this.text = _this.getTextFromNode();\n    _this.dataArray = _this.parsePathData(pathElement);\n    return _this;\n  }\n\n  _createClass(TextPathElement, [{\n    key: \"getText\",\n    value: function getText() {\n      return this.text;\n    }\n  }, {\n    key: \"path\",\n    value: function path(ctx) {\n      var dataArray = this.dataArray;\n\n      if (ctx) {\n        ctx.beginPath();\n      }\n\n      _forEachInstanceProperty(dataArray).call(dataArray, function (_ref) {\n        var type = _ref.type,\n            points = _ref.points;\n\n        switch (type) {\n          case PathParser.LINE_TO:\n            if (ctx) {\n              ctx.lineTo(points[0], points[1]);\n            }\n\n            break;\n\n          case PathParser.MOVE_TO:\n            if (ctx) {\n              ctx.moveTo(points[0], points[1]);\n            }\n\n            break;\n\n          case PathParser.CURVE_TO:\n            if (ctx) {\n              ctx.bezierCurveTo(points[0], points[1], points[2], points[3], points[4], points[5]);\n            }\n\n            break;\n\n          case PathParser.QUAD_TO:\n            if (ctx) {\n              ctx.quadraticCurveTo(points[0], points[1], points[2], points[3]);\n            }\n\n            break;\n\n          case PathParser.ARC:\n            {\n              var _points = _slicedToArray(points, 8),\n                  cx = _points[0],\n                  cy = _points[1],\n                  rx = _points[2],\n                  ry = _points[3],\n                  theta = _points[4],\n                  dTheta = _points[5],\n                  psi = _points[6],\n                  fs = _points[7];\n\n              var r = rx > ry ? rx : ry;\n              var scaleX = rx > ry ? 1 : rx / ry;\n              var scaleY = rx > ry ? ry / rx : 1;\n\n              if (ctx) {\n                ctx.translate(cx, cy);\n                ctx.rotate(psi);\n                ctx.scale(scaleX, scaleY);\n                ctx.arc(0, 0, r, theta, theta + dTheta, Boolean(1 - fs));\n                ctx.scale(1 / scaleX, 1 / scaleY);\n                ctx.rotate(-psi);\n                ctx.translate(-cx, -cy);\n              }\n\n              break;\n            }\n\n          case PathParser.CLOSE_PATH:\n            if (ctx) {\n              ctx.closePath();\n            }\n\n            break;\n        }\n      });\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      this.setTextData(ctx);\n      ctx.save();\n      var textDecoration = this.parent.getStyle('text-decoration').getString();\n      var fontSize = this.getFontSize();\n      var glyphInfo = this.glyphInfo;\n      var fill = ctx.fillStyle;\n\n      if (textDecoration === 'underline') {\n        ctx.beginPath();\n      }\n\n      _forEachInstanceProperty(glyphInfo).call(glyphInfo, function (glyph, i) {\n        var p0 = glyph.p0,\n            p1 = glyph.p1,\n            rotation = glyph.rotation,\n            partialText = glyph.text;\n        ctx.save();\n        ctx.translate(p0.x, p0.y);\n        ctx.rotate(rotation);\n\n        if (ctx.fillStyle) {\n          ctx.fillText(partialText, 0, 0);\n        }\n\n        if (ctx.strokeStyle) {\n          ctx.strokeText(partialText, 0, 0);\n        }\n\n        ctx.restore();\n\n        if (textDecoration === 'underline') {\n          if (i === 0) {\n            ctx.moveTo(p0.x, p0.y + fontSize / 8);\n          }\n\n          ctx.lineTo(p1.x, p1.y + fontSize / 5);\n        } //// To assist with debugging visually, uncomment following\n        //\n        // ctx.beginPath();\n        // if (i % 2)\n        // \tctx.strokeStyle = 'red';\n        // else\n        // \tctx.strokeStyle = 'green';\n        // ctx.moveTo(p0.x, p0.y);\n        // ctx.lineTo(p1.x, p1.y);\n        // ctx.stroke();\n        // ctx.closePath();\n\n      });\n\n      if (textDecoration === 'underline') {\n        ctx.lineWidth = fontSize / 20;\n        ctx.strokeStyle = fill;\n        ctx.stroke();\n        ctx.closePath();\n      }\n\n      ctx.restore();\n    }\n  }, {\n    key: \"getLetterSpacingAt\",\n    value: function getLetterSpacingAt() {\n      var idx = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      return this.letterSpacingCache[idx] || 0;\n    }\n  }, {\n    key: \"findSegmentToFitChar\",\n    value: function findSegmentToFitChar(ctx, anchor, textFullWidth, fullPathWidth, spacesNumber, inputOffset, dy, c, charI) {\n      var offset = inputOffset;\n      var glyphWidth = this.measureText(ctx, c);\n\n      if (c === ' ' && anchor === 'justify' && textFullWidth < fullPathWidth) {\n        glyphWidth += (fullPathWidth - textFullWidth) / spacesNumber;\n      }\n\n      if (charI > -1) {\n        offset += this.getLetterSpacingAt(charI);\n      }\n\n      var splineStep = this.textHeight / 20;\n      var p0 = this.getEquidistantPointOnPath(offset, splineStep, 0);\n      var p1 = this.getEquidistantPointOnPath(offset + glyphWidth, splineStep, 0);\n      var segment = {\n        p0: p0,\n        p1: p1\n      };\n      var rotation = p0 && p1 ? Math.atan2(p1.y - p0.y, p1.x - p0.x) : 0;\n\n      if (dy) {\n        var dyX = Math.cos(Math.PI / 2 + rotation) * dy;\n        var dyY = Math.cos(-rotation) * dy;\n        segment.p0 = _objectSpread(_objectSpread({}, p0), {}, {\n          x: p0.x + dyX,\n          y: p0.y + dyY\n        });\n        segment.p1 = _objectSpread(_objectSpread({}, p1), {}, {\n          x: p1.x + dyX,\n          y: p1.y + dyY\n        });\n      }\n\n      offset += glyphWidth;\n      return {\n        offset: offset,\n        segment: segment,\n        rotation: rotation\n      };\n    }\n  }, {\n    key: \"measureText\",\n    value: function measureText(ctx, text) {\n      var measuresCache = this.measuresCache;\n      var targetText = text || this.getText();\n\n      if (measuresCache.has(targetText)) {\n        return measuresCache.get(targetText);\n      }\n\n      var measure = this.measureTargetText(ctx, targetText);\n      measuresCache.set(targetText, measure);\n      return measure;\n    } // This method supposes what all custom fonts already loaded.\n    // If some font will be loaded after this method call, <textPath> will not be rendered correctly.\n    // You need to call this method manually to update glyphs cache.\n\n  }, {\n    key: \"setTextData\",\n    value: function setTextData(ctx) {\n      var _context,\n          _this2 = this;\n\n      if (this.glyphInfo) {\n        return;\n      }\n\n      var renderText = this.getText();\n      var chars = renderText.split('');\n      var spacesNumber = renderText.split(' ').length - 1;\n\n      var dx = _mapInstanceProperty(_context = this.parent.getAttribute('dx').split()).call(_context, function (_) {\n        return _.getPixels('x');\n      });\n\n      var dy = this.parent.getAttribute('dy').getPixels('y');\n      var anchor = this.parent.getStyle('text-anchor').getString('start');\n      var thisSpacing = this.getStyle('letter-spacing');\n      var parentSpacing = this.parent.getStyle('letter-spacing');\n      var letterSpacing = 0;\n\n      if (!thisSpacing.hasValue() || thisSpacing.getValue() === 'inherit') {\n        letterSpacing = parentSpacing.getPixels();\n      } else if (thisSpacing.hasValue()) {\n        if (thisSpacing.getValue() !== 'initial' && thisSpacing.getValue() !== 'unset') {\n          letterSpacing = thisSpacing.getPixels();\n        }\n      } // fill letter-spacing cache\n\n\n      var letterSpacingCache = [];\n      var textLen = renderText.length;\n      this.letterSpacingCache = letterSpacingCache;\n\n      for (var i = 0; i < textLen; i++) {\n        letterSpacingCache.push(typeof dx[i] !== 'undefined' ? dx[i] : letterSpacing);\n      }\n\n      var dxSum = _reduceInstanceProperty(letterSpacingCache).call(letterSpacingCache, function (acc, cur, i) {\n        return i === 0 ? 0 : acc + cur || 0;\n      }, 0);\n\n      var textWidth = this.measureText(ctx);\n      var textFullWidth = Math.max(textWidth + dxSum, 0);\n      this.textWidth = textWidth;\n      this.textHeight = this.getFontSize();\n      this.glyphInfo = [];\n      var fullPathWidth = this.getPathLength();\n      var startOffset = this.getStyle('startOffset').getNumber(0) * fullPathWidth;\n      var offset = 0;\n\n      if (anchor === 'middle' || anchor === 'center') {\n        offset = -textFullWidth / 2;\n      }\n\n      if (anchor === 'end' || anchor === 'right') {\n        offset = -textFullWidth;\n      }\n\n      offset += startOffset;\n\n      _forEachInstanceProperty(chars).call(chars, function (char, i) {\n        // Find such segment what distance between p0 and p1 is approx. width of glyph\n        var _this2$findSegmentToF = _this2.findSegmentToFitChar(ctx, anchor, textFullWidth, fullPathWidth, spacesNumber, offset, dy, char, i),\n            nextOffset = _this2$findSegmentToF.offset,\n            segment = _this2$findSegmentToF.segment,\n            rotation = _this2$findSegmentToF.rotation;\n\n        offset = nextOffset;\n\n        if (!segment.p0 || !segment.p1) {\n          return;\n        } // const width = this.getLineLength(\n        // \tsegment.p0.x,\n        // \tsegment.p0.y,\n        // \tsegment.p1.x,\n        // \tsegment.p1.y\n        // );\n        // Note: Since glyphs are rendered one at a time, any kerning pair data built into the font will not be used.\n        // Can foresee having a rough pair table built in that the developer can override as needed.\n        // Or use \"dx\" attribute of the <text> node as a naive replacement\n        // const kern = 0;\n        // placeholder for future implementation\n        // const midpoint = this.getPointOnLine(\n        // \tkern + width / 2.0,\n        // \tsegment.p0.x, segment.p0.y, segment.p1.x, segment.p1.y\n        // );\n\n\n        _this2.glyphInfo.push({\n          // transposeX: midpoint.x,\n          // transposeY: midpoint.y,\n          text: chars[i],\n          p0: segment.p0,\n          p1: segment.p1,\n          rotation: rotation\n        });\n      });\n    }\n  }, {\n    key: \"parsePathData\",\n    value: function parsePathData(path) {\n      this.pathLength = -1; // reset path length\n\n      if (!path) {\n        return [];\n      }\n\n      var pathCommands = [];\n      var pathParser = path.pathParser;\n      pathParser.reset(); // convert l, H, h, V, and v to L\n\n      while (!pathParser.isEnd()) {\n        var current = pathParser.current;\n        var startX = current ? current.x : 0;\n        var startY = current ? current.y : 0;\n        var command = pathParser.next();\n        var nextCommandType = command.type;\n        var points = [];\n\n        switch (command.type) {\n          case PathParser.MOVE_TO:\n            this.pathM(pathParser, points);\n            break;\n\n          case PathParser.LINE_TO:\n            nextCommandType = this.pathL(pathParser, points);\n            break;\n\n          case PathParser.HORIZ_LINE_TO:\n            nextCommandType = this.pathH(pathParser, points);\n            break;\n\n          case PathParser.VERT_LINE_TO:\n            nextCommandType = this.pathV(pathParser, points);\n            break;\n\n          case PathParser.CURVE_TO:\n            this.pathC(pathParser, points);\n            break;\n\n          case PathParser.SMOOTH_CURVE_TO:\n            nextCommandType = this.pathS(pathParser, points);\n            break;\n\n          case PathParser.QUAD_TO:\n            this.pathQ(pathParser, points);\n            break;\n\n          case PathParser.SMOOTH_QUAD_TO:\n            nextCommandType = this.pathT(pathParser, points);\n            break;\n\n          case PathParser.ARC:\n            points = this.pathA(pathParser);\n            break;\n\n          case PathParser.CLOSE_PATH:\n            PathElement.pathZ(pathParser);\n            break;\n        }\n\n        if (command.type !== PathParser.CLOSE_PATH) {\n          pathCommands.push({\n            type: nextCommandType,\n            points: points,\n            start: {\n              x: startX,\n              y: startY\n            },\n            pathLength: this.calcLength(startX, startY, nextCommandType, points)\n          });\n        } else {\n          pathCommands.push({\n            type: PathParser.CLOSE_PATH,\n            points: [],\n            pathLength: 0\n          });\n        }\n      }\n\n      return pathCommands;\n    }\n  }, {\n    key: \"pathM\",\n    value: function pathM(pathParser, points) {\n      var _PathElement$pathM$po = PathElement.pathM(pathParser).point,\n          x = _PathElement$pathM$po.x,\n          y = _PathElement$pathM$po.y;\n      points.push(x, y);\n    }\n  }, {\n    key: \"pathL\",\n    value: function pathL(pathParser, points) {\n      var _PathElement$pathL$po = PathElement.pathL(pathParser).point,\n          x = _PathElement$pathL$po.x,\n          y = _PathElement$pathL$po.y;\n      points.push(x, y);\n      return PathParser.LINE_TO;\n    }\n  }, {\n    key: \"pathH\",\n    value: function pathH(pathParser, points) {\n      var _PathElement$pathH$po = PathElement.pathH(pathParser).point,\n          x = _PathElement$pathH$po.x,\n          y = _PathElement$pathH$po.y;\n      points.push(x, y);\n      return PathParser.LINE_TO;\n    }\n  }, {\n    key: \"pathV\",\n    value: function pathV(pathParser, points) {\n      var _PathElement$pathV$po = PathElement.pathV(pathParser).point,\n          x = _PathElement$pathV$po.x,\n          y = _PathElement$pathV$po.y;\n      points.push(x, y);\n      return PathParser.LINE_TO;\n    }\n  }, {\n    key: \"pathC\",\n    value: function pathC(pathParser, points) {\n      var _PathElement$pathC = PathElement.pathC(pathParser),\n          point = _PathElement$pathC.point,\n          controlPoint = _PathElement$pathC.controlPoint,\n          currentPoint = _PathElement$pathC.currentPoint;\n\n      points.push(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    }\n  }, {\n    key: \"pathS\",\n    value: function pathS(pathParser, points) {\n      var _PathElement$pathS = PathElement.pathS(pathParser),\n          point = _PathElement$pathS.point,\n          controlPoint = _PathElement$pathS.controlPoint,\n          currentPoint = _PathElement$pathS.currentPoint;\n\n      points.push(point.x, point.y, controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      return PathParser.CURVE_TO;\n    }\n  }, {\n    key: \"pathQ\",\n    value: function pathQ(pathParser, points) {\n      var _PathElement$pathQ = PathElement.pathQ(pathParser),\n          controlPoint = _PathElement$pathQ.controlPoint,\n          currentPoint = _PathElement$pathQ.currentPoint;\n\n      points.push(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n    }\n  }, {\n    key: \"pathT\",\n    value: function pathT(pathParser, points) {\n      var _PathElement$pathT = PathElement.pathT(pathParser),\n          controlPoint = _PathElement$pathT.controlPoint,\n          currentPoint = _PathElement$pathT.currentPoint;\n\n      points.push(controlPoint.x, controlPoint.y, currentPoint.x, currentPoint.y);\n      return PathParser.QUAD_TO;\n    }\n  }, {\n    key: \"pathA\",\n    value: function pathA(pathParser) {\n      var _PathElement$pathA = PathElement.pathA(pathParser),\n          rX = _PathElement$pathA.rX,\n          rY = _PathElement$pathA.rY,\n          sweepFlag = _PathElement$pathA.sweepFlag,\n          xAxisRotation = _PathElement$pathA.xAxisRotation,\n          centp = _PathElement$pathA.centp,\n          a1 = _PathElement$pathA.a1,\n          ad = _PathElement$pathA.ad;\n\n      if (sweepFlag === 0 && ad > 0) {\n        ad = ad - 2 * Math.PI;\n      }\n\n      if (sweepFlag === 1 && ad < 0) {\n        ad = ad + 2 * Math.PI;\n      }\n\n      return [centp.x, centp.y, rX, rY, a1, ad, xAxisRotation, sweepFlag];\n    }\n  }, {\n    key: \"calcLength\",\n    value: function calcLength(x, y, commandType, points) {\n      var len = 0;\n      var p1 = null;\n      var p2 = null;\n      var t = 0;\n\n      switch (commandType) {\n        case PathParser.LINE_TO:\n          return this.getLineLength(x, y, points[0], points[1]);\n\n        case PathParser.CURVE_TO:\n          // Approximates by breaking curve into 100 line segments\n          len = 0.0;\n          p1 = this.getPointOnCubicBezier(0, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n\n          for (t = 0.01; t <= 1; t += 0.01) {\n            p2 = this.getPointOnCubicBezier(t, x, y, points[0], points[1], points[2], points[3], points[4], points[5]);\n            len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n            p1 = p2;\n          }\n\n          return len;\n\n        case PathParser.QUAD_TO:\n          // Approximates by breaking curve into 100 line segments\n          len = 0.0;\n          p1 = this.getPointOnQuadraticBezier(0, x, y, points[0], points[1], points[2], points[3]);\n\n          for (t = 0.01; t <= 1; t += 0.01) {\n            p2 = this.getPointOnQuadraticBezier(t, x, y, points[0], points[1], points[2], points[3]);\n            len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n            p1 = p2;\n          }\n\n          return len;\n\n        case PathParser.ARC:\n          // Approximates by breaking curve into line segments\n          len = 0.0;\n          var start = points[4]; // 4 = theta\n\n          var dTheta = points[5]; // 5 = dTheta\n\n          var end = points[4] + dTheta;\n          var inc = Math.PI / 180.0; // 1 degree resolution\n\n          if (Math.abs(start - end) < inc) {\n            inc = Math.abs(start - end);\n          } // Note: for purpose of calculating arc length, not going to worry about rotating X-axis by angle psi\n\n\n          p1 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], start, 0);\n\n          if (dTheta < 0) {\n            // clockwise\n            for (t = start - inc; t > end; t -= inc) {\n              p2 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n              len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n              p1 = p2;\n            }\n          } else {\n            // counter-clockwise\n            for (t = start + inc; t < end; t += inc) {\n              p2 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], t, 0);\n              len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n              p1 = p2;\n            }\n          }\n\n          p2 = this.getPointOnEllipticalArc(points[0], points[1], points[2], points[3], end, 0);\n          len += this.getLineLength(p1.x, p1.y, p2.x, p2.y);\n          return len;\n      }\n\n      return 0;\n    }\n  }, {\n    key: \"getPointOnLine\",\n    value: function getPointOnLine(dist, P1x, P1y, P2x, P2y) {\n      var fromX = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : P1x;\n      var fromY = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : P1y;\n      var m = (P2y - P1y) / (P2x - P1x + PSEUDO_ZERO);\n      var run = Math.sqrt(dist * dist / (1 + m * m));\n\n      if (P2x < P1x) {\n        run *= -1;\n      }\n\n      var rise = m * run;\n      var pt = null;\n\n      if (P2x === P1x) {\n        // vertical line\n        pt = {\n          x: fromX,\n          y: fromY + rise\n        };\n      } else if ((fromY - P1y) / (fromX - P1x + PSEUDO_ZERO) === m) {\n        pt = {\n          x: fromX + run,\n          y: fromY + rise\n        };\n      } else {\n        var ix = 0;\n        var iy = 0;\n        var len = this.getLineLength(P1x, P1y, P2x, P2y);\n\n        if (len < PSEUDO_ZERO) {\n          return null;\n        }\n\n        var u = (fromX - P1x) * (P2x - P1x) + (fromY - P1y) * (P2y - P1y);\n        u = u / (len * len);\n        ix = P1x + u * (P2x - P1x);\n        iy = P1y + u * (P2y - P1y);\n        var pRise = this.getLineLength(fromX, fromY, ix, iy);\n        var pRun = Math.sqrt(dist * dist - pRise * pRise);\n        run = Math.sqrt(pRun * pRun / (1 + m * m));\n\n        if (P2x < P1x) {\n          run *= -1;\n        }\n\n        rise = m * run;\n        pt = {\n          x: ix + run,\n          y: iy + rise\n        };\n      }\n\n      return pt;\n    }\n  }, {\n    key: \"getPointOnPath\",\n    value: function getPointOnPath(distance) {\n      var fullLen = this.getPathLength();\n      var cumulativePathLength = 0;\n      var p = null;\n\n      if (distance < -0.00005 || distance - 0.00005 > fullLen) {\n        return null;\n      }\n\n      var dataArray = this.dataArray;\n\n      var _iterator = _createForOfIteratorHelper$1(dataArray),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var command = _step.value;\n\n          if (command && (command.pathLength < 0.00005 || cumulativePathLength + command.pathLength + 0.00005 < distance)) {\n            cumulativePathLength += command.pathLength;\n            continue;\n          }\n\n          var delta = distance - cumulativePathLength;\n          var currentT = 0;\n\n          switch (command.type) {\n            case PathParser.LINE_TO:\n              p = this.getPointOnLine(delta, command.start.x, command.start.y, command.points[0], command.points[1], command.start.x, command.start.y);\n              break;\n\n            case PathParser.ARC:\n              var start = command.points[4]; // 4 = theta\n\n              var dTheta = command.points[5]; // 5 = dTheta\n\n              var end = command.points[4] + dTheta;\n              currentT = start + delta / command.pathLength * dTheta;\n\n              if (dTheta < 0 && currentT < end || dTheta >= 0 && currentT > end) {\n                break;\n              }\n\n              p = this.getPointOnEllipticalArc(command.points[0], command.points[1], command.points[2], command.points[3], currentT, command.points[6]);\n              break;\n\n            case PathParser.CURVE_TO:\n              currentT = delta / command.pathLength;\n\n              if (currentT > 1) {\n                currentT = 1;\n              }\n\n              p = this.getPointOnCubicBezier(currentT, command.start.x, command.start.y, command.points[0], command.points[1], command.points[2], command.points[3], command.points[4], command.points[5]);\n              break;\n\n            case PathParser.QUAD_TO:\n              currentT = delta / command.pathLength;\n\n              if (currentT > 1) {\n                currentT = 1;\n              }\n\n              p = this.getPointOnQuadraticBezier(currentT, command.start.x, command.start.y, command.points[0], command.points[1], command.points[2], command.points[3]);\n              break;\n\n            default:\n          }\n\n          if (p) {\n            return p;\n          }\n\n          break;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return null;\n    }\n  }, {\n    key: \"getLineLength\",\n    value: function getLineLength(x1, y1, x2, y2) {\n      return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n    }\n  }, {\n    key: \"getPathLength\",\n    value: function getPathLength() {\n      if (this.pathLength === -1) {\n        var _context2;\n\n        this.pathLength = _reduceInstanceProperty(_context2 = this.dataArray).call(_context2, function (length, command) {\n          return command.pathLength > 0 ? length + command.pathLength : length;\n        }, 0);\n      }\n\n      return this.pathLength;\n    }\n  }, {\n    key: \"getPointOnCubicBezier\",\n    value: function getPointOnCubicBezier(pct, P1x, P1y, P2x, P2y, P3x, P3y, P4x, P4y) {\n      var x = P4x * CB1(pct) + P3x * CB2(pct) + P2x * CB3(pct) + P1x * CB4(pct);\n      var y = P4y * CB1(pct) + P3y * CB2(pct) + P2y * CB3(pct) + P1y * CB4(pct);\n      return {\n        x: x,\n        y: y\n      };\n    }\n  }, {\n    key: \"getPointOnQuadraticBezier\",\n    value: function getPointOnQuadraticBezier(pct, P1x, P1y, P2x, P2y, P3x, P3y) {\n      var x = P3x * QB1(pct) + P2x * QB2(pct) + P1x * QB3(pct);\n      var y = P3y * QB1(pct) + P2y * QB2(pct) + P1y * QB3(pct);\n      return {\n        x: x,\n        y: y\n      };\n    }\n  }, {\n    key: \"getPointOnEllipticalArc\",\n    value: function getPointOnEllipticalArc(cx, cy, rx, ry, theta, psi) {\n      var cosPsi = Math.cos(psi);\n      var sinPsi = Math.sin(psi);\n      var pt = {\n        x: rx * Math.cos(theta),\n        y: ry * Math.sin(theta)\n      };\n      return {\n        x: cx + (pt.x * cosPsi - pt.y * sinPsi),\n        y: cy + (pt.x * sinPsi + pt.y * cosPsi)\n      };\n    } // TODO need some optimisations. possibly build cache only for curved segments?\n\n  }, {\n    key: \"buildEquidistantCache\",\n    value: function buildEquidistantCache(inputStep, inputPrecision) {\n      var fullLen = this.getPathLength();\n      var precision = inputPrecision || 0.25; // accuracy vs performance\n\n      var step = inputStep || fullLen / 100;\n\n      if (!this.equidistantCache || this.equidistantCache.step !== step || this.equidistantCache.precision !== precision) {\n        // Prepare cache\n        this.equidistantCache = {\n          step: step,\n          precision: precision,\n          points: []\n        }; // Calculate points\n\n        var s = 0;\n\n        for (var l = 0; l <= fullLen; l += precision) {\n          var p0 = this.getPointOnPath(l);\n          var p1 = this.getPointOnPath(l + precision);\n\n          if (!p0 || !p1) {\n            continue;\n          }\n\n          s += this.getLineLength(p0.x, p0.y, p1.x, p1.y);\n\n          if (s >= step) {\n            this.equidistantCache.points.push({\n              x: p0.x,\n              y: p0.y,\n              distance: l\n            });\n            s -= step;\n          }\n        }\n      }\n    }\n  }, {\n    key: \"getEquidistantPointOnPath\",\n    value: function getEquidistantPointOnPath(targetDistance, step, precision) {\n      this.buildEquidistantCache(step, precision);\n\n      if (targetDistance < 0 || targetDistance - this.getPathLength() > 0.00005) {\n        return null;\n      }\n\n      var idx = Math.round(targetDistance / this.getPathLength() * (this.equidistantCache.points.length - 1));\n      return this.equidistantCache.points[idx] || null;\n    }\n  }]);\n\n  return TextPathElement;\n}(TextElement);\n\nfunction _createSuper$z(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$z();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$z() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar ImageElement = /*#__PURE__*/function (_RenderedElement) {\n  _inherits(ImageElement, _RenderedElement);\n\n  var _super = _createSuper$z(ImageElement);\n\n  function ImageElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, ImageElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'image';\n    _this.loaded = false;\n\n    var href = _this.getHrefAttribute().getString();\n\n    if (!href) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    var isSvg = /\\.svg$/.test(href);\n    document.images.push(_assertThisInitialized(_this));\n\n    if (!isSvg) {\n      _this.loadImage(href);\n    } else {\n      _this.loadSvg(href);\n    }\n\n    _this.isSvg = isSvg;\n    return _this;\n  }\n\n  _createClass(ImageElement, [{\n    key: \"loadImage\",\n    value: function () {\n      var _loadImage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(href) {\n        var image;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return this.document.createImage(href);\n\n              case 3:\n                image = _context.sent;\n                this.image = image;\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0); // tslint:disable-next-line: no-console\n\n                console.error(\"Error while loading image \\\"\".concat(href, \"\\\":\"), _context.t0);\n\n              case 10:\n                this.loaded = true;\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7]]);\n      }));\n\n      function loadImage(_x) {\n        return _loadImage.apply(this, arguments);\n      }\n\n      return loadImage;\n    }()\n  }, {\n    key: \"loadSvg\",\n    value: function () {\n      var _loadSvg = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(href) {\n        var response, svg;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return this.document.fetch(href);\n\n              case 3:\n                response = _context2.sent;\n                _context2.next = 6;\n                return response.text();\n\n              case 6:\n                svg = _context2.sent;\n                this.image = svg;\n                _context2.next = 13;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](0); // tslint:disable-next-line: no-console\n\n                console.error(\"Error while loading image \\\"\".concat(href, \"\\\":\"), _context2.t0);\n\n              case 13:\n                this.loaded = true;\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 10]]);\n      }));\n\n      function loadSvg(_x2) {\n        return _loadSvg.apply(this, arguments);\n      }\n\n      return loadSvg;\n    }()\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      var document = this.document,\n          image = this.image,\n          loaded = this.loaded;\n      var x = this.getAttribute('x').getPixels('x');\n      var y = this.getAttribute('y').getPixels('y');\n      var width = this.getStyle('width').getPixels('x');\n      var height = this.getStyle('height').getPixels('y');\n\n      if (!loaded || !image || !width || !height) {\n        return;\n      }\n\n      ctx.save();\n\n      if (this.isSvg) {\n        document.canvg.forkString(ctx, this.image, {\n          ignoreMouse: true,\n          ignoreAnimation: true,\n          ignoreDimensions: true,\n          ignoreClear: true,\n          offsetX: x,\n          offsetY: y,\n          scaleWidth: width,\n          scaleHeight: height\n        }).render();\n      } else {\n        var _image = this.image;\n        ctx.translate(x, y);\n        document.setViewBox({\n          ctx: ctx,\n          aspectRatio: this.getAttribute('preserveAspectRatio').getString(),\n          width: width,\n          desiredWidth: _image.width,\n          height: height,\n          desiredHeight: _image.height\n        });\n\n        if (this.loaded) {\n          if (typeof _image.complete === 'undefined' || _image.complete) {\n            ctx.drawImage(_image, 0, 0);\n          }\n        }\n      }\n\n      ctx.restore();\n    }\n  }, {\n    key: \"getBoundingBox\",\n    value: function getBoundingBox() {\n      var x = this.getAttribute('x').getPixels('x');\n      var y = this.getAttribute('y').getPixels('y');\n      var width = this.getStyle('width').getPixels('x');\n      var height = this.getStyle('height').getPixels('y');\n      return new BoundingBox(x, y, x + width, y + height);\n    }\n  }]);\n\n  return ImageElement;\n}(RenderedElement);\n\nfunction _createSuper$A(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$A();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$A() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar SymbolElement = /*#__PURE__*/function (_RenderedElement) {\n  _inherits(SymbolElement, _RenderedElement);\n\n  var _super = _createSuper$A(SymbolElement);\n\n  function SymbolElement() {\n    var _this;\n\n    _classCallCheck(this, SymbolElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'symbol';\n    return _this;\n  }\n\n  _createClass(SymbolElement, [{\n    key: \"render\",\n    value: function render(_) {// NO RENDER\n    }\n  }]);\n\n  return SymbolElement;\n}(RenderedElement);\n\nvar SVGFontLoader = /*#__PURE__*/function () {\n  function SVGFontLoader(document) {\n    _classCallCheck(this, SVGFontLoader);\n\n    this.document = document;\n    this.loaded = false;\n    document.fonts.push(this);\n  }\n\n  _createClass(SVGFontLoader, [{\n    key: \"load\",\n    value: function () {\n      var _load = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(fontFamily, url) {\n        var _context, document, svgDocument, fonts;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                document = this.document;\n                _context2.next = 4;\n                return document.canvg.parser.load(url);\n\n              case 4:\n                svgDocument = _context2.sent;\n                fonts = svgDocument.getElementsByTagName('font');\n\n                _forEachInstanceProperty(_context = _Array$from(fonts)).call(_context, function (fontNode) {\n                  var font = document.createElement(fontNode);\n                  document.definitions[fontFamily] = font;\n                });\n\n                _context2.next = 12;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](0); // tslint:disable-next-line: no-console\n\n                console.error(\"Error while loading font \\\"\".concat(url, \"\\\":\"), _context2.t0);\n\n              case 12:\n                this.loaded = true;\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee, this, [[0, 9]]);\n      }));\n\n      function load(_x, _x2) {\n        return _load.apply(this, arguments);\n      }\n\n      return load;\n    }()\n  }]);\n\n  return SVGFontLoader;\n}();\n\nfunction _createSuper$B(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$B();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$B() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar StyleElement = /*#__PURE__*/function (_Element) {\n  _inherits(StyleElement, _Element);\n\n  var _super = _createSuper$B(StyleElement);\n\n  function StyleElement(document, node, captureTextNodes) {\n    var _context;\n\n    var _this;\n\n    _classCallCheck(this, StyleElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'style';\n    var css = compressSpaces(_mapInstanceProperty(_context = _Array$from(node.childNodes)).call(_context, function (_) {\n      return _.data;\n    }).join('').replace(/(\\/\\*([^*]|[\\r\\n]|(\\*+([^*\\/]|[\\r\\n])))*\\*+\\/)|(^[\\s]*\\/\\/.*)/gm, '') // remove comments\n    .replace(/@import.*;/g, '') // remove imports\n    );\n    var cssDefs = css.split('}');\n\n    _forEachInstanceProperty(cssDefs).call(cssDefs, function (_) {\n      var def = _trimInstanceProperty(_).call(_);\n\n      if (!def) {\n        return;\n      }\n\n      var cssParts = def.split('{');\n      var cssClasses = cssParts[0].split(',');\n      var cssProps = cssParts[1].split(';');\n\n      _forEachInstanceProperty(cssClasses).call(cssClasses, function (_) {\n        var cssClass = _trimInstanceProperty(_).call(_);\n\n        if (!cssClass) {\n          return;\n        }\n\n        var props = document.styles[cssClass] || {};\n\n        _forEachInstanceProperty(cssProps).call(cssProps, function (cssProp) {\n          var _context2, _context3;\n\n          var prop = _indexOfInstanceProperty(cssProp).call(cssProp, ':');\n\n          var name = _trimInstanceProperty(_context2 = cssProp.substr(0, prop)).call(_context2);\n\n          var value = _trimInstanceProperty(_context3 = cssProp.substr(prop + 1, cssProp.length - prop)).call(_context3);\n\n          if (name && value) {\n            props[name] = new Property(document, name, value);\n          }\n        });\n\n        document.styles[cssClass] = props;\n        document.stylesSpecificity[cssClass] = getSelectorSpecificity(cssClass);\n\n        if (cssClass === '@font-face') {\n          //  && !nodeEnv\n          var fontFamily = props['font-family'].getString().replace(/\"|'/g, '');\n          var srcs = props.src.getString().split(',');\n\n          _forEachInstanceProperty(srcs).call(srcs, function (src) {\n            if (_indexOfInstanceProperty(src).call(src, 'format(\"svg\")') > 0) {\n              var url = parseExternalUrl(src);\n\n              if (url) {\n                new SVGFontLoader(document).load(fontFamily, url);\n              }\n            }\n          });\n        }\n      });\n    });\n\n    return _this;\n  }\n\n  return StyleElement;\n}(Element);\n\nStyleElement.parseExternalUrl = parseExternalUrl;\n\nfunction _createSuper$C(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$C();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$C() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar UseElement = /*#__PURE__*/function (_RenderedElement) {\n  _inherits(UseElement, _RenderedElement);\n\n  var _super = _createSuper$C(UseElement);\n\n  function UseElement() {\n    var _this;\n\n    _classCallCheck(this, UseElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'use';\n    return _this;\n  }\n\n  _createClass(UseElement, [{\n    key: \"setContext\",\n    value: function setContext(ctx) {\n      _get(_getPrototypeOf(UseElement.prototype), \"setContext\", this).call(this, ctx);\n\n      var xAttr = this.getAttribute('x');\n      var yAttr = this.getAttribute('y');\n\n      if (xAttr.hasValue()) {\n        ctx.translate(xAttr.getPixels('x'), 0);\n      }\n\n      if (yAttr.hasValue()) {\n        ctx.translate(0, yAttr.getPixels('y'));\n      }\n    }\n  }, {\n    key: \"path\",\n    value: function path(ctx) {\n      var element = this.element;\n\n      if (element) {\n        element.path(ctx);\n      }\n    }\n  }, {\n    key: \"renderChildren\",\n    value: function renderChildren(ctx) {\n      var document = this.document,\n          element = this.element;\n\n      if (element) {\n        var tempSvg = element;\n\n        if (element.type === 'symbol') {\n          // render me using a temporary svg element in symbol cases (http://www.w3.org/TR/SVG/struct.html#UseElement)\n          tempSvg = new SVGElement(document, null);\n          tempSvg.attributes.viewBox = new Property(document, 'viewBox', element.getAttribute('viewBox').getString());\n          tempSvg.attributes.preserveAspectRatio = new Property(document, 'preserveAspectRatio', element.getAttribute('preserveAspectRatio').getString());\n          tempSvg.attributes.overflow = new Property(document, 'overflow', element.getAttribute('overflow').getString());\n          tempSvg.children = element.children; // element is still the parent of the children\n\n          element.styles.opacity = new Property(document, 'opacity', this.calculateOpacity());\n        }\n\n        if (tempSvg.type === 'svg') {\n          var widthStyle = this.getStyle('width', false, true);\n          var heightStyle = this.getStyle('height', false, true); // if symbol or svg, inherit width/height from me\n\n          if (widthStyle.hasValue()) {\n            tempSvg.attributes.width = new Property(document, 'width', widthStyle.getString());\n          }\n\n          if (heightStyle.hasValue()) {\n            tempSvg.attributes.height = new Property(document, 'height', heightStyle.getString());\n          }\n        }\n\n        var oldParent = tempSvg.parent;\n        tempSvg.parent = this;\n        tempSvg.render(ctx);\n        tempSvg.parent = oldParent;\n      }\n    }\n  }, {\n    key: \"getBoundingBox\",\n    value: function getBoundingBox(ctx) {\n      var element = this.element;\n\n      if (element) {\n        return element.getBoundingBox(ctx);\n      }\n\n      return null;\n    }\n  }, {\n    key: \"elementTransform\",\n    value: function elementTransform() {\n      var document = this.document,\n          element = this.element;\n      return Transform.fromElement(document, element);\n    }\n  }, {\n    key: \"element\",\n    get: function get() {\n      if (!this._element) {\n        this._element = this.getHrefAttribute().getDefinition();\n      }\n\n      return this._element;\n    }\n  }]);\n\n  return UseElement;\n}(RenderedElement);\n\nfunction _createSuper$D(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$D();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$D() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction imGet(img, x, y, width, _, rgba) {\n  return img[y * width * 4 + x * 4 + rgba];\n}\n\nfunction imSet(img, x, y, width, _, rgba, val) {\n  img[y * width * 4 + x * 4 + rgba] = val;\n}\n\nfunction m(matrix, i, v) {\n  var mi = matrix[i];\n  return mi * v;\n}\n\nfunction c(a, m1, m2, m3) {\n  return m1 + Math.cos(a) * m2 + Math.sin(a) * m3;\n}\n\nvar FeColorMatrixElement = /*#__PURE__*/function (_Element) {\n  _inherits(FeColorMatrixElement, _Element);\n\n  var _super = _createSuper$D(FeColorMatrixElement);\n\n  function FeColorMatrixElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, FeColorMatrixElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'feColorMatrix';\n    var matrix = toNumbers(_this.getAttribute('values').getString());\n\n    switch (_this.getAttribute('type').getString('matrix')) {\n      // http://www.w3.org/TR/SVG/filters.html#feColorMatrixElement\n      case 'saturate':\n        {\n          var s = matrix[0];\n          matrix = [0.213 + 0.787 * s, 0.715 - 0.715 * s, 0.072 - 0.072 * s, 0, 0, 0.213 - 0.213 * s, 0.715 + 0.285 * s, 0.072 - 0.072 * s, 0, 0, 0.213 - 0.213 * s, 0.715 - 0.715 * s, 0.072 + 0.928 * s, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n          break;\n        }\n\n      case 'hueRotate':\n        {\n          var a = matrix[0] * Math.PI / 180.0;\n          matrix = [c(a, 0.213, 0.787, -0.213), c(a, 0.715, -0.715, -0.715), c(a, 0.072, -0.072, 0.928), 0, 0, c(a, 0.213, -0.213, 0.143), c(a, 0.715, 0.285, 0.140), c(a, 0.072, -0.072, -0.283), 0, 0, c(a, 0.213, -0.213, -0.787), c(a, 0.715, -0.715, 0.715), c(a, 0.072, 0.928, 0.072), 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1];\n          break;\n        }\n\n      case 'luminanceToAlpha':\n        matrix = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.2125, 0.7154, 0.0721, 0, 0, 0, 0, 0, 0, 1];\n        break;\n    }\n\n    _this.matrix = matrix;\n    _this.includeOpacity = _this.getAttribute('includeOpacity').hasValue();\n    return _this;\n  }\n\n  _createClass(FeColorMatrixElement, [{\n    key: \"apply\",\n    value: function apply(ctx, _, __, width, height) {\n      // assuming x==0 && y==0 for now\n      var includeOpacity = this.includeOpacity,\n          matrix = this.matrix;\n      var srcData = ctx.getImageData(0, 0, width, height);\n\n      for (var y = 0; y < height; y++) {\n        for (var x = 0; x < width; x++) {\n          var r = imGet(srcData.data, x, y, width, height, 0);\n          var g = imGet(srcData.data, x, y, width, height, 1);\n          var b = imGet(srcData.data, x, y, width, height, 2);\n          var a = imGet(srcData.data, x, y, width, height, 3);\n          var nr = m(matrix, 0, r) + m(matrix, 1, g) + m(matrix, 2, b) + m(matrix, 3, a) + m(matrix, 4, 1);\n          var ng = m(matrix, 5, r) + m(matrix, 6, g) + m(matrix, 7, b) + m(matrix, 8, a) + m(matrix, 9, 1);\n          var nb = m(matrix, 10, r) + m(matrix, 11, g) + m(matrix, 12, b) + m(matrix, 13, a) + m(matrix, 14, 1);\n          var na = m(matrix, 15, r) + m(matrix, 16, g) + m(matrix, 17, b) + m(matrix, 18, a) + m(matrix, 19, 1);\n\n          if (includeOpacity) {\n            nr = ng = nb = 0;\n            na *= a / 255;\n          }\n\n          imSet(srcData.data, x, y, width, height, 0, nr);\n          imSet(srcData.data, x, y, width, height, 1, ng);\n          imSet(srcData.data, x, y, width, height, 2, nb);\n          imSet(srcData.data, x, y, width, height, 3, na);\n        }\n      }\n\n      ctx.clearRect(0, 0, width, height);\n      ctx.putImageData(srcData, 0, 0);\n    }\n  }]);\n\n  return FeColorMatrixElement;\n}(Element);\n\nfunction _createSuper$E(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$E();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$E() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar MaskElement = /*#__PURE__*/function (_Element) {\n  _inherits(MaskElement, _Element);\n\n  var _super = _createSuper$E(MaskElement);\n\n  function MaskElement() {\n    var _this;\n\n    _classCallCheck(this, MaskElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'mask';\n    return _this;\n  }\n\n  _createClass(MaskElement, [{\n    key: \"apply\",\n    value: function apply(ctx, element) {\n      var document = this.document; // render as temp svg\n\n      var x = this.getAttribute('x').getPixels('x');\n      var y = this.getAttribute('y').getPixels('y');\n      var width = this.getStyle('width').getPixels('x');\n      var height = this.getStyle('height').getPixels('y');\n\n      if (!width && !height) {\n        var _context;\n\n        var boundingBox = new BoundingBox();\n\n        _forEachInstanceProperty(_context = this.children).call(_context, function (child) {\n          boundingBox.addBoundingBox(child.getBoundingBox(ctx));\n        });\n\n        x = Math.floor(boundingBox.x1);\n        y = Math.floor(boundingBox.y1);\n        width = Math.floor(boundingBox.width);\n        height = Math.floor(boundingBox.height);\n      }\n\n      var ignoredStyles = this.removeStyles(element, MaskElement.ignoreStyles);\n      var maskCanvas = document.createCanvas(x + width, y + height);\n      var maskCtx = maskCanvas.getContext('2d');\n      document.screen.setDefaults(maskCtx);\n      this.renderChildren(maskCtx); // convert mask to alpha with a fake node\n      // TODO: refactor out apply from feColorMatrix\n\n      new FeColorMatrixElement(document, {\n        nodeType: 1,\n        childNodes: [],\n        attributes: [{\n          nodeName: 'type',\n          value: 'luminanceToAlpha'\n        }, {\n          nodeName: 'includeOpacity',\n          value: 'true'\n        }]\n      }).apply(maskCtx, 0, 0, x + width, y + height);\n      var tmpCanvas = document.createCanvas(x + width, y + height);\n      var tmpCtx = tmpCanvas.getContext('2d');\n      document.screen.setDefaults(tmpCtx);\n      element.render(tmpCtx);\n      tmpCtx.globalCompositeOperation = 'destination-in';\n      tmpCtx.fillStyle = maskCtx.createPattern(maskCanvas, 'no-repeat');\n      tmpCtx.fillRect(0, 0, x + width, y + height);\n      ctx.fillStyle = tmpCtx.createPattern(tmpCanvas, 'no-repeat');\n      ctx.fillRect(0, 0, x + width, y + height); // reassign mask\n\n      this.restoreStyles(element, ignoredStyles);\n    }\n  }, {\n    key: \"render\",\n    value: function render(_) {// NO RENDER\n    }\n  }]);\n\n  return MaskElement;\n}(Element);\n\nMaskElement.ignoreStyles = ['mask', 'transform', 'clip-path'];\n\nfunction _createSuper$F(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$F();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$F() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar noop = function noop() {};\n\nvar ClipPathElement = /*#__PURE__*/function (_Element) {\n  _inherits(ClipPathElement, _Element);\n\n  var _super = _createSuper$F(ClipPathElement);\n\n  function ClipPathElement() {\n    var _this;\n\n    _classCallCheck(this, ClipPathElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'clipPath';\n    return _this;\n  }\n\n  _createClass(ClipPathElement, [{\n    key: \"apply\",\n    value: function apply(ctx) {\n      var _context;\n\n      var document = this.document;\n\n      var contextProto = _Reflect$getPrototypeOf(ctx);\n\n      var beginPath = ctx.beginPath,\n          closePath = ctx.closePath;\n\n      if (contextProto) {\n        contextProto.beginPath = noop;\n        contextProto.closePath = noop;\n      }\n\n      _Reflect$apply(beginPath, ctx, []);\n\n      _forEachInstanceProperty(_context = this.children).call(_context, function (child) {\n        if (typeof child.path === 'undefined') {\n          return;\n        }\n\n        var transform = typeof child.elementTransform !== 'undefined' ? child.elementTransform() : null; // handle <use />\n\n        if (!transform) {\n          transform = Transform.fromElement(document, child);\n        }\n\n        if (transform) {\n          transform.apply(ctx);\n        }\n\n        child.path(ctx);\n\n        if (contextProto) {\n          contextProto.closePath = closePath;\n        }\n\n        if (transform) {\n          transform.unapply(ctx);\n        }\n      });\n\n      _Reflect$apply(closePath, ctx, []);\n\n      ctx.clip();\n\n      if (contextProto) {\n        contextProto.beginPath = beginPath;\n        contextProto.closePath = closePath;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render(_) {// NO RENDER\n    }\n  }]);\n\n  return ClipPathElement;\n}(Element);\n\nfunction _createSuper$G(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$G();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$G() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar FilterElement = /*#__PURE__*/function (_Element) {\n  _inherits(FilterElement, _Element);\n\n  var _super = _createSuper$G(FilterElement);\n\n  function FilterElement() {\n    var _this;\n\n    _classCallCheck(this, FilterElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'filter';\n    return _this;\n  }\n\n  _createClass(FilterElement, [{\n    key: \"apply\",\n    value: function apply(ctx, element) {\n      // render as temp svg\n      var document = this.document,\n          children = this.children;\n      var boundingBox = element.getBoundingBox(ctx);\n\n      if (!boundingBox) {\n        return;\n      }\n\n      var px = 0;\n      var py = 0;\n\n      _forEachInstanceProperty(children).call(children, function (child) {\n        var efd = child.extraFilterDistance || 0;\n        px = Math.max(px, efd);\n        py = Math.max(py, efd);\n      });\n\n      var width = Math.floor(boundingBox.width);\n      var height = Math.floor(boundingBox.height);\n      var tmpCanvasWidth = width + 2 * px;\n      var tmpCanvasHeight = height + 2 * py;\n\n      if (tmpCanvasWidth < 1 || tmpCanvasHeight < 1) {\n        return;\n      }\n\n      var x = Math.floor(boundingBox.x);\n      var y = Math.floor(boundingBox.y);\n      var ignoredStyles = this.removeStyles(element, FilterElement.ignoreStyles);\n      var tmpCanvas = document.createCanvas(tmpCanvasWidth, tmpCanvasHeight);\n      var tmpCtx = tmpCanvas.getContext('2d');\n      document.screen.setDefaults(tmpCtx);\n      tmpCtx.translate(-x + px, -y + py);\n      element.render(tmpCtx); // apply filters\n\n      _forEachInstanceProperty(children).call(children, function (child) {\n        if (typeof child.apply === 'function') {\n          child.apply(tmpCtx, 0, 0, tmpCanvasWidth, tmpCanvasHeight);\n        }\n      }); // render on me\n\n\n      ctx.drawImage(tmpCanvas, 0, 0, tmpCanvasWidth, tmpCanvasHeight, x - px, y - py, tmpCanvasWidth, tmpCanvasHeight);\n      this.restoreStyles(element, ignoredStyles);\n    }\n  }, {\n    key: \"render\",\n    value: function render(_) {// NO RENDER\n    }\n  }]);\n\n  return FilterElement;\n}(Element);\n\nFilterElement.ignoreStyles = ['filter', 'transform', 'clip-path'];\n\nfunction _createSuper$H(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$H();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$H() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar FeDropShadowElement = /*#__PURE__*/function (_Element) {\n  _inherits(FeDropShadowElement, _Element);\n\n  var _super = _createSuper$H(FeDropShadowElement);\n\n  function FeDropShadowElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, FeDropShadowElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'feDropShadow';\n\n    _this.addStylesFromStyleDefinition();\n\n    return _this;\n  }\n\n  _createClass(FeDropShadowElement, [{\n    key: \"apply\",\n    value: function apply(_, __, ___, ____, _____) {// TODO: implement\n    }\n  }]);\n\n  return FeDropShadowElement;\n}(Element);\n\nfunction _createSuper$I(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$I();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$I() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar FeMorphologyElement = /*#__PURE__*/function (_Element) {\n  _inherits(FeMorphologyElement, _Element);\n\n  var _super = _createSuper$I(FeMorphologyElement);\n\n  function FeMorphologyElement() {\n    var _this;\n\n    _classCallCheck(this, FeMorphologyElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'feMorphology';\n    return _this;\n  }\n\n  _createClass(FeMorphologyElement, [{\n    key: \"apply\",\n    value: function apply(_, __, ___, ____, _____) {// TODO: implement\n    }\n  }]);\n\n  return FeMorphologyElement;\n}(Element);\n\nfunction _createSuper$J(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$J();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$J() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar FeCompositeElement = /*#__PURE__*/function (_Element) {\n  _inherits(FeCompositeElement, _Element);\n\n  var _super = _createSuper$J(FeCompositeElement);\n\n  function FeCompositeElement() {\n    var _this;\n\n    _classCallCheck(this, FeCompositeElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'feComposite';\n    return _this;\n  }\n\n  _createClass(FeCompositeElement, [{\n    key: \"apply\",\n    value: function apply(_, __, ___, ____, _____) {// TODO: implement\n    }\n  }]);\n\n  return FeCompositeElement;\n}(Element);\n\nfunction _createSuper$K(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$K();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$K() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar FeGaussianBlurElement = /*#__PURE__*/function (_Element) {\n  _inherits(FeGaussianBlurElement, _Element);\n\n  var _super = _createSuper$K(FeGaussianBlurElement);\n\n  function FeGaussianBlurElement(document, node, captureTextNodes) {\n    var _this;\n\n    _classCallCheck(this, FeGaussianBlurElement);\n\n    _this = _super.call(this, document, node, captureTextNodes);\n    _this.type = 'feGaussianBlur';\n    _this.blurRadius = Math.floor(_this.getAttribute('stdDeviation').getNumber());\n    _this.extraFilterDistance = _this.blurRadius;\n    return _this;\n  }\n\n  _createClass(FeGaussianBlurElement, [{\n    key: \"apply\",\n    value: function apply(ctx, x, y, width, height) {\n      var document = this.document,\n          blurRadius = this.blurRadius;\n      var body = document.window ? document.window.document.body : null;\n      var canvas = ctx.canvas; // StackBlur requires canvas be on document\n\n      canvas.id = document.getUniqueId();\n\n      if (body) {\n        canvas.style.display = 'none';\n        body.appendChild(canvas);\n      }\n\n      canvasRGBA(canvas, x, y, width, height, blurRadius);\n\n      if (body) {\n        body.removeChild(canvas);\n      }\n    }\n  }]);\n\n  return FeGaussianBlurElement;\n}(Element);\n\nfunction _createSuper$L(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$L();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$L() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar TitleElement = /*#__PURE__*/function (_Element) {\n  _inherits(TitleElement, _Element);\n\n  var _super = _createSuper$L(TitleElement);\n\n  function TitleElement() {\n    var _this;\n\n    _classCallCheck(this, TitleElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'title';\n    return _this;\n  }\n\n  return TitleElement;\n}(Element);\n\nfunction _createSuper$M(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct$M();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct$M() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(_Reflect$construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar DescElement = /*#__PURE__*/function (_Element) {\n  _inherits(DescElement, _Element);\n\n  var _super = _createSuper$M(DescElement);\n\n  function DescElement() {\n    var _this;\n\n    _classCallCheck(this, DescElement);\n\n    _this = _super.apply(this, arguments);\n    _this.type = 'desc';\n    return _this;\n  }\n\n  return DescElement;\n}(Element);\n\nvar elementTypes = {\n  'svg': SVGElement,\n  'rect': RectElement,\n  'circle': CircleElement,\n  'ellipse': EllipseElement,\n  'line': LineElement,\n  'polyline': PolylineElement,\n  'polygon': PolygonElement,\n  'path': PathElement,\n  'pattern': PatternElement,\n  'marker': MarkerElement,\n  'defs': DefsElement,\n  'linearGradient': LinearGradientElement,\n  'radialGradient': RadialGradientElement,\n  'stop': StopElement,\n  'animate': AnimateElement,\n  'animateColor': AnimateColorElement,\n  'animateTransform': AnimateTransformElement,\n  'font': FontElement,\n  'font-face': FontFaceElement,\n  'missing-glyph': MissingGlyphElement,\n  'glyph': GlyphElement,\n  'text': TextElement,\n  'tspan': TSpanElement,\n  'tref': TRefElement,\n  'a': AElement,\n  'textPath': TextPathElement,\n  'image': ImageElement,\n  'g': GElement,\n  'symbol': SymbolElement,\n  'style': StyleElement,\n  'use': UseElement,\n  'mask': MaskElement,\n  'clipPath': ClipPathElement,\n  'filter': FilterElement,\n  'feDropShadow': FeDropShadowElement,\n  'feMorphology': FeMorphologyElement,\n  'feComposite': FeCompositeElement,\n  'feColorMatrix': FeColorMatrixElement,\n  'feGaussianBlur': FeGaussianBlurElement,\n  'title': TitleElement,\n  'desc': DescElement\n};\n\nfunction ownKeys$1(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n\n    if (enumerableOnly) symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      var _context5;\n\n      _forEachInstanceProperty(_context5 = ownKeys$1(Object(source), true)).call(_context5, function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (_Object$getOwnPropertyDescriptors) {\n      _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source));\n    } else {\n      var _context6;\n\n      _forEachInstanceProperty(_context6 = ownKeys$1(Object(source))).call(_context6, function (key) {\n        _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction createCanvas(width, height) {\n  var canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n  return canvas;\n}\n\nfunction createImage(_x) {\n  return _createImage.apply(this, arguments);\n}\n\nfunction _createImage() {\n  _createImage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(src) {\n    var anonymousCrossOrigin,\n        image,\n        _args = arguments;\n    return _regeneratorRuntime.wrap(function _callee$(_context7) {\n      while (1) {\n        switch (_context7.prev = _context7.next) {\n          case 0:\n            anonymousCrossOrigin = _args.length > 1 && _args[1] !== undefined ? _args[1] : false;\n            image = document.createElement('img');\n\n            if (anonymousCrossOrigin) {\n              image.crossOrigin = 'Anonymous';\n            }\n\n            return _context7.abrupt(\"return\", new _Promise(function (resolve, reject) {\n              image.onload = function () {\n                resolve(image);\n              };\n\n              image.onerror = function () {\n                reject();\n              };\n\n              image.src = src;\n            }));\n\n          case 4:\n          case \"end\":\n            return _context7.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _createImage.apply(this, arguments);\n}\n\nvar Document = /*#__PURE__*/function () {\n  function Document(canvg) {\n    var _context, _context2;\n\n    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        _ref$rootEmSize = _ref.rootEmSize,\n        rootEmSize = _ref$rootEmSize === void 0 ? 12 : _ref$rootEmSize,\n        _ref$emSize = _ref.emSize,\n        emSize = _ref$emSize === void 0 ? 12 : _ref$emSize,\n        _ref$createCanvas = _ref.createCanvas,\n        createCanvas = _ref$createCanvas === void 0 ? Document.createCanvas : _ref$createCanvas,\n        _ref$createImage = _ref.createImage,\n        createImage = _ref$createImage === void 0 ? Document.createImage : _ref$createImage,\n        anonymousCrossOrigin = _ref.anonymousCrossOrigin;\n\n    _classCallCheck(this, Document);\n\n    this.canvg = canvg;\n    this.definitions = {};\n    this.styles = {};\n    this.stylesSpecificity = {};\n    this.images = [];\n    this.fonts = [];\n    this.emSizeStack = [];\n    this.uniqueId = 0;\n    this.screen = canvg.screen;\n    this.rootEmSize = rootEmSize;\n    this.emSize = emSize;\n    this.createCanvas = createCanvas;\n    this.createImage = this.bindCreateImage(createImage, anonymousCrossOrigin);\n    this.screen.wait(_bindInstanceProperty(_context = this.isImagesLoaded).call(_context, this));\n    this.screen.wait(_bindInstanceProperty(_context2 = this.isFontsLoaded).call(_context2, this));\n  }\n\n  _createClass(Document, [{\n    key: \"bindCreateImage\",\n    value: function bindCreateImage(createImage, anonymousCrossOrigin) {\n      if (typeof anonymousCrossOrigin === 'boolean') {\n        return function (source, forceAnonymousCrossOrigin) {\n          return createImage(source, typeof forceAnonymousCrossOrigin === 'boolean' ? forceAnonymousCrossOrigin : anonymousCrossOrigin);\n        };\n      }\n\n      return createImage;\n    }\n  }, {\n    key: \"popEmSize\",\n    value: function popEmSize() {\n      var emSizeStack = this.emSizeStack;\n      emSizeStack.pop();\n    }\n  }, {\n    key: \"getUniqueId\",\n    value: function getUniqueId() {\n      return \"canvg\".concat(++this.uniqueId);\n    }\n  }, {\n    key: \"isImagesLoaded\",\n    value: function isImagesLoaded() {\n      var _context3;\n\n      return _everyInstanceProperty(_context3 = this.images).call(_context3, function (_) {\n        return _.loaded;\n      });\n    }\n  }, {\n    key: \"isFontsLoaded\",\n    value: function isFontsLoaded() {\n      var _context4;\n\n      return _everyInstanceProperty(_context4 = this.fonts).call(_context4, function (_) {\n        return _.loaded;\n      });\n    }\n  }, {\n    key: \"createDocumentElement\",\n    value: function createDocumentElement(document) {\n      var documentElement = this.createElement(document.documentElement);\n      documentElement.root = true;\n      documentElement.addStylesFromStyleDefinition();\n      this.documentElement = documentElement;\n      return documentElement;\n    }\n  }, {\n    key: \"createElement\",\n    value: function createElement(node) {\n      var elementType = node.nodeName.replace(/^[^:]+:/, '');\n      var ElementType = Document.elementTypes[elementType];\n\n      if (typeof ElementType !== 'undefined') {\n        return new ElementType(this, node);\n      }\n\n      return new UnknownElement(this, node);\n    }\n  }, {\n    key: \"createTextNode\",\n    value: function createTextNode(node) {\n      return new TextNode(this, node);\n    }\n  }, {\n    key: \"setViewBox\",\n    value: function setViewBox(config) {\n      this.screen.setViewBox(_objectSpread$1({\n        document: this\n      }, config));\n    }\n  }, {\n    key: \"window\",\n    get: function get() {\n      return this.screen.window;\n    }\n  }, {\n    key: \"fetch\",\n    get: function get() {\n      return this.screen.fetch;\n    }\n  }, {\n    key: \"ctx\",\n    get: function get() {\n      return this.screen.ctx;\n    }\n  }, {\n    key: \"emSize\",\n    get: function get() {\n      var emSizeStack = this.emSizeStack;\n      return emSizeStack[emSizeStack.length - 1];\n    },\n    set: function set(value) {\n      var emSizeStack = this.emSizeStack;\n      emSizeStack.push(value);\n    }\n  }]);\n\n  return Document;\n}();\n\nDocument.createCanvas = createCanvas;\nDocument.createImage = createImage;\nDocument.elementTypes = elementTypes;\n\nfunction ownKeys$2(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n\n    if (enumerableOnly) symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      var _context3;\n\n      _forEachInstanceProperty(_context3 = ownKeys$2(Object(source), true)).call(_context3, function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (_Object$getOwnPropertyDescriptors) {\n      _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source));\n    } else {\n      var _context4;\n\n      _forEachInstanceProperty(_context4 = ownKeys$2(Object(source))).call(_context4, function (key) {\n        _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n/**\r\n * SVG renderer on canvas.\r\n */\n\n\nvar Canvg = /*#__PURE__*/function () {\n  /**\r\n   * Main constructor.\r\n   * @param ctx - Rendering context.\r\n   * @param svg - SVG Document.\r\n   * @param options - Rendering options.\r\n   */\n  function Canvg(ctx, svg) {\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    _classCallCheck(this, Canvg);\n\n    this.parser = new Parser(options);\n    this.screen = new Screen(ctx, options);\n    this.options = options;\n    var document = new Document(this, options);\n    var documentElement = document.createDocumentElement(svg);\n    this.document = document;\n    this.documentElement = documentElement;\n  }\n  /**\r\n   * Create Canvg instance from SVG source string or URL.\r\n   * @param ctx - Rendering context.\r\n   * @param svg - SVG source string or URL.\r\n   * @param options - Rendering options.\r\n   */\n\n\n  _createClass(Canvg, [{\n    key: \"fork\",\n\n    /**\r\n     * Create new Canvg instance with inherited options.\r\n     * @param ctx - Rendering context.\r\n     * @param svg - SVG source string or URL.\r\n     * @param options - Rendering options.\r\n     */\n    value: function fork(ctx, svg) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return Canvg.from(ctx, svg, _objectSpread$2(_objectSpread$2({}, this.options), options));\n    }\n    /**\r\n     * Create new Canvg instance with inherited options.\r\n     * @param ctx - Rendering context.\r\n     * @param svg - SVG source string.\r\n     * @param options - Rendering options.\r\n     */\n\n  }, {\n    key: \"forkString\",\n    value: function forkString(ctx, svg) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return Canvg.fromString(ctx, svg, _objectSpread$2(_objectSpread$2({}, this.options), options));\n    }\n    /**\r\n     * Document is ready promise.\r\n     */\n\n  }, {\n    key: \"ready\",\n    value: function ready() {\n      return this.screen.ready();\n    }\n    /**\r\n     * Document is ready value.\r\n     */\n\n  }, {\n    key: \"isReady\",\n    value: function isReady() {\n      return this.screen.isReady();\n    }\n    /**\r\n     * Render only first frame, ignoring animations and mouse.\r\n     * @param options - Rendering options.\r\n     */\n\n  }, {\n    key: \"render\",\n    value: function () {\n      var _render = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var options,\n            _args = arguments;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                options = _args.length > 0 && _args[0] !== undefined ? _args[0] : {};\n                this.start(_objectSpread$2({\n                  enableRedraw: true,\n                  ignoreAnimation: true,\n                  ignoreMouse: true\n                }, options));\n                _context.next = 4;\n                return this.ready();\n\n              case 4:\n                this.stop();\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function render() {\n        return _render.apply(this, arguments);\n      }\n\n      return render;\n    }()\n    /**\r\n     * Start rendering.\r\n     * @param options - Render options.\r\n     */\n\n  }, {\n    key: \"start\",\n    value: function start() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var documentElement = this.documentElement,\n          screen = this.screen,\n          baseOptions = this.options;\n      screen.start(documentElement, _objectSpread$2(_objectSpread$2({\n        enableRedraw: true\n      }, baseOptions), options));\n    }\n    /**\r\n     * Stop rendering.\r\n     */\n\n  }, {\n    key: \"stop\",\n    value: function stop() {\n      this.screen.stop();\n    }\n    /**\r\n     * Resize SVG to fit in given size.\r\n     * @param width\r\n     * @param height\r\n     * @param preserveAspectRatio\r\n     */\n\n  }, {\n    key: \"resize\",\n    value: function resize(width) {\n      var height = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : width;\n      var preserveAspectRatio = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      this.documentElement.resize(width, height, preserveAspectRatio);\n    }\n  }], [{\n    key: \"from\",\n    value: function () {\n      var _from = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(ctx, svg) {\n        var options,\n            parser,\n            svgDocument,\n            _args2 = arguments;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                options = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : {};\n                parser = new Parser(options);\n                _context2.next = 4;\n                return parser.parse(svg);\n\n              case 4:\n                svgDocument = _context2.sent;\n                return _context2.abrupt(\"return\", new Canvg(ctx, svgDocument, options));\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function from(_x, _x2) {\n        return _from.apply(this, arguments);\n      }\n\n      return from;\n    }()\n    /**\r\n     * Create Canvg instance from SVG source string.\r\n     * @param ctx - Rendering context.\r\n     * @param svg - SVG source string.\r\n     * @param options - Rendering options.\r\n     */\n\n  }, {\n    key: \"fromString\",\n    value: function fromString(ctx, svg) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var parser = new Parser(options);\n      var svgDocument = parser.parseFromString(svg);\n      return new Canvg(ctx, svgDocument, options);\n    }\n  }]);\n\n  return Canvg;\n}();\n/**\r\n * Options preset for `OffscreenCanvas`.\r\n * @param config - Preset requirements.\r\n * @param config.DOMParser - XML/HTML parser from string into DOM Document.\r\n */\n\n\nfunction offscreen() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      DOMParserFallback = _ref.DOMParser;\n\n  var preset = {\n    window: null,\n    ignoreAnimation: true,\n    ignoreMouse: true,\n    DOMParser: DOMParserFallback,\n    createCanvas: function createCanvas(width, height) {\n      return new OffscreenCanvas(width, height);\n    },\n    createImage: function createImage(url) {\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var response, blob, img;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(url);\n\n              case 2:\n                response = _context.sent;\n                _context.next = 5;\n                return response.blob();\n\n              case 5:\n                blob = _context.sent;\n                _context.next = 8;\n                return createImageBitmap(blob);\n\n              case 8:\n                img = _context.sent;\n                return _context.abrupt(\"return\", img);\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    }\n  };\n\n  if (typeof DOMParser !== 'undefined' || typeof DOMParserFallback === 'undefined') {\n    _Reflect$deleteProperty(preset, 'DOMParser');\n  }\n\n  return preset;\n}\n/**\r\n * Options preset for `node-canvas`.\r\n * @param config - Preset requirements.\r\n * @param config.DOMParser - XML/HTML parser from string into DOM Document.\r\n * @param config.canvas - `node-canvas` exports.\r\n * @param config.fetch - WHATWG-compatible `fetch` function.\r\n */\n\n\nfunction node(_ref) {\n  var DOMParser = _ref.DOMParser,\n      canvas = _ref.canvas,\n      fetch = _ref.fetch;\n  return {\n    window: null,\n    ignoreAnimation: true,\n    ignoreMouse: true,\n    DOMParser: DOMParser,\n    fetch: fetch,\n    createCanvas: canvas.createCanvas,\n    createImage: canvas.loadImage\n  };\n}\n\nvar index = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  offscreen: offscreen,\n  node: node\n});\nexport default Canvg;\nexport { AElement, AnimateColorElement, AnimateElement, AnimateTransformElement, BoundingBox, CB1, CB2, CB3, CB4, Canvg, CircleElement, ClipPathElement, DefsElement, DescElement, Document, Element, EllipseElement, FeColorMatrixElement, FeCompositeElement, FeDropShadowElement, FeGaussianBlurElement, FeMorphologyElement, FilterElement, Font, FontElement, FontFaceElement, GElement, GlyphElement, GradientElement, ImageElement, LineElement, LinearGradientElement, MarkerElement, MaskElement, Matrix, MissingGlyphElement, Mouse, PSEUDO_ZERO, Parser, PathElement, PathParser, PatternElement, Point, PolygonElement, PolylineElement, Property, QB1, QB2, QB3, RadialGradientElement, RectElement, RenderedElement, Rotate, SVGElement, SVGFontLoader, Scale, Screen, Skew, SkewX, SkewY, StopElement, StyleElement, SymbolElement, TRefElement, TSpanElement, TextElement, TextPathElement, TitleElement, Transform, Translate, UnknownElement, UseElement, ViewPort, compressSpaces, getSelectorSpecificity, normalizeAttributeName, normalizeColor, parseExternalUrl, index as presets, toNumbers, trimLeft, trimRight, vectorMagnitude, vectorsAngle, vectorsRatio };"],"sourceRoot":""}